USES
 HLTCLike.script
 WordsTranslation.script
 @\SysUtils.script
 @\Mouse.script
 Editor.script
 Controls.script
 Forms.script
 F1ControlsDefinition.script
 EVDSchema.script
 DocumentNumbers.script
 Reminders.script
 DocumentProcessing.script
 DocumentList.script
 Check_form.script
;

PROCEDURE "Ищем кнопку Прикрепить навигатор на форме" IN aForm
 OBJECT VAR "Кнопка придочивания"
 "Найти контрол {('HIDELEFT')} по имени на форме {(aForm)}" =: "Кнопка придочивания"
 Если ( "Узнать, существует ли объект {("Кнопка придочивания")}" ) то
  ( 'Кнопки придочивания (HIDELEFT) нет!' . )
 иначе
  ( 'Кнопка придочивания (HIDELEFT) есть.' . )
; // "Ищем кнопку Прикрепить навигатор на форме"

PROCEDURE "Открыть вкладку Редакции, сделать ее плавающей и сравнить с эталоном, есть ли на форме кнопка Прикрепить навигатор"
 "Список редакций"
 "Дождаться переключения вкладок"
 "Сделать вкладку Список редакций плавающей"
 OBJECT VAR "Форма вкладки"
 "Контрол в фокусе" 2 раза "Получить родительскую форму" =: "Форма вкладки"
 'Вкладка Список редакций в документе:' .
 "Ищем кнопку Прикрепить навигатор на форме {("Форма вкладки")}"
; //  "Открыть вкладку Редакции, сделать ее плавающей и сравнить с эталоном, есть ли на форме кнопка Прикрепить навигатор"

PROCEDURE "Открыть модальное окно Список редакций из статусной строки и сравнить с эталоном, есть ли на форме кнопка Прикрепить навигатор"
 PROCEDURE Действия
   OBJECT VAR "Форма модального окна"
   "Контрол в фокусе" "Получить родительскую форму" =: "Форма модального окна"
   "Ищем кнопку Прикрепить навигатор на форме {("Форма модального окна")}"
  ; // Действия

 TRY
  'Модальное окно Редакции (из СР):' .
  "Вызвать Список редакций из статусной строки и сделать {(@ Действия )}" 
 FINALLY
  "Восстановить все настройки текущей конфигурации"
 END
; // "Открыть модальное окно Список редакций из статусной строки и сравнить с эталоном, есть ли на форме кнопка Прикрепить навигатор"

CONST Filter_for_test_K263292056 'K263292056'

PROCEDURE "Открыть Лекарственные средства, разрешённые к применению. Создать пустой фильтр."
  "Создать фильтр с именем {(Filter_for_test_K263292056)} и с параметром {(@ NOP )} для {(@ "Лекарственные средства, разрешённые к применению" )}"
; // "Открыть Лекарственные средства, разрешённые к применению. Создать пустой фильтр."

PROCEDURE "Сравнить с эталоном все доступные фильтры из вкладки и удалить созданный фильтр."
 TRY
  "Сравнить все элементы текущего дерева с эталоном" 
 FINALLY  
  "Удалить фильтр с именем {(Filter_for_test_K263292056)}"
 END
; // "Записать в эталон все доступные фильтры и удалить созданный фильтр."

PROCEDURE "Свернуть, затем развернуть главное окно"
 OBJECT VAR Главное_окно
 "Главное окно" =: Главное_окно
 "Свернуть окно {(Главное_окно)}"
 "Развернуть окно {(Главное_окно)}"
; // "Свернуть, затем развернуть главное окно"

PROCEDURE "Проверить, что в главном окне нет скроллера (если разрешение основного монитора 1440 на 900, то обработать исключение)"
TRY
 Если ( "Разрешение основного монитора" РАВНО ( [ 1440 900 ] ) ) то  
  ( 'На тверских машинах:'.  
   "Выполнить подавив исключение" "Проверить, что в главном окне нет скроллера" )
  иначе
   ( "Проверить, что в главном окне нет скроллера" )
FINALLY
 ППР
 ОМ
END
; // "Проверить, что в главном окне нет скроллера (если разрешение основного монитора 1440 на 900, то обработать исключение)"

WordAlias "##Отделить текст в эталоне"  "Отделить текст в эталоне"

PROCEDURE "Кликнуть на красной медали с восклицательным знаком"
 "Красная медаль с восклицательным знаком" byname:control:push pop:Reminder:Click
 OnTest
; // "Кликнуть на красной медали с восклицательным знаком"

WORDWORKER "Медали ОМ опустить вниз до упора, так чтобы область баллона выходила за границы окна оболочки, и выполнить"
 
 INTEGER VAR l_height
 "Главное окно" pop:control:GetHeight =: l_height
 0 l_height true "Синяя медаль с конвертом" byname:control:push pop:Reminder:Move
 TRY 
  ( WordToWork DO )
 FINALLY
  l_height -1 * =: l_height
  0 l_height true "Синяя медаль с конвертом" byname:control:push pop:Reminder:Move
 END
; // "Медали ОМ опустить вниз до упора, так чтобы область баллона выходила за границы окна оболочки, и выполнить"

PROCEDURE "Сравнить с эталоном иерархию вложенности формы БП и его высоту"
 OBJECT VAR "Форма БП"
 "Контрол в фокусе" "Получить родительскую форму" =: "Форма БП"
 "Форма БП" "Узнать, существует ли объект" ! 'Не удалось найти форму БП' ASSERTS 
 "Форма БП" "Напечатать иерархию вложенности контролов"
 "Померить высоту {("Форма БП")}" .
; // "Сравнить с эталоном иерархию вложенности формы БП и его высоту"

CONST Filter_for_test_K274848126 'K274848126'

PROCEDURE "Создать новый пустой фильтр для теста K274848126"
 "Создать фильтр с именем {(Filter_for_test_K274848126)} и с параметром {(@ NOP)} для {(@ ППР)}"
; // "Создать новый пустой фильтр для теста K274848126"

PROCEDURE "Применить фильтры: 08. Федеральные акты, 09. Письма Минфина и ФНС, 10. Региональные акты. Удалить созданный фильтр"
 PROCEDURE Действия
  "Применить фильтр с именем {('10. Региональные акты')}"  
 ;

 TRY
  "Применить фильтр с именем {('08. Федеральные акты')}"
  "Применить фильтр с именем {('09. Письма Минфина и ФНС')}"  
  "Выполнить {(@ Действия)} обработав исключение {('Не смогли восстановить фокус')}"
 FINALLY
  "Удалить фильтр с именем {(Filter_for_test_K274848126)} для {(@ NOP)}"
 END
 "Дать системе перерисоваться"
; // "Применить фильтры: 08. Федеральные акты, 09. Письма Минфина и ФНС, 10. Региональные акты. Удалить созданный фильтр"

PROCEDURE "Сравнить с эталоном, отмечены ли фильтры: 08. Федеральные акты, 09. Письма Минфина и ФНС, 10. Региональные акты"
 "Открыть фильтры"
 "Проверить, выбран ли фильтр с именем {('08. Федеральные акты')}"
 "Проверить, выбран ли фильтр с именем {('09. Письма Минфина и ФНС')}"
 "Проверить, выбран ли фильтр с именем {('10. Региональные акты')}"
; // "Сравнить с эталоном, отмечены ли фильтры: 08. Федеральные акты, 09. Письма Минфина и ФНС, 10. Региональные акты"

PROCEDURE "Удалить все документы в списке"
 "Перевести фокус в список"
 "Выделить всё"
 "Ответить один раз Да для {(@ "Нажать Del")}"
 "Дать системе перерисоваться"
; // "Удалить все документы в списке"

PROCEDURE "Кликнуть по встроенному скроллеру во вкладке Синхронный просмотр"
 "Открыть вкладку синхронного просмотра текста без сравнения с эталоном"
 "Клик по встроенному скроллеру редактора в фокусе"
; // "Кликнуть по встроенному скроллеру во вкладке Синхронный просмотр"

PROCEDURE "Вставить текст из буфера"
 TRY 
  "Вставить" 
 FINALLY
  "В документе не должно быть комментариев"
 END
; // "Вставить текст из буфера"

PROCEDURE "Выбрать термин 'Аббревиатура и термины биржи за рубежом и в России'"
 "Перевести фокус в дерево терминов"
 "Найти атрибут {('Аббревиатура и термины биржи за рубежом и в России')} в дереве {(контрол::WordsTree)}"
 "Перевести фокус в текст"
;

PROCEDURE "Вставить текст из буфера и нажать Ctrl+Z"
 "Нажать {('Ctrl+V')}"
 TRY
  Ctrl-Z
 FINALLY
  "Контекстной операцией удаляем комментарий"
  "Проверяем отсутствие комментария в текущем редакторе"
 END
; // "Вставить текст из буфера и нажать Ctrl+Z"

PROCEDURE "Сравнить с эталоном баллон синей медали, сообщающей, что документ изменился и проверить через секунду, что он не пропал"
 "Построить список изменившихся документов на контроле"
 "Дать системе перерисоваться"
 "Нажать на синюю медаль, сообщающую, что документ изменился и проверить наличие баллона"
 "Секундная пауза"
 "Проверяем, что баллон у синей медали, сообщающей, что документ изменился видим"
; // "Сравнить с эталоном баллон синей медали, сообщающей, что документ изменился и проверить через секунду, что он не пропал"

PROCEDURE "Перейти по ссылке 'Новостях онлайн' в консультации"
 12 раз "Перейти к следующей ссылке"
 "Перейти по текущей ссылке"
;

PROCEDURE "Возвратиться назад по истории"
 TRY
  OnTest
  "Назад по истории"
 FINALLY 
  ОМ
  // - чтобы уж огрести Assert (not Tk2OperationContainer.CheckWasExceptionInFreeInOwner);
 END 
; // "Возвратиться назад по истории"

WORDWORKER "Открыть новое окно Гаранта и выполнить в нём"

 "Выполнить {(@ ( WordToWork DO ) )} с новым окном Гаранта и переключиться на предыдущее окно"
;

PROCEDURE "Кликнуть по красной медали, сообщающей, что онлайн-проверка документов отключена"
 "Дождаться переключения вкладок"
 "Красная медаль, сообщающая, что онлайн-проверка документов отключена" "Найти контрол по имени в стеке" "Кликнуть"
 "Установить фокус в баллон красной медали, сообщающую, что онлайн-проверка документов отключена"
;

PROCEDURE "Закрыть баллон красной медали, сообщающей, что онлайн-проверка документов отключена"
 OBJECT VAR "Форма баллона"
 "Контрол в фокусе" 2 раза ( "Получить родительскую форму" ) =: "Форма баллона"
 OBJECT VAR "Крестик баллона"
 'CloseButton' "Форма баллона" "Найти VG-контрол по имени" =: "Крестик баллона"
 "Крестик баллона" "Кликаем контрол , принадлежащий VG-сцене"
;

PROCEDURE "Переключиться на первое окно, остальные закрыть"
 "Дождаться переключения вкладок"
 "Закрыть все окна кроме текущего"
;

PROCEDURE "Сравнить с эталоном видимость медали remOnlineDead"
 Если ( "Красная медаль, сообщающая, что онлайн-проверка документов отключена" "Найти контрол по имени в стеке" "Узнать, виден ли контрол" ) то
  ( 'Медаль remOnlineDead есть!' . )
 иначе
  ( 'Медали remOnlineDead нет!' . )
;

PROCEDURE "Сравнить с эталоном видимость и активность пункта 'Анализ списка' в области вкладок"
 OBJECT VAR "Закладка"
 INTEGER VAR Ind
 'Анализ списка' "Найти область вкладок" "Найти вкладку по имени" =: Ind
 Ind "Найти область вкладок" "Найти вкладку по индексу" =: "Закладка"
 "Узнать, существует ли объект {("Закладка" )}" ! 'Не нашли закладку Анализ списка' ASSERTS
 'Visible: ' "Узнать численную переменную {('Visible')} объекта {("Закладка")}" 0 ?!= ToPrintable Cat .
 'Enabled: ' "Узнать численную переменную {('Enabled')} объекта {("Закладка")}" 0 ?!= ToPrintable Cat .
; // "Сравнить с эталоном видимость и активность пункта 'Анализ списка' в области вкладок"

PROCEDURE "На вкладке 'Фильтры' отмечаем первые 5 фильтров"
 "Открыть фильтры"
 5 раз ( "Выделить текущий элемент"
  "Стрелка вниз" )
;

PROCEDURE "Снимаем отметку с 5ого фильтра"
 "Стрелка вверх"
 "Выделить текущий элемент"
;

WORDWORKER "Сделать левый навигатор автораспахивающимся и выполнить"
  PROCEDURE Сохраняем_размеры_навигатора
   "Открываем НК"
   150 "Левый навигатор" "Установить ширину"
   "Перевести фокус в оглавление"
   "Сделать оглавление неплавающим"
   "Сделать левый навигатор автораспахивающимся"
   ( WordToWork DO ) 
  ;

 PROCEDURE Действия
  "Запомнить ширину левого навигатора и выполнить {(@ Сохраняем_размеры_навигатора )}"
 ;

 TRY
  "Запомнить позицию мыши и выполнить {(@ Действия )}"
 FINALLY
  "Перевести фокус в оглавление"
  "Сделать левый навигатор НЕавтораспахивающимся"
 END
; // "Сделать левый навигатор автораспахивающимся и выполнить"

PROCEDURE "Открыть пункт командного меню 'Файл', провести мышью вниз чуть правее левой границы окна и сранить с эталоном ширину Левого навигатора"
 "Установить курсор мыши по координатам {(10 -10)} относительно контрола {("Главное окно")}"
 THREAD ( 22000 SLEEP "Клик левой кнопкой мыши" )
 // Почему так много: [$570524156]
 THREAD ( 700 SLEEP "Провести мышью вниз на {(360)} пикселей" 
  "Левый навигатор" "Померить ширину" .  )
 "Зажать левую кнопку мыши"
; // "Открыть пункт командного меню 'Файл', провести мышью вниз чуть правее левой границы окна и сранить с эталоном ширину Левого навигатора"

WORDWORKER "Установить документ 1055340 на контроль. Переключиться на ТБ27 и выполнить"

 PROCEDURE Действия
  ОМ
  "Выполнить {(@  ( WordToWork DO )  )} с переключённой базой"
 ;

 TRY
  "Выполнить {(@ Действия )} с документом {(1055340)} установленным на контроль"
 FINALLY
  "Закрыть синюю медаль документов на контроле"
 END
; // "Установить документ 1055340 на контроль. Переключиться на ТБ27 и выполнить"

PROCEDURE "Открыть вкладку 'Документы на контроле' и построить 'Список изменившихся документов на контроле'"
 "Выполнить {(@ "Список изменившихся документов на контроле" )} с документами на контроле"
; // "Открыть вкладку 'Документы на контроле' и построить 'Список изменившихся документов на контроле'"

PROCEDURE "Перейти по мультиссылке ('мультиссылка на все документы, входящие в 213 сегмент...'). Сравнить с эталоном текст ссылки, по которой перешли"
 9 раз ( "Перейти к следующей ссылке" )
 "Сравнить абзац текущего редактора с эталоном"
 "Перейти по текущей ссылке"
; 

PROCEDURE "Нажать на зелёную медаль МВ и сравнить с эталоном текст баллона"
 "Перевести фокус в документ"
 "Нажать на зелёную медаль МВ и проверить наличие баллона"
; // "Нажать на зелёную медаль МВ и сравнить с эталоном текст баллона"

PROCEDURE "Закрыть второе окно и переключиться на первое"
 VAR l_Main 0 >>> l_Main
 "Сохранить активное окно" >>> l_Main 
 l_Main "Закрыть сохраненное окно"
;

PROCEDURE "Перейти по ссылке 'Выбрать другие редакции' и вызвать контекстное меню на любой редакции"
 PROCEDURE Сценарий_теста
  TRY
   : Действия
    "Установить курсор мыши по координатам {( 10 50 )} относительно контрола {("Контрол в фокусе")}"
    THREAD ( 800 SLEEP 
    "Установить курсор мыши по координатам {( 40 145 )} относительно контрола {("Контрол в фокусе")}"
    "Клик левой кнопкой мыши")
    "Клик правой кнопкой мыши"
   ; // Действия
 
   "Вызвать Список редакций из статусной строки и сделать {(@ Действия)}"
  FINALLY
   "Закрыть второе окно и переключиться на первое"
   "Дать системе перерисоваться" 
  END
 ; // Сценарий_теста 

 "Запомнить позицию мыши и выполнить {(@ Сценарий_теста )}"
; // "Перейти по ссылке 'Выбрать другие редакции' и вызвать контекстное меню на любой редакции"

PROCEDURE "##Вернуться к основному окну без индекса"
 2 раза ( "Дождаться переключения вкладок" )
 "Открыть новое окно гаранта" 
 2 раза ( "Дождаться переключения вкладок" )
 "Закрыть все окна кроме текущего"
;

WORDWORKER "Запомнить первое главное окно Гаранта и закрыть его, выполнив"
 VAR "Первое главное окно" 
 0 >>> "Первое главное окно"
 "Сохранить активное окно" >>> "Первое главное окно" 
 "Первое главное окно" !=0 'Не удалось запомнить активное окно' ASSERTS
 TRY
  ( WordToWork DO )
 FINALLY
  "Первое главное окно" "Закрыть сохраненное окно" 
  "##Вернуться к основному окну без индекса"
 END
; // "Запомнить первое главное окно Гаранта и закрыть его, выполнив"

PROCEDURE "Кликнуть на синей медали с восклицательным знаком"
 "Перевести фокус в текст"
 "Синяя медаль, сообщающая, что документ изменился" "Найти контрол по имени в стеке" "Кликнуть"
;

PROCEDURE "Выделить в Главе 1 статьи с 1-й по 11-ю при помощи Shift-а"
 "Сворачиваем дерево оглавления"
 3 раза "Спускаемся в дереве на уровень вниз"
 "При помощи Shift выделяем {(11)} элементов"
; // "Выделить в Главе 1 статьи с 1-й по 11-ю при помощи Shift-а"

PROCEDURE "В контекстном меню выбираем операцию 'Предварительный просмотр печати фрагмента'"
 TRY
  "Предварительный просмотр печати фрагмента пунктов оглавления"
 FINALLY
  "Открыть НК"
  "Сворачиваем дерево оглавления"
 END
; // "В контекстном меню выбираем операцию 'Предварительный просмотр печати фрагмента'"

PROCEDURE "В настройке конфигурации выбираем: Документ\Первая вкладка\Ссылки из документа\Международные договоры"
 "Восстановить все настройки текущей конфигурации"
 @ "Настройка конфигурации" MODAL ( 
  "Путь до контрола: {(5)} раз вниз, {(10)} раз Tab"
  
  Если ( "Контрол в фокусе" ЯВЛЯЕТСЯ class::TvtComboBoxQS ) то
   ( "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Ссылки из документа')}" )
  иначе
   ( "Контрол в фокусе" . )
   
  "Нажать {('Tab')}"
  
  Если ( "Контрол в фокусе" ЯВЛЯЕТСЯ class::TvtComboBoxQS ) то
   ( "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Международные договоры')}" )
  иначе
   ( "Контрол в фокусе" . )
  "Кликаем Ок в Настройке конфигурации" 
 )
; // "В настройке конфигурации выбираем: Документ\Первая вкладка\Ссылки из документа\Международные договоры"

OBJECT FUNCTION "Пустая вкладка"
 "Найти контрол {("Информация о пустом списке")} на форме {("Главное окно")}" =: Result
; // "Пустая вкладка"

PROCEDURE "Сравнить контекстное меню вкладки 'Международные договоры' с эталоном"
 'Контекстное меню пустой вкладки СКР:' .
 "Сравнить контекстное меню контрола {("Пустая вкладка")} с эталоном расширенно"
;

PROCEDURE "Сравнить текст информации из вкладки 'Международные договоры' с эталоном"
 TRY
  'Копируем текст информации из пустой вкладки в буфер:' .
  "Пустая вкладка" "Установить фокус"
  "Выделить всё"
  "Копировать"
  "Записать содержимое буфера в эталон"
 FINALLY
  "Восстановить все настройки текущей конфигурации"
 END
; // "Сравнить текст информации из вкладки 'Международные договоры' с эталоном"

ARRAY FUNCTION "Размеры главной формы" 
 [ 
  "Главное окно" "Померить высоту"
  "Главное окно" "Померить ширину"
 ]
 >>> Result 
;

INTEGER FUNCTION "Высота главной формы"
0 "Размеры главной формы"  [i]  >>> Result 
;

INTEGER FUNCTION "Ширина главной формы"
1 "Размеры главной формы"  [i]  >>> Result 
;

PROCEDURE "Переместить медали главного окна в правый нижний угол"
 INTEGER VAR f_height
 INTEGER VAR f_width
 "Высота главной формы" >>> f_height
 "Ширина главной формы" >>> f_width 
  f_width f_height true "Синяя медаль с конвертом" "Найти контрол по имени в стеке" "Переместить медаль"
; // "Переместить медали главного окна в правый нижний угол"

PROCEDURE "Уменьшить размер окна до минимального и сравнить с эталоном, полностью ли видны медали по вертикали и горизонтали"
 INTEGER VAR left_RL
 INTEGER VAR top_RL
 INTEGER VAR f_height
 INTEGER VAR f_width
 OBJECT VAR RL
 RL := ( контрол::RemindersLine "Главное окно" pop:component:FindComponent )
 TRY
  "Главное окно" "Уменьшить окно"
  0 "Главное окно" "Установить высоту"
  0 "Главное окно" "Установить ширину"
  OnTest
  "Дождаться переключения вкладок"
 RL pop:RemindersLine:Left  =: left_RL
 RL pop:RemindersLine:Top =: top_RL
  "Высота главной формы" >>> f_height
  "Ширина главной формы" >>> f_width 
  f_width left_RL - БОЛЬШЕ 48 .
  f_height top_RL - БОЛЬШЕ 48 .
  // - http://mdp.garant.ru/pages/viewpage.action?pageId=344136215&focusedCommentId=377750294#comment-377750294
  3 раза "Дождаться переключения вкладок"
 FINALLY
  "Главное окно" "Развернуть окно"
  OnTest
  "Высота главной формы" >>> f_height
  "Ширина главной формы" >>> f_width 
  f_width -1 * =: f_width
  f_height -1 * =: f_height
  f_width f_height true "Синяя медаль с конвертом" "Найти контрол по имени в стеке" "Переместить медаль"
 END
; // "Уменьшить размер окна до минимального и сравнить с эталоном, полностью ли видны медали по вертикали и горизонтали"

WORDWORKER  "##Импортировать консультацию (следует сделать, если в ОМ нет никаких медалей) и выполнить"
 "Добавить синюю медаль консультаций и сделать {(@ ( WordToWork DO ) )}"
;

PROCEDURE "Вызвать строку БП и сравнить с эталоном введенный контекст"
 БП
 "Выделить всё"
 "Сравнить выделенный текст текущего редактора с эталоном"
; // "Вызвать строку БП и сравнить с эталоном введенный контекст"

PROCEDURE "Построить список по ветке Навигатора 'Гражданское законодательство, приватизация\Граждане (физические лица)'"
 PROCEDURE Действия 
  "Дать системе перерисоваться"
  "Установить фокус в меню во вкладке"
  "Развернуть текущее дерево"
  "Найти ссылку {('Граждане (физические лица)')} в дереве {(контрол::NavigatorTree)} и перейти по ней"
 ; // Действия 
 "Выполнить {(@ Действия )} с меню во вкладке и закрыть её"
; // "Построить список по ветке Навигатора 'Гражданское законодательство, приватизация\Граждане (физические лица)'"

PROCEDURE "Кликнуть мышкой по ссылке 'информация об изменениях' в НК"
 "Открываем НК"
 PROCEDURE Действия
  VAR Editor
  VAR x
  VAR y
  "Контрол в фокусе" >>> Editor
  Editor pop:editor:ParaMiddleCoordsToScreen >>> y >>> x
  y 80 + >>> y
  x y "Установить курсор мыши по координатам"
  Если ( "Узнать индекс курсора мыши" "Узнать имя индекса курсора мыши" РАВНО 'crHandPoint' ! ) то
   ( 'Не попали на ссылку Информация об изменениях! Тест прератил работу!' . 
    HALT
   )
  "Дождаться переключения вкладок"
  "Клик левой кнопкой мыши" 
 ; // Действия

 "Запомнить позицию мыши и выполнить {(@ Действия)}"
; // "Кликнуть мышкой по ссылке 'информация об изменениях' в НК"

PROCEDURE "Кликнуть мышкой по ссылке 'Подробнее см. в справке к документу' в НК"
 PROCEDURE Действия
  VAR Editor
  VAR x
  VAR y
  "Открываем НК"
  "Контрол в фокусе" >>> Editor
  Editor pop:editor:ParaMiddleCoordsToScreen >>> y >>> x
  y 260 + >>> y
  x y "Установить курсор мыши по координатам"
  Если ( ( "Узнать индекс курсора мыши" "Узнать имя индекса курсора мыши" РАВНО 'crHandPoint' )
  И ( 5 раз ( 50 SLEEP "Дать системе перерисоваться" ) "Узнать текущий хинт" РАВНО 'Открыть справку к документу' ) ! ) то
   ( 'Не попали на ссылку Подробнее см. в справке к документу!' . )
  "Дождаться переключения вкладок"
  "Клик левой кнопкой мыши" 
 ; // Действия

 "Запомнить позицию мыши и выполнить {(@ Действия)}"
 "Дождаться переключения вкладок"
; // "Кликнуть мышкой по ссылке 'Подробнее см. в справке к документу' в НК"

PROCEDURE "Проверка, закрылся ли баллон 'Информация об изменениях' "
 "Открываем НК"
 "В документе не должно быть комментариев"
 6 раза ( "Перейти на параграф вниз" )
 "Переместиться в начало строки"
 "Выделить слово справа"
 Если ( "Контрол в фокусе" "Выделенный текст редактора" "Заменить непечатаемые символы" РАВНО 'Часть ' ! ) то
  ( 'Вероятно, не закрылся баллон Информация об изменениях!' . )
; // "Проверка, закрылся ли баллон 'Информация об изменениях' "

WORDWORKER "Переключиться на основную (преемственную) конфигурацию и выполнить" 
 2000 SLEEP
 "Переключиться на конфигурацию {('Основная (преемственная)')}"
 TRY
  ( WordToWork DO ) 
 FINALLY
  "Переключиться на конфигурацию {('Основная')}"
 END
;

PROCEDURE "Открыть ППС и Толковый словарь, построить список всех документов"
 ППС
 "Толковый словарь"
 "Список всех документов" 
;

PROCEDURE "Создать фильтр с пустым именем в ППР"
 TRY
  "Создать фильтр с именем {('')} и с параметром {(@ NOP)} для {(@ ППР)}"
 FINALLY
  "Удалить фильтр с именем {('')} для {(@ ППР)}"
 END
; // "Создать фильтр с пустым именем в ППР"

WORDWORKER "Открыть Конституцию и выполнить"
  "Сделать {(@ ( WordToWork DO ) )} с комментариями в документе {(10003000)}"
;

PROCEDURE "Место вставки комментария для теста K358354848"
 "Установить фокус в документ"
 "В начало документа"
 20 раз ( "Перейти на параграф вниз" )
;

PROCEDURE "Установить комментарий в статью 1 главы 1"
 "В документе не должно быть комментариев"
 "Место вставки комментария для теста K358354848"
 "Ставим комментарий"
;

PROCEDURE "Убедиться, что на вкладке 'Структура документа' есть раздел 'Мои комментарии'"
 TRY
  "Перевести фокус в комментарии"
 FINALLY
  "Место вставки комментария для теста K358354848"
  1 раз "Перейти на параграф вниз"
  "Удалить текущий комментарий и проверить что он удалился"
 END
; // "Убедиться, что на вкладке 'Структура документа' есть раздел 'Мои комментарии'"

CONST Filter_for_test_K361039829 'K361039829'

PROCEDURE "Создать новый пустой фильтр для теста K361039829"
 "Создать фильтр с именем {(Filter_for_test_K361039829)} и с параметром {(@ NOP)} для {(@ NOP)}"
 "Дать системе перерисоваться"
 "Открыть фильтры"
; // "Создать новый пустой фильтр для теста K361039829"

PROCEDURE "Сравнить с эталоном информацию о списке и наличие галочки у фильтра '05. Книги'"
 TRY
  "Проверить, выбран ли фильтр с именем {('05. Книги')}"
  "Перевести фокус в список"
  "Проверить информацию о списке"
 FINALLY
  "Удалить фильтр с именем {(Filter_for_test_K361039829)} для {(@ NOP)}"
 END
; // "Сравнить с эталоном информацию о списке и наличие галочки у фильтра '05. Книги'"

PROCEDURE "Открыть синхронный просмотр текста для документа 2002"
 "Найти документ {('ДОКУМЕНТ 2002 с 10 командами NAME по 73 символа каждая. Это команда 1. ыыыыыыы1 Это команда 2. ыыыыыыыыыыыы ыыыыыыыыыыыы ыыыыыыыыыыыыыыы ы ыыыыыыы ыыыыыы2 Это команда 3. ыыыыыыыыыыыы ыыыыыыыыыыыы ыыыыыыыыыыыыыыы ы ыыыыыыы ыыыыыы3 Это команда 4. ыыыыыыыыыыыы ыыыыыыыыыыыы ыыыыыыыыыыыыыыы ы ыыыыыыы ыыыыыы4 Это команда 5. ыыыыыыыыыыыы ыыыыыыыыыыыы ыыыыыыыыыыыыыыы ы ыыыыыыы ыыыыыы5 Это команда 6. ыыыыыыыыыыыы ыыыыыыыыыыыы ыыыыыыыыыыыыыыы ы ыыыыыыы ыыыыыы6 Это команда 7. ыыыыыыыыыыыы ыыыыыыыыыыыы ыыыыыыыыыыыыыыы ы ыыыыыыы ыыыыыы7 Это команда 8. ыыыыыыыыыыыы ыыыыыыыыыыыы ыыыыыыыыыыыыыыы ы ыыыыыыы ыыыыыы8 Это команда 9. Тут специально стоит открывающая скобка, а закрывающей нет9 Это команда 10. Для проверки fixnames (ыыыыыыыыыыыыыыыы ы ыыыыыыы ыыыыыы10')} в списке"
 "Открыть вкладку синхронного просмотра текста без сравнения с эталоном"
;

PROCEDURE "Проверяем, что статусная строка не моргает (сравнить содержимое статусной строки с эталоном 10 раз)"
 OBJECT VAR "Панель статусбара"
 "Элемент {(0)} статусбара окна {( "Главное окно" )}" =: "Панель статусбара"
 10 раз (  "Сравнить заголовок контрола {("Панель статусбара")} с эталоном" )
;

CONST "06. Формы документов" 5

WORDWORKER "Подготовить главное окно к тесту (установить ему размеры ) и выполнить" INTEGER IN formW INTEGER IN formH
 PROCEDURE Действия
  "Выставить форме размеры {( formW formH )} и {(@ ( WordToWork DO ) )}"
 ; 

 "Сделать {(@ Действия )} с изменением состояния и размеров окна {("Главное окно")}"
; // "Подготовить главное окно к тесту (установить ему размеры ) и выполнить"

PROCEDURE "Убедиться, что у ОМ нет вертикального скроллера"
 "Проверить, что у контрола {("Найти основное меню")} нет вертикального скроллера"
; 

WORDWORKER "Выполнить со свернутой панелью оглавления"
 "Перевести фокус в оглавление"
 "Сделать оглавление неплавающим"  
 "Сделать левый навигатор автораспахивающимся"
 TRY 
  ( WordToWork DO )
 FINALLY
  "Сделать левый навигатор НЕавтораспахивающимся"
 END
; // "Выполнить со свернутой панелью оглавления"

PROCEDURE "Проверить отсутствие крестика на вкладке Оглавления и сравнить с эталоном иерархию контролов дерева Оглавления"
 "Перевести фокус в оглавление"
 "Проверяем отсутствие крестика непосредственно в текущей форме"
;

PROCEDURE "В поле 'Тип' ввести контекст 'Акт' с логическим условием И"
 "в поле 'Тип' ввести {('Акт')} с операцией {(1)}"
;

PROCEDURE "В поле 'Тип' ввести контекст 'Бухгалтерские проводки' с логическим условием И"
 "в поле 'Тип' ввести {('Бухгалтерские проводки')} с операцией {(1)}"
;

PROCEDURE "Нажать Искать и в появившемся диалоге кликнуть кнопку-ссылку 'Обратиться к специалистам Правовой поддержки онлайн'"
 1 wait:Choice
 TRY
  "Нажать Искать"
 FINALLY
  waited:? ASSERT
 END
; 

PROCEDURE "Выбрать фильтр Австралия"
 OBJECT VAR "Список фирм"
 "Контрол в фокусе" "Получить родительскую форму" =: "Список фирм"
 OBJECT VAR "Комбобокс"
 "Найти контрол {(контрол::bt_enMedicFirmList_opCountryFilter)} по имени на форме {("Список фирм")}" =: "Комбобокс"
 "Узнать, существует ли объект {("Комбобокс")}" ! 
  'Не нашли комбобокс' ASSERTS
 "Установить фокус в {("Комбобокс")}"
 "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Австралия')}"
 "Отделить текст в эталоне"
; // "Выбрать фильтр Австралия"

WORDWORKER "Открыть текущий список в новом окне и выполнить"
 "Открыть текущий список в новом окне"
 TRY
  ( WordToWork DO )
 FINALLY
  "Закрыть второе окно и переключиться на первое"
 END
;

PROCEDURE "Проверить отсутствие крестика на форме Оглавления"
 "Проверить, что удалось перевести фокус в оглавление"
 "Проверяем отсутствие крестика"
;

CONST "02. Правовой консалтинг ГАРАНТ" 1

WORDWORKER "Сделать фильтр автоприменяемым и выполнить" STRING IN aFilter 
 "Установить фокус во вкладку Фильтры"
 "Сделать фильтр {(aFilter)} автоприменяемым"
 TRY
  ( WordToWork DO )
 FINALLY
  "Сделать фильтр {(aFilter)} НЕавтоприменяемым"
 END
;

PROCEDURE "Сравнить с эталоном является ли фильтр автоприменяемым" STRING IN aFilter 
 "Установить фокус во вкладку Фильтры"
 'Является ли фильтр автоприменяемым:' .
 "Является ли фильтр {(aFilter)} автоприменяемым?" .
;

PROCEDURE "Сравнить с эталоном выбран ли фильтр" STRING IN aNumNode
 "Установить фокус во вкладку Фильтры"
 'Стоит ли галочка у фильтра:' .
 "Проверить, выбран ли фильтр с именем {(aNumNode)}"
;

CONST Filter_for_test_K371647683_1 'K371647683_1'
CONST Filter_for_test_K371647683_2 'K371647683_2'

WORDWORKER "Создать новый пустой фильтр для теста K371647683 (ИнФарм) и выполнить"
 "Создать фильтр с именем {(Filter_for_test_K371647683_1)} и с параметром {(@ NOP)} для {(@ "Поиск лекарственного средства")}"
 TRY
  ( WordToWork DO )
 FINALLY
  "Удалить фильтр с именем {(Filter_for_test_K371647683_1)} для {(@ "Поиск лекарственного средства")}"
 END
;

WORDWORKER "Создать новый пустой фильтр для теста K371647683 (ППР) и выполнить"
 "Создать фильтр с именем {(Filter_for_test_K371647683_2)} и с параметром {(@ NOP)} для {(@ ППР)}"
 "Дать системе перерисоваться"
 TRY
  ( WordToWork DO )
 FINALLY
  "Удалить фильтр с именем {(Filter_for_test_K371647683_2)} для {(@ ППР)}"
 END
;

PROCEDURE "Сравнить все доступные фильтры с одноименной вкладки с эталоном"
 "Сравнить все элементы текущего дерева с эталоном"  
;

WORDWORKER "Установить главному окну размеры , навигатору ширину в и выполнить" INTEGER IN formW INTEGER IN formH INTEGER IN navigatorW
 PROCEDURE Действия
  "Выставить форме размеры {( formW formH )} ширину навигатора в {( navigatorW )} и сделать {(@ ( WordToWork DO ) )}"
 ; 

 "Сделать {(@ Действия )} с изменением состояния и размеров окна {("Главное окно")}"
; // "Подготовить главное окно к тесту (установить ему размеры ) и выполнить"

PROCEDURE "Включить 'Перенос по словам' на вкладке Структура документа"
 "Перевести фокус в оглавление"
 "Перенос по словам" 
 "Дать системе перерисоваться"
; 

PROCEDURE "Изменяем ширину вкладки Структура документа: увеличиваем до 110, затем уменьшаем до 85 пикселей"
 TRY
  110 "Левый навигатор" "Установить ширину"
  85 "Левый навигатор" "Установить ширину"
 FINALLY
  "Перевести фокус в оглавление"
  "Перенос по словам" 
 END
;

PROCEDURE "Изменяем настройки конфигурации, чтобы появилась красная звездочка (ставим галочку Документ-Вкладки-Редакции)"
 "Подготовить настройки системы к выполнению следующего теста"
 @ "Настройка конфигурации" MODAL (  
  "Путь до контрола: {(5)} раз вниз, {(14)} раз Tab"
  "Поставить галочку в чекбоксе" 
  "Кликаем Ок в Настройке конфигурации"
 )
;

PROCEDURE "##Восстановить настройки для всех конфигураций на вкладке Конфигурации (чтобы пропали все красные звездочки)"
 PROCEDURE Действия
  "Стрелка вниз"
  "Ответить один раз Да для {(@ "Восстановить все настройки на вкладке Конфигурации" )}"
 ;
"Выполнить {(@ Действия )} с вкладкой Список конфигураций"
;

PROCEDURE "Переключиться на расширенную конфигурацию, ничего не делать и вернуться на Основную"
 "Сделать {(@ NOP )} в расширенной конфигурации"
;

PROCEDURE "Открыть вкладку 'Конфигурации' и проверить, что у расширенной конфигурации нет красной звездочки"
 PROCEDURE Действия
  "Убедиться, что расширенная конфигурация не имеет признака измененности"
 ;
 "Выполнить {(@ Действия )} с вкладкой Список конфигураций"
 "Подготовить настройки системы к выполнению следующего теста"
;

PROCEDURE "Изменяем Настройки конфигурации - Поведение системы\Фильтры: ставим галочку напротив 'Карточки поиска' и выбираем положение вкладки 'Справа'" 
 "Восстановить все настройки текущей конфигурации" 
 @ "Настройка конфигурации" MODAL ( 
  "Путь до контрола: {(2)} раз вниз, {(8)} раз Tab"
  "Поставить галочку в чекбоксе"
  2 раза ( "Нажать {('Down')}" )
  "Выбрать следующее значение в комбобоксе {("Контрол в фокусе")}"
  "Кликаем Ок в Настройке конфигурации"
 )
;

PROCEDURE "Сравнить с эталоном иерархию дерева фильтров (убедиться, что навигатор - справа)"
 TRY
  "Установить фокус во вкладку Фильтры"
  "Проверить иерархию вложенности текущего контрола"
 FINALLY
  "Восстановить все настройки текущей конфигурации"
 END
;

PROCEDURE "Удалить текущий документ списка"
 OnTest
 "Ответить один раз Да для {(@ "Нажать Del")}"
;

WORDWORKER "Выделить весь текст, начать сохранять его в формате CF_RTF и выполнить"
 TRY
  "Выделить всё"
   ( WordToWork DO ) 
  "Сохранить выделенный текст в формате {(CF_RTF)}"
 FINALLY 
  3000 SLEEP
  ТБ24
 END 
;

PROCEDURE "Во время экспорта переключаем базы"
 THREAD ( 3000 SLEEP ТБ27 ) 
;

WORDWORKER "Поставить документ 8901004 на контроль, перейти в ОМ, переключить базы и выполнить"

  PROCEDURE Действия
   ОМ
   "Выполнить {(@ ( WordToWork DO ) )} с переключённой базой"
  ;
 TRY
 "Выполнить {(@ Действия)} с документом {(8901004)} установленным на контроль"
 FINALLY
 "Закрыть синюю медаль документов на контроле"
 END
;

PROCEDURE "Открыть вкладку 'Документы на контроле' и зайти в первый документ"
 "Открыть вкладку Документы на контроле"
 "Нажать Enter"
;

PROCEDURE "Сравнить с эталоном, активна ли кнопка 'Поставить на контроль' на тулбаре"
 OBJECT VAR "Текущий контрол"
 "Найти контрол {(контрол::bt_enDocument_opAddToControl)} на форме {("Главное окно")}" >>> "Текущий контрол"
 "Проверить, активен ли контрол {( "Текущий контрол" )}?"
;

PROCEDURE "В поле 'Дата принятия: С' вводим дату 01.01.2001"
 "Убедиться, что фокус в редакторе"
 "Перевести фокус в поле 'Дата принятия: С' в ППР"
 "Ввести строку {('01.01.2001')}"
;

PROCEDURE "Удалить содержимое поля 'Дата принятия: С' и сравнить с эталоном, в каком поле КЗ оказался фокус"
 TRY
  "Удалить"
 FINALLY
  "Контрол в фокусе" "Узнать в каком поле КЗ стоит фокус" .
 END
;

WORDWORKER "Открыть вкладку 'Меню' и выполнить"
 "Выполнить {(@ ( WordToWork DO ) )} с меню во вкладке и закрыть её"
;

PROCEDURE "Перейти: Правовой навигатор => Основы государственно-правового устройства"
 "Развернуть текущее дерево"
 "Найти ссылку {('Основы государственно-правового устройства')} в дереве {(контрол::NavigatorTree)} и перейти по ней"
;

PROCEDURE "Перейти: Правовой навигатор => Основы государственно-правового устройства => Основы конституционного строя"
 "Установить фокус в меню во вкладке"
 "Найти ссылку {('Основы конституционного строя')} в дереве {(контрол::NavigatorTree)} и перейти по ней"
;

PROCEDURE "Открыть вкладку 'Меню' и сравнить с эталоном текст ссылки, на которой стоит фокус"
 "Меню во вкладке" 
 "Получить имя текущего элемента дерева {(контрол::NavigatorTree)}"
;

PROCEDURE "Изменить в редакторе стилей цвет шрифта 'Напишите нам': Собственный - Gradient Active Caption"
 PROCEDURE Изменяем_параметры_редактора_стилей
  "Установить фокус в Дерево стилей"
  "Найти ссылку {('Напишите нам')} в дереве {(контрол::StyleTreeView)} и перейти по ней"
  "Установить фокус на кнопку Типа наследования группы Цвет"
  2 раза  (  "Нажать {('Enter')}" )
  // Устанавливаем тип наследования - Собственный
  "Установить фокус в комбобокс выбора цвета"
  "Выбрать следующее значение в комбобоксе {("Контрол в фокусе")}"
  // Ставим не стандартный цвет (Gradient Active Caption)
  "Нажать Enter"
 ; // Изменяем_параметры_редактора_стилей
  
 "Восстановить все настройки текущей конфигурации"
 "Выполнить с редактором стилей" ( Изменяем_параметры_редактора_стилей )
 "Дать системе перерисоваться"
;

PROCEDURE "Сравнить с эталоном цвет шрифта в плашке ААК"
 TRY
  "Найти плашку в ААК" "Получить шрифт контрола" "Узнать цвет" .
 FINALLY 
  "Восстановить все настройки текущей конфигурации"
 END
;

PROCEDURE "В БП ищем контекст 'закон' по типу 'Судебная практика'"
 "Очистить журнал работы"
 "В БП ищем контекст {('закон')} по типу {('Судебная практика')}"
;

WORDWORKER "Открыть вкладку 'Журнал работы' и выполнить"
 "Выполнить {(@ ( WordToWork DO ) )} с вкладкой Журнал работы"
;

PROCEDURE "Загрузить из папки 'Базовый поиск' выполненный ранее запрос"
 "Развернуть текущее дерево"
 2 раза "Стрелка вниз"
 "Нажать Enter"
 "Дождаться переключения вкладок"
;

PROCEDURE "Сравнить с эталоном, выбран ли тип информации 'Судебная практика'"
 "Выбран ли тип информации {('Судебная практика')}?"
;

PROCEDURE "Построить новый список (Нажать кнопку 'Найти' в БП) и сравнить с эталоном информацию о списке"
 БП
 "Нажать Искать"
 "Проверить информацию о списке"
;

PROCEDURE "Поставить курсор в самое начало толкования и создать комментарий"
 TRY
  "В начало документа"
  "Ставим комментарий"
 FINALLY
  "Контекстной операцией удаляем комментарий"
 END
;

PROCEDURE "Удалить комментарий через контекстное меню"
 TRY
  "Контекстной операцией удаляем комментарий"
 FINALLY
  Ctrl-Z
  // чистим за собой комментарий
 END
;

WORDWORKER "Сравнить с эталоном список, выполнив перед этим"
 TRY
  ( WordToWork DO )
 FINALLY
  "Сравнить список документов с эталоном"
 END
;

PROCEDURE "Выделить один параграф текста"
 "Выделить {(1)} параграфов"
;

PROCEDURE "Нажать Delete и ответить 'Да' в появившемся диалоге"
 "Ответить один раз Да для {(@ "Нажать Del")}"
;

PROCEDURE "Перевести фокус в список терминов"
 TRY
  "Перевести фокус в дерево терминов"
 FINALLY
  "Перевести фокус в документ"
  "Контекстной операцией удаляем комментарий"
 END
;

WORDWORKER "Переключить базу на ТБ27 и выполнить"
 "Выполнить {(@ ( WordToWork DO ) )} с переключённой базой"
;

PROCEDURE "Открыть вкладку 'Меню' и сравнить с эталоном все тексты ссылок первого уровня"
 "Установить фокус в меню во вкладке"
 "Переместиться в начало дерева"
 "Свернуть текущее дерево"
 "Сравнить текущий список с эталоном"
;

PROCEDURE "Ищем контекст 'продукта' и сравнить с эталоном найденный абзац текста. Убедиться, что нашлось только одно вхождение"
 TRY 
  "Ищем контекст {('продукта')} и сравниваем с эталоном найденный абзац"
 FINALLY
  "Найти далее и убедиться, что ничего не нашлось"
 END
;

PROCEDURE "Удалить комментарий у термина, поставленный в начале" IN aDoc 
 "Открываем {(aDoc)}"
 "Стрелка вниз"
 "Контекстной операцией удаляем комментарий"
; // "Удалить комментарий у термина, поставленный в начале"

PROCEDURE "Выделить текст термина и скопировать его в буфер"
 "Выделить всё"
 "Копировать"
;

PROCEDURE "Удалить сохраненный объект из вкладки 'Мои документы'"
 PROCEDURE Действия
   3 раза "Дождаться переключения вкладок"
   "Дать системе перерисоваться"
  "Переместиться в начало дерева"
  "Развернуть текущее дерево"
  "Стрелка вниз"
  "Ответить один раз Да для {(@ "Нажать Del")}"
 ;

 "Открыть мои документы и выполнить {(@ Действия)}"
;

WORDWORKER "Открыть сохранённую закладку из Моих документов и выполнить"
 TRY
  "Открыть сохраненный объект из Моих документов и выполнить {(@ ( WordToWork DO ) )}"
 FINALLY
  "Удалить сохраненный объект из вкладки 'Мои документы'"
  "Удалить комментарий у термина, поставленный в начале {('3741978')}"
 END
;

PROCEDURE "Выделить весь текст документа и сравнить его с эталоном"
 "Установить фокус в документ"
 "Выделить всё"
 "Сравнить выделенный текст текущего редактора с эталоном"
;

PROCEDURE "Ввести контекст 'положения', провести поиск и убедиться что нашлось 2 вхождения"
 "Ввести {('положения')}"
 2 раза "Найти далее"
 "Найти далее и убедиться, что ничего не нашлось"
;

PROCEDURE "Сравнить контекстное меню дерева фильтров с эталоном"
 "Установить фокус во вкладку Фильтры"
 "Дать системе перерисоваться"
 "Сравнить контекстное меню с эталоном"
;

PROCEDURE "Отменить все фильтры и проверить, остался ли выделен фильтр '16. Только действующие'"
 "Отменить все фильтры"
 "Отделить текст в эталоне"
 'Отмечен ли фильтр 16. Только действующие: ' .
 "Проверить, выбран ли фильтр с именем {('16. Только действующие')}"
;

PROCEDURE "Сравнить контекстное медали отфильтрованного списка с эталоном"
 "Перевести фокус в список"
 "Дать системе перерисоваться"
 "Сравнить контекстное меню медали {("Медаль отфильтрованного списка")} с эталоном"
;

WORDWORKER "Открыть НК и выполнить"
 "Сделать {(@ ( WordToWork DO ) )} с комментариями в документе  {(10800200)}"  
;

WORDWORKER "Построить список документов с комментариями и выполнить"
 TRY
  "Выполнить {(@  ( WordToWork DO ) )} в списке документов с комментарями"
 FINALLY
  "Удалить комментарий у термина, поставленный в начале {('3741978')}"
  "Удалить комментарий у термина, поставленный в начале {('3710044')}"
 END
;

PROCEDURE "Проверить, что на вкладке 'Структура документа' есть раздел 'Закладки'"
 TRY
  "Перевести фокус в закладки"
 FINALLY
  ОМ
  "Удалить сохраненный объект из вкладки 'Мои документы'"
 END
;

PROCEDURE "В поле 'Дата принятия' ввести три нуля (один в дни, один в месяцы и один в год)"
 "Перевести фокус в поле 'Дата принятия' в ППР"
 3 раза ( "Ввести {('0')}"
 2 раза "Вправо" )
;

PROCEDURE "Нажать 'Искать' и сравнить с эталоном текст появившейся ошибки"
 "Выполнить подавив исключение" "Нажать Искать"
;

CONST Filter_for_test_K387090473 'K387090473'

WORDWORKER "Создать фильтр с параметром 'Тип - Акт' ( из ППР ) и выполнить" STRING IN aName
 PROCEDURE Параметр1
  "в поле 'Тип' ввести {('Акт')}"
 ;

 "Создать фильтр с именем {(aName)} и с параметром {(@ Параметр1)} для {(@ ППР)}"
 "Дать системе перерисоваться"
 TRY
  ( WordToWork DO )
 FINALLY
  ОМ
  "Очистить историю"
  "Удалить фильтр с именем {(aName)} для {(@ ППР)}"
 END
;

PROCEDURE "Перезаписать фильтр (добавить параметр 'Слова в названии - порт') для теста K387090473 ( из ППР )"
 PROCEDURE Параметр2
  "в поле 'Слова в названии' ввести {('порт')}"
 ;

 "Перезаписать фильтр с именем {(Filter_for_test_K387090473)} новым параметром {(@ Параметр2)} для {(@ ППР)}"
;

PROCEDURE "Сравнить с эталоном заполненные поля КЗ для фильтра K387090473"
 "Сравнить фильтр с именем {(Filter_for_test_K387090473)} с эталоном для {(@ ППР)}"
;

PROCEDURE "Найти документ 'документ 2013' в списке и скопировать его в буфер"
 "Перевести фокус в список"
 "Найти документ {('документ 2013')} в списке"
 "Копировать"
;

PROCEDURE "10 раз открыть СР и вернуться в текст документа"
 10 раз ( СР
 "Дать системе перерисоваться"
 "Вернуться в текст документа"
 "Дать системе перерисоваться" )
;

PROCEDURE "Переключиться на вкладку 'Комментарии'"
 "Переключиться на вкладку {('Комментарии')}"
 "Дать системе перерисоваться"
;

PROCEDURE "Удалить все комментарии из текущего документа"
 "В документе не должно быть комментариев"
;

PROCEDURE "Перейти к началу документа, выделить 3 параграфа и сравнить их с эталоном"
 TRY  
  "В начало документа"
  "Выделить {(3)} параграфов"
  "Сравнить выделенный текст текущего редактора с эталоном"
 FINALLY
  "В документе не должно быть комментариев"
 END
;

PROCEDURE "Ставим комментарий в: левую половина ААК, 2 параграфа вниз"
 "Перевести фокус в левую половину ААК"
 2 раза "Перейти на параграф вниз"
 "Ставим комментарий"
;

WORDWORKER "Открыть документ и выполнить" INTEGER IN aNum
 "Сделать {(@ ( WordToWork DO ) )} с комментариями в документе {(aNum)}"
;

PROCEDURE "Убедиться, что на вкладке 'Структура документа' появилась группа 'Мои комментарии'"
 TRY
  "Проверить, что удалось перевести фокус в оглавление"
 FINALLY
  ОМ
  "Открываем {(57972022)}"
  "Ставим комментарий в: левую половина ААК, 2 параграфа вниз"
  "Контекстной операцией удаляем комментарий"
 END
;

PROCEDURE "Нажать Ctrl+Z"
 Ctrl-Z
 "Дождаться переключения вкладок"
;

PROCEDURE "Нажать Shift+Ctrl+Z"
 Shift-Ctrl-Z
 "Дождаться переключения вкладок"
;

PROCEDURE "Открыть документ 57970089 и переключиться на вкладку 'Справка'"
 ОМ
 "Открываем {(57970089)}"
 "Открываем справку"
 "Дождаться переключения вкладок"
;

PROCEDURE "Перейти по ссылке 'ссылка на 2101.10' в правой части ААК документа"
 TRY
  "Перевести фокус в текст"
  "Поставить фокус в правую половину ААК"
  "Перейти к следующей ссылке"
  "Перейти по текущей ссылке"
 FINALLY
  "Открыть документ 57970089 и переключиться на вкладку 'Справка'"
  "Ставим комментарий"
  "Контекстной операцией удаляем комментарий"
 END
;

CONST Filter_for_test_K397292242 'K397292242'

PROCEDURE "Применить из главного меню созданный фильтр"
 STRING VAR Path
 'Анализ/Фильтры/' Filter_for_test_K397292242 Cat >>> Path
 "Дождаться переключения вкладок"
 "Вызвать из главного меню {(Path)}"
;

CONST Filter_for_test_K398276192 'K398276192'

WORDWORKER "Создать фильтр с параметрами: 'Тип - Комментарии\Решение' и 'Орган/Источник - 'Компания Гарант' и выполнить"
 "Создать фильтр {(Filter_for_test_K398276192)} для ААК-списка, выполнить {(@ ( WordToWork DO ) )} и удалить его"
;

PROCEDURE "Применить созданный фильтр для получения списка с ААК-документами"
 "Применить фильтр с именем {(Filter_for_test_K398276192)}"
 "Нажать Искать"
 "Перевести фокус в список"
 "Дать системе перерисоваться"
;

PROCEDURE "Открыть документ с комментарием через 'Мои документы\Мои комментарии\Документы с комментариями пользователя'"
 "Открыть список документов с комментариями"
 "Открыть текущий документ списка"
 "Дать системе перерисоваться"
;

PROCEDURE "Удалить комментарий из документа"
 TRY
  "В документе не должно быть комментариев"
 FINALLY
  "Закрыть вкладку Мои документы"
 END
;

WORDWORKER "Поставить на контроль документ ААК и выполнить" 
 "Поставить на контроль, подавив  Нарушен баланс скобок Wait"
 TRY
  ( WordToWork DO )
 FINALLY
   PROCEDURE Вкладка_документов_на_контроле
    "Удалить документ с вкладки Документы на контроле, подавив  Нарушен баланс скобок Wait"
   ; // Вкладка_документов_на_контроле
  "Выполнить {(@ Вкладка_документов_на_контроле)} с документами на контроле"
  "Закрыть синюю медаль документов на контроле"
 END
;

CONST "07. Бухгалтерские проводки" 6

PROCEDURE "Перестить плашку в левой части ААК-Содержания на пункт 'Бюджетная сфера'"
 "Поставить фокус в левую половину ААК-Содержания"
 "В конец документа"
;

PROCEDURE "Сравнить весь текст левой части ААК-Содержания с эталоном"
 TRY
  "Выделить всё"
  "Сравнить выделенный текст текущего редактора с эталоном"
 FINALLY
  "В начало документа"
 END
;

PROCEDURE "Включить перенос по словам"
 "Перенос по словам" 
 "Дождаться переключения вкладок"
;

PROCEDURE "Сравнить с эталоном высоту девяти верхних нод дерева (высоту текста ссылок на редакции)"
 CONST "Количество редакций" 9
 INTEGER VAR Item
 0 >>> Item
 TRY
  "Количество редакций" раз ( "Измерить высоту ноды {( Item )} дерева {(контрол::RedactionTree:push)}"
  ++! Item )
 FINALLY
  "Перевести фокус в дерево редакций"
  "Перенос по словам"
 END
;

PROCEDURE "Убедиться, что первый документ во вкладке 'Документы на контроле' имеет статус изменён"
 PROCEDURE Вкладка_документов_на_контроле
  "Убедиться, что документ {(0)} на контроле имеет статус изменён"
 ;

 "Выполнить {(@ Вкладка_документов_на_контроле)} с документами на контроле"
;

CONST "08. Федеральные акты" 7
CONST "15. Только действующие" 14

PROCEDURE "Сравнить с эталоном информацию о списке"
 "Проверить информацию о списке"
;

CONST Filter_for_test_K412980963 'K412980963'
CONST "K412980963" 15

PROCEDURE "##Действия для полного удаления фильтра"
 // Служебное слово для удаления фильтров из памяти
 ОМ
 "Очистить историю"
 ППР
 "Открыть фильтры"
;

PROCEDURE "Переключиться на вкладку 'Судебная практика'"
 "Переключиться на вкладку {('Судебная практика')}"  
 2 раза ( "Дождаться переключения вкладок" )
;

PROCEDURE "Кликнуть на жёлтую медаль, сообщающую, что к списку применены фильтры и проверить наличие баллона"
 TRY
  "Нажать на жёлтую медаль, сообщающую, что к списку применены фильтры и проверить наличие баллона"
 FINALLY
  "##Действия для полного удаления фильтра"
 END
;

PROCEDURE "Закрыть окно с историей переписки"
 "Нажать {('Esc')}"
; 

WORDWORKER "Открыть вкладку 'Совещание онлайн' и выполнить" 
 "Выполнить {(@ ( WordToWork DO ) )} с вкладкой Совещание онлайн"
;

PROCEDURE "Добавить пользователя для переписки и закрыть окно чата"
 @ ( "Добавить пользователя для переписки" ) MODAL ( "Нажать Enter" )
 "Отменить отправку сообщений"
;

PROCEDURE "Открыть 'Историю переписки' и сравнить контекстное меню в ней с эталоном"
 TRY
  "Дождаться переключения вкладок"
  "Открыть историю переписки"
  "Сравнить контекстное меню с эталоном"
 FINALLY
  "Закрыть окно с историей переписки"
  "Удалить пользователя"
 END
;

PROCEDURE "Удалить пользователя"
 "Установить фокус в список контактов"
 "Нажать {('Del')}"
;

PROCEDURE "Сравнить контекстное меню вкладки 'Совещание онлайн' с эталоном без добавленных пользователей"
 'Контекстное меню без пользователя:' .
 "Сравнить контекстное меню с эталоном"
;

PROCEDURE "Сравнить контекстное меню вкладки 'Совещание онлайн' с эталоном с добавленным пользователем"
 TRY
  "Установить фокус в список контактов"
  'Контекстное меню с добавленным во вкладку пользователем:' .
  "Сравнить контекстное меню с эталоном"
 FINALLY
  "Удалить пользователя"
 END
;

PROCEDURE "Открыть с кнопки 'Моя информация' вкладку 'Мои документы' и сравнить с эталоном активность кнопки 'Моя информация' и иерархию контрола, куда попали"
 TRY
  "Кликаем кнопку {(контрол::bt_mo_Folders_opMyInformation)} на координатах {( 50 10 )}, и кликаем выпадающий список по координатам {( 10 50 )}"
 FINALLY
  "Закрыть вкладку Мои документы"
 END
;

PROCEDURE "Открыть документ 2221480 и создать закладку на него с именем 'Закладка - 4'"
 "Открываем {(2221480)}"
 "Сохраняем объект в папку Мои документы с именем {('Закладка - 4')}"
;

PROCEDURE "Сохранить запрос с именем 'Запрос - 2 '"
 ППР
 "в поле 'Слова в тексте' ввести {('закон')}"
 "Сохраняем объект в папку Мои документы с именем {('Запрос - 2 ')}"
;

PROCEDURE "Создать новую папку в Моих документах"
 ОМ
 "Мои документы"
 "Создать папку"
 "Нажать Enter"
;

PROCEDURE "Сохранить любой список с именем 'Список - 3'"
 "В БП ищем контекст {('список')}"
 "Сохраняем объект в папку Мои документы с именем {('Список - 3')}"
;

PROCEDURE "Сравнить с эталоном, в каком порядке сохранились объекты во вкладку 'Мои документы'"
 TRY
  ОМ
  "Мои документы"
  "Дождаться переключения вкладок"
  "Развернуть текущее дерево"
  5 раз ( контрол::FoldersTree:push "Текущая нода дерева" "Текст ноды" .
  "Стрелка вниз" )
 FINALLY
  "Переместиться в начало дерева"
  "Стрелка вниз"
  4 раза ( "Ответить один раз Да для {(@ "Нажать Del")}" 
  "Дождаться переключения вкладок" )
  "Закрыть вкладку Мои документы"
 END
;

PROCEDURE "Изменить настройки: Настройки конфигурации/Термины словаря - справа"
 "Восстановить все настройки текущей конфигурации"
 @ "Настройка конфигурации" MODAL ( 
 "Путь до контрола: {(2)} раз вниз, {(7)} раз Tab"
 "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Справа')}"
 "Кликаем Ок в Настройке конфигурации" )
;

PROCEDURE "Сравнить с эталоном иерархию вложенности списка терминов (текущее положение - слева)"
 TRY
  "Перевести фокус в дерево терминов"
  "Проверить иерархию вложенности текущего контрола"
 FINALLY 
  "Восстановить все настройки текущей конфигурации"
 END
;

CONST Filter_for_test_K450293671 'K450293671'
CONST "K450293671" 15

PROCEDURE "Создать пустой фильтр (в ППР)" STRING IN aName
 "Создать фильтр с именем {(aName)} и с параметром {(@ NOP )} для {(@ ППР)}"
 "Дать системе перерисоваться"
;

PROCEDURE "В БП ищем контекст '1' и удаляем фильтр" STRING IN aName
 TRY
  "В БП ищем контекст {('1')}"
 FINALLY
  "Удалить фильтр без закрытия вкладки с именем {(aName)} для {(@ NOP )}"
  "Дождаться переключения вкладок" 
 END
;
 
PROCEDURE "Сравнить с эталоном имя текущего фильтра"
 "Получить имя текущего элемента дерева {(контрол::FiltersList)}"
;

PROCEDURE "Сравнить наличие синей галочки у удаленного фильтра с этанолом и убедиться, что у него есть красный крестик" STRING IN aName
 TRY
  'Стоит ли галочка у фильтра? ' . "Проверить, выбран ли фильтр с именем {(aName)}"
  "Равен ли индекс иконки {(16)} в дереве {(контрол::FiltersList:push)} числу {(5)}?"
 FINALLY  
  "##Действия для полного удаления фильтра"
 END 
;

CONST Filter_for_test_K452365285 'K452365285'
CONST "K452365285" 15

PROCEDURE "Закрыть вкладку 'Фильтры'"
 "Закрыть фильтры" 
 "Дождаться переключения вкладок"
;

CONST Filter_for_test_K454041320 'K454041320'

PROCEDURE "Нажать 'Искать', применить фильтр и удалить его" STRING IN aName
 TRY
  "Нажать Искать"  
 FINALLY
  "Дождаться переключения вкладок"
  "Применить фильтр с именем {(Filter_for_test_K454041320)}"
  "Удалить фильтр с именем {(Filter_for_test_K454041320)}"
 END
;

PROCEDURE "Сравнить с эталоном, выбран ли фильтр" STRING IN aName
 "Дождаться переключения вкладок"
 [ 'Галочка у фильтра ' aName ':' ] strings:Cat .
 "Проверить, выбран ли фильтр с именем {(aName)}"
;

PROCEDURE "Сравнить с эталоном информацию о списке и ##действия для полного удаления фильтра"
TRY
  "Проверить информацию о списке"
 FINALLY
  "##Действия для полного удаления фильтра"
 END
;

CONST Filter_for_test_K458074860_1 'K458074860_1'
CONST Filter_for_test_K458074860_2 'K458074860_2'

WORDWORKER "Создать пустой фильтр (в ППР) и выполнить" STRING IN aName
 "Создать фильтр с именем {(aName)} и с параметром {(@ NOP )} для {(@ ППР)}"
 "Дать системе перерисоваться"
 TRY
  ( WordToWork DO )
 FINALLY
  "Удалить фильтр  с именем {(aName)}" 
  "##Действия для полного удаления фильтра"
 END
;

CONST Filter_for_test_K461017362_1_акт 'K461017362_1_акт'
CONST Filter_for_test_K461017362_2_документ 'K461017362_2_документ'

WORDWORKER "Создать фильтр с параметром Слова в названии ( из ППР ) и выполнить" STRING IN aName STRING IN aParam
 PROCEDURE Параметр1
  "в поле 'Слова в названии' ввести {(aParam)}"
 ;

 "Создать фильтр с именем {(aName)} и с параметром {(@ Параметр1)} для {(@ ППР)}"
 "Дать системе перерисоваться"
 TRY
  ( WordToWork DO )
 FINALLY
  ОМ
  "Очистить историю"
  "Удалить фильтр с именем {(aName)} для {(@ ППР)}"
 END
;

CONST Filter_for_test_K397300122 'K397300122'
CONST "K397300122" 15

WORDWORKER "Создать фильтр с параметром Тип ( из ППР ) и выполнить" STRING IN aName STRING IN aParam
 PROCEDURE Параметр1
  "в поле 'Тип' ввести {(aParam)}"
 ;

 "Создать фильтр с именем {(aName)} и с параметром {(@ Параметр1)} для {(@ ППР)}"
 "Дать системе перерисоваться"
 TRY
  ( WordToWork DO )
 FINALLY
  "Удалить фильтр без закрытия вкладки с именем {(aName)} для {(@ NOP )}"
 END
;

PROCEDURE "Проверить, что у фильтра есть красный крестик" STRING IN aFilter
 TRY
 "Равен ли индекс иконки фильтра {(aFilter)} в дереве числу {(5)}?"
 FINALLY
  "##Действия для полного удаления фильтра"
 END
;

WORDWORKER "Открыть документ 66928 и выполнить"
 PROCEDURE Действия
  "Открываем {(66928)}"
  TRY
   ( WordToWork DO )
  FINALLY  
   "В документе не должно быть комментариев"
  END 
 ; // Действия

 "Запомнить позицию мыши и выполнить {(@ Действия )}"
;

PROCEDURE "Переместить курсор мыши на выделенный текст"
 VAR x
 VAR y
 "Контрол в фокусе" "Координаты курсора относительно левого верхнего угла монитора" >>> y >>> x
 y 40 - >>> y
 x 40 - >>> x
 x y "Установить курсор мыши по координатам" 
;

PROCEDURE "Зажать Ctrl и левую кнопку мыши, переместить курсор в область БП, затем ниже выделенного текста и отпустить кнопки"
  PROCEDURE Зажали_Ctrl
   THREAD ( 500 SLEEP 
     300 190 "Установить курсор мыши по координатам" 
     "Дать системе перерисоваться" )
   THREAD ( 800 SLEEP 
     400 570 "Установить курсор мыши по координатам" 
     "Дать системе перерисоваться" 
     "Отпустить левую кнопку мыши" )
   "Зажать левую кнопку мыши"
  ; // Зажали_Ctrl

 "Выполнить {(@ Зажали_Ctrl )} с зажатой клавишей {('Ctrl')}"
;

WORDWORKER "Открыть 'Информацию об изменениях' к Части первой, перейти по ссылке 'Подробнее см. в справке к документу' и выполнить"
 "Восстановить все настройки текущей конфигурации"
 "Подготовить главное окно к тесту (установить ему размеры ) {(1350 900 )} и выполнить" (
  TRY
   "Кликнуть мышкой по ссылке 'информация об изменениях' в НК"
   "Кликнуть мышкой по ссылке 'Подробнее см. в справке к документу' в НК"
   ( WordToWork DO )
  FINALLY
   "Кликнуть мышкой по ссылке 'информация об изменениях' в НК"
   "Проверка, закрылся ли баллон 'Информация об изменениях' "  
  END
 )
;

PROCEDURE "Перетащить отдоченную вкладку Меню в список терминов ТС"
 PROCEDURE Сохраняем_позицию_мыши
  "Меню во вкладке" 
  "Сделать вкладку меню плавающей"
  "Дать системе перерисоваться"
  "Установить курсор мыши по координатам {(50 -100)} относительно контрола {("Контрол в фокусе")}" // на заголовок отдоченной
  "Перевести фокус в дерево терминов"
  THREAD ( 4000 SLEEP 
   "Установить курсор мыши по координатам {(15 148)} относительно контрола {("Главное окно")}"  // в ЛЕВУЮ часть списка
   "Отпустить левую кнопку мыши" )
  "Зажать левую кнопку мыши"
  "Дать системе перерисоваться"
  4500 SLEEP
 ; // Сохраняем_позицию_мыши
 "Запомнить позицию мыши и выполнить {(@ Сохраняем_позицию_мыши )}"
 "Дождаться переключения вкладок"
;  // "Перетащить отдоченную вкладку Меню в список терминов ТС"

WORDWORKER "##Запомнить состояние окна и выполнить"

 TRY 
  "Сделать {(@ ( WordToWork DO ) )} с изменением состояния и размеров окна {("Главное окно")}"
 FINALLY
  ОМ
  "Восстановить все настройки текущей конфигурации"
  "Закрыть вкладку Документы на контроле"
  "Закрыть меню во вкладке после проверки" 
  "Закрыть вкладку ПЗ"
 END
;

PROCEDURE "Открыть Толковый словарь"
 "Главное окно" "Развернуть окно"
 "Восстановить все настройки текущей конфигурации"
 "Толковый словарь"
 "Закрыть форму БП"
;

PROCEDURE "Открываем вкладку 'Документы на контроле', отдочиваем ее и придочиваем параллельно списку терминов Толкового словаря"
 "Перетащить отдоченную вкладку Документов на контроле в список терминов ТС"
 2 раза ( "Дождаться переключения вкладок" )
;

PROCEDURE "Открываем вкладку 'Меню', отдочиваем ее и придочиваем перпендикулярно списку терминов Толкового словаря"
 "Перетащить отдоченную вкладку Меню в список терминов ТС"
;

PROCEDURE "Перетащить вкладку ПЗ в список терминов ТС"
 PROCEDURE Сохраняем_позицию_мыши
  ПЗ
  "Дать системе перерисоваться"
  "Установить курсор мыши по координатам {(50 -20)} относительно контрола {("Контрол в фокусе")}" // на заголовок отдоченной вкладки
  "Перевести фокус в дерево терминов"
  THREAD ( 1500 SLEEP 
   INTEGER VAR width
   "Панель задач" "Померить ширину" >>> width
   INTEGER VAR X
   width 45 + >>> X
   "Установить курсор мыши по координатам {(X 220)} относительно контрола {("Главное окно")}"  // в ЛЕВУЮ часть списка терминов
   "Отпустить левую кнопку мыши" )
  "Зажать левую кнопку мыши"
  "Дать системе перерисоваться"
  3000 SLEEP
 ; // Сохраняем_позицию_мыши
 "Запомнить позицию мыши и выполнить {(@ Сохраняем_позицию_мыши )}"
;  // "Перетащить вкладку ПЗ в список терминов ТС"

PROCEDURE "Вытащить вкладку ПЗ в область текста термина ТС"
 PROCEDURE Снова_сохраняем_позицию_мыши
  "Установить курсор мыши по координатам {(35 130)} относительно контрола {("Главное окно")}"  // на заголовок вкладки
  THREAD ( 3500 SLEEP 
   "Установить курсор мыши по координатам {(370 0 )} относительно контрола {("Контрол в фокусе")}" // в текст термина
   "Отпустить левую кнопку мыши" )
  "Зажать левую кнопку мыши"
  4000 SLEEP 
 ; // Снова_сохраняем_позицию_мыши
 "Запомнить позицию мыши и выполнить {(@ Снова_сохраняем_позицию_мыши )}"
;  // "Вытащить вкладку Документов на контроле в область текста термина ТС"

PROCEDURE "Сравнить с эталоном высоту и ширину вкладки 'Панель задач'"
 PROCEDURE Размер_окну    
  "Панель задач" "Померить высоту" .
  "Панель задач" "Померить ширину" .
 ; // Размер_окну
 "Выставить форме размеры {( 1400 900 )} и {(@ Размер_окну )}"
;

PROCEDURE "Проверить, что вкладка на форме придочена в дерево терминов ТС"  STRING IN aControl STRING IN aForm
 "Перевести фокус в {(aControl)} на форме {(aForm)}"
 OBJECT VAR "Текущий контрол"
 "Контрол в фокусе" =: "Текущий контрол"
 OBJECT VAR "Навигатор"
 "Текущий контрол" 2 раза "Получить родительскую форму" =: "Навигатор"
 "Навигатор" "Узнать, существует ли объект" ! 'Не нашли форму' ASSERTS
 OBJECT VAR "Неотдоченный левый навигатор"
 "Найти контрол {(контрол::UnderControlList)} на форме {("Навигатор")}" >>> "Неотдоченный левый навигатор"
 "Неотдоченный левый навигатор" "Узнать, существует ли объект" ! 'Навигатора в списке терминов нет!' ASSERTS
; // "Проверить, что вкладка на форме придочена в дерево терминов ТС"

PROCEDURE "Вытащить вкладку Документов на контроле в область текста термина ТС"
 PROCEDURE Снова_сохраняем_позицию_мыши
  "Установить курсор мыши по координатам {(5 144)} относительно контрола {("Главное окно")}"  // на заголовок вкладки
  THREAD ( 3500 SLEEP 
   "Установить курсор мыши по координатам {(350 0 )} относительно контрола {("Контрол в фокусе")}" // в текст термина
   "Отпустить левую кнопку мыши" )
  "Зажать левую кнопку мыши"
  4000 SLEEP 
 ; // Снова_сохраняем_позицию_мыши
 "Запомнить позицию мыши и выполнить {(@ Снова_сохраняем_позицию_мыши )}"
;  // "Вытащить вкладку Документов на контроле в область текста термина ТС"

WORDWORKER "##Запомнить состояние окна (алгоритм с плавающим окном) и выполнить"
 TRY 
  "Сделать {(@ ( WordToWork DO ) )} с изменением состояния и размеров окна {("Главное окно")}"
 FINALLY
  ОМ
  "Открыть вкладку Документы на контроле с проверкой"
  "Сделать вкладку {(контрол::UnderControlList)} на форме {(форма::UnderControl)} неплавающей"
  "Закрыть текущую вкладку"
  // пытаемся бороться с мусором (из-за того, что вкладка может быть отдочена)
  "Восстановить все настройки текущей конфигурации"
  "Закрыть вкладку Документы на контроле"
 END
;

PROCEDURE "Вытащить вкладку 'Документы на контроле' в область текста термина ТС"
 "Проверить, что вкладка {(контрол::UnderControlList)} на форме {(форма::UnderControl)} придочена в дерево терминов ТС"  
 "Вытащить вкладку Документов на контроле в область текста термина ТС"
;

PROCEDURE "##Дать тесту время для отрисовки контролов"
 "Дать системе перерисоваться"
 "Дождаться переключения вкладок"
;

PROCEDURE "Проверить, что дерево терминов Толкового словаря не пустое"
 TRY
  "Дождаться переключения вкладок"
  "Перевести фокус в дерево терминов"
 FINALLY
  "Восстановить все настройки текущей конфигурации"
  "Меню во вкладке" 
  "Закрыть меню во вкладке" 
  "Дождаться переключения вкладок"
  10 раз ( 
   "Нажать {('Tab')}"
   Если ( "Контрол в фокусе" РАВНО 'LeftNavigator : _nscPageControl_' ) то
    ( "Закрыть текущую вкладку" )
  )
 END
;

PROCEDURE "Перезаписать фильтр , дать ему новое имя и добавить новый параметр , сделать для" STRING IN aName STRING IN aNameNew IN aProc IN aKZ
 PROCEDURE Действия

  aProc DO
  wait:No
  TRY
  
  PROCEDURE Вводим_новое_имя_фильтра
    "Ввести {(aNameNew)}"
    "Нажать Ok"
   ;  // Вводим_новое_имя_фильтра 

  "Обработать Enter модально" ( "Нажать Нет" Вводим_новое_имя_фильтра )

  FINALLY
   waited:? ASSERT
  END
 ; // Действия

 aKZ DO
 "Открыть фильтры"

  Если ( контрол::FiltersList:push "Текущая нода дерева" "Текст ноды" РАВНО aName ) то 
   ( @ "Редактировать фильтр" MODAL ( Действия ) )

 "Дождаться переключения вкладок"
; // "Перезаписать фильтр , дать ему новое имя и добавить новый параметр , сделать для"

CONST Filter_for_test_K387088981 'K387088981'
CONST Filter_for_test_K387088981_new 'K387088981_new'
CONST "K387088981" 15

PROCEDURE "Применить созданный фильтр и отредактировать его: добавить 'Слова в названии - порт', перезаписать с новым именем"
 PROCEDURE Параметр2
  "в поле 'Слова в названии' ввести {('порт')}"
 ;

  PROCEDURE Действия_с_примененным_фильтром
   "Перезаписать фильтр {(Filter_for_test_K387088981)}, дать ему новое имя {(Filter_for_test_K387088981_new)} и добавить новый параметр {(@ Параметр2)}, сделать для {(@ NOP )}"
  ; // Действия_с_примененным_фильтром

  "Применить фильтр {('K387088981')} и выполнить {(@ Действия_с_примененным_фильтром )}"
;

PROCEDURE "Сравнить в эталоном контекстное меню дерева фильтров"
 TRY
  "Сравнить контекстное меню с эталоном"
 FINALLY  
  "Удалить фильтр с именем {(Filter_for_test_K387088981_new)} для {(@ ППР )}"
 END
;

WORDWORKER "Запомнить ширину вкладки Левого навигатора. Свернуть вкладку 'Структура документа' и убедиться, что ширина вкладки Левого навигатора не изменилась после действий"
 TRY
  INTEGER VAR aWidth
  "Левый навигатор" "Померить ширину" >>> aWidth
  "Сделать левый навигатор свернутым"
   ( WordToWork DO ) 
  "Дождаться переключения вкладок"
  "Левый навигатор" "Померить ширину" aWidth ?== 'Ширина вкладки навигатора не сохранилась' ASSERTS
 FINALLY
  "Закрыть вкладку ПЗ"
   "Восстановить все настройки текущей конфигурации"
 END
;

CONST Filter_for_test_K371654349 'K371654349'
CONST "K371654349" 15

PROCEDURE "Открыть окно 'Анализ списка' и выбрать Комментарии - Книги"
 "Перевести фокус в список"
 "Дождаться переключения вкладок"
  @ ( "Анализ списка" ) MODAL ( 
   ( 
     1000 SLEEP 
     "Найти ссылку {('Книги (5)')} в дереве {(контрол::ListTree)} и перейти по ней" 
   ) 
  )
;

PROCEDURE "Проверяем, есть ли ListAnalizeForm во вкладках"
 
  PROCEDURE Действия_с_контролом OBJECT IN aCtrl
   Если ( aCtrl ЯВЛЯЕТСЯ class::TListAnalizeForm ) то
    ( 'Видим пустую форму name:ListAnalizeForm' . )
  ; // Действия_с_контролом

 "Закрыть текущую вкладку"
 OBJECT VAR Parent
 "Найти контрол {(контрол::ChildZone)} на форме {("Главное окно")}" >>> Parent
 "Выполнить для всех контролов {(Parent)}" Действия_с_контролом 
 "Открыть фильтры"
;

PROCEDURE "Отменяем все фильтры"
 "Установить фокус во вкладку Фильтры"
 "Отменить все фильтры" 
;

PROCEDURE "Сравнить с эталоном позицию вертикального скроллбара в левой части ААК"
 "Дождаться переключения вкладок"
 "Поставить фокус в левую половину ААК"
 "Узнать позицию вертикального скроллбара у контрола {(контрол::scrLeft:push)}" .
;

PROCEDURE "В тексте слева кликаем по ссылке внизу 'Список редакций, открываемых по скрипту'"

 PROCEDURE Действия_если_попали_на_ссылку
  @ ( "Клик левой кнопкой мыши" ) MODAL ( "Перевести фокус в дерево редакций" "Получить имя текущего элемента дерева {(контрол::RedactionTree)}" )
 ; // Действия_если_попали_на_ссылку

  PROCEDURE Действия
   "Перевести фокус в левую редакцию"
   "В конец документа"
   "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(0 -30)}"
   "Убедиться, что текущий индекс курсора мыши {('crDefault')} и выполнить {(@ Действия_если_попали_на_ссылку )}"
  ; // Действия

 "Запомнить позицию мыши и выполнить {(@ Действия )}"
; // "В тексте слева кликаем по ссылке внизу 'Список редакций, открываемых по скрипту'"

PROCEDURE "Выбрать пункт БП 'Все документы', затем установить курсор мыши на пункт 'Еще' и прокрутить колесико мыши"
 PROCEDURE Действия
  "Установить курсор мыши на VG-контрол {('Все документы')}"
  "Клик левой кнопкой мыши"
    "Установить курсор мыши на VG-контрол {(контрол::MoreTab)}"
  "Дать системе перерисоваться"
  30 раз ( "Симулировать прокрутку колесом мыши вниз {( 1 )} раз"
  "Дать системе перерисоваться" )
 ;

 "Запомнить позицию мыши и выполнить {(@ Действия)}"
;

PROCEDURE "Кликнуть мышкой ссылку 'Вернуться в текст документа' в статусбаре"
 PROCEDURE Действия
  VAR W
  VAR H
  "Главное окно" "Померить ширину" >>> W
  "Главное окно" "Померить высоту" >>> H
  W 80 - >>> W
  H 65 - >>> H
  "Установить курсор мыши по координатам {( W H )} относительно контрола {("Главное окно")}"
  4 раза ( "Дождаться переключения вкладок" ) 
  "Клик левой кнопкой мыши"
  "Дать системе перерисоваться"
 ;

 "Запомнить позицию мыши и выполнить {(@ Действия)}"
;

PROCEDURE "Найти в тексте слева ссылку 'Список редакций, открываемых по скрипту' и перейти по ней"
 13 раз ( "Перейти к следующей ссылке" )
 @ ( "Перейти по текущей ссылке" ) MODAL ( "Перевести фокус в дерево редакций" "Получить имя текущего элемента дерева {(контрол::RedactionTree)}" )
;

PROCEDURE "Сравнить контекстное меню на разных контролах КЗ и скроллбаре с эталоном"
 OBJECT VAR Editor
 контрол::Editor:push >>> Editor
 "Перевести фокус в поле 'Тип' в ППР"
 OBJECT VAR aCtrl
 "Контрол в фокусе" >>> aCtrl
 8 раз ( 
  'Контрол: ' aCtrl ToPrintable Cat .
  'Контекстное меню: ' .
  "Сравнить контекстное меню для контрола {(aCtrl)} для точки с эталоном {( 0 0 )}"
  aCtrl "Перейти к родительской форме" >>> aCtrl 
  "Отделить текст в эталоне"
 )
 Если ( "Узнать, есть ли у контрола {(Editor)} вертикальный скроллер" )
  то ( 'Контекстное меню вертикального скроллера:' .
   "Сравнить контекстное меню скроллера контрола {(Editor)} с эталоном"
  )
 "Отделить текст в эталоне"
 'Контекстное меню на "пустом" месте:' .
 "Сравнить контекстное меню для контрола {(Editor)} для точки с эталоном {( 100 50 )}"
 // "Установить курсор мыши по координатам {( 100 50 )} относительно контрола {(Editor)}"
 // проверка координат
;

PROCEDURE "Заполнить 'Историю запросов' (7 раз провести поиск по БП и вернуться)"
 7 раз ( "В БП ищем контекст {('11')}"
  "Назад по истории" )
;

PROCEDURE "Проверить, что название нижней части 'История запросов' не обрезается"
 OBJECT VAR "Панель запросов"
 INTEGER VAR height_lrBaseSearch
 INTEGER VAR height_hfBaseSearch
 "Найти контрол {('lrBaseSearch')} на форме {("Главное окно")}" =: "Панель запросов" 
 "Проверить, что у контрола {("Панель запросов")} есть вертикальный скроллер" 
 "Панель запросов" "Померить высоту" >>> height_lrBaseSearch
 "Найти контрол {('hfBaseSearch')} на форме {("Главное окно")}" "Померить высоту" >>> height_hfBaseSearch
 Если ( height_hfBaseSearch height_lrBaseSearch - МЕНЬШЕ 50 ) то 
  ( 'Высота заголовка Истории запросов менее 50 пикселей' . )
;

PROCEDURE "Клавишей Tab переводим фокус в комбобокс вкладки МД"
 100 раз ( 
  "Совершить переход по Таб"
  Если ( "Контрол в фокусе" "Имя компонента" РАВНО контрол::bt_enFolders_opFiltrate ) то
   выходим
  )
 "Контрол в фокусе" "Имя компонента" РАВНО контрол::bt_enFolders_opFiltrate 'Не дошли до нужного контрола на вкладке Мои документы!' ASSERTS
;

PROCEDURE "Кликнуть левой кнопкой мыши в любое поле КЗ (например, Вступление в силу)"
 OBJECT VAR КЗ
 "Найти контрол {(контрол::Editor)} на форме {("Главное окно")}" =: КЗ
 "Установить курсор мыши по координатам {( 250 50)} относительно контрола {(КЗ)}"
 "Текущий индекс курсора мыши {('crIBeam')}?"
 "Клик левой кнопкой мыши"
 "Дождаться переключения вкладок"
;

WORDWORKER "Открыть вкладку 'Мои документы' и выполнить"
 PROCEDURE Открываем_вкладку
  "Открыть мои документы и выполнить {(@ ( WordToWork DO ) )}"
 ; // Открываем_вкладку

 "Запомнить позицию мыши и выполнить {(@ Открываем_вкладку )}"
;

PROCEDURE "Прокрутить колесо мыши вниз (20 раз) и сравнить с эталоном текст выделенного элемента вкладки Оглавление"
 "Прокрутить колесо мыши вниз {(20)} раз для контрола {(контрол::Text:push)}"
 "Перевести фокус в оглавление"
 "Получить имя текущего элемента дерева {(контрол::ContentsTree)}"
;

PROCEDURE "Кликнуть по ссылке 'Орган/Источник' и сравнить с эталоном иерархию контрола в фокусе в открывшемся модальном окне"
 PROCEDURE Действия 
  "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(-110 -12)}"
  "Дождаться переключения вкладок"
  "Проверить, что курсор над ссылкой"
  "Отделить текст в эталоне" 
  'Проверяем иерархию контрола в фокусе после клика мышкой: ' . 
  @ ( "Клик левой кнопкой мыши" ) MODAL ( "Проверить иерархию вложенности текущего контрола" )
  "Дождаться переключения вкладок"
 ;
 "Запомнить позицию мыши и выполнить {(@ Действия )}"
;

PROCEDURE "Кликнуть по ссылке 'Информация об изменениях' в правой части ОИД"
 PROCEDURE Действия    
  "Поиск контекста"
  "Ввести {('9 марта')}"
  "Нажать Enter"
  "Закрыть текущую вкладку"
  11 раз "Стрелка вверх"
  "Установить курсор мыши посередине текущего редактора"
  "Клик левой кнопкой мыши"
 ;
 "Запомнить позицию мыши и выполнить {(@ Действия )}"
;

PROCEDURE "Кликнуть на ссылку 'их представителями' и убедиться, что у флеша есть отступ слева (в диапазоне 165-180 пикселей)"
 PROCEDURE Действия
 OBJECT VAR "Флеш"
  "Контрол в фокусе" >>> "Флеш"
  "Установить курсор мыши по координатам {( 200 130 )} относительно контрола {("Флеш")}"
  "Дождаться переключения вкладок"
  "Узнать индекс курсора мыши" "Узнать имя индекса курсора мыши" РАВНО 'crDefault' 'Не попали на ссылку "представителями"!' ASSERTS
  "Клик левой кнопкой мыши"
  "Флеш" "Померить отступ слева" "в интервале" ( 165 180 ) 'Отступ флеша слева вышел за допустимые границы! Возможно флеш не отцентрирован по ширине экрана!' ASSERTS
 ;
 "Запомнить позицию мыши и выполнить {(@ Действия )}"
;

PROCEDURE "Кликнуть вид информации и сравнить с эталоном текст и ширину кнопки" STRING IN aType
 VAR l_VG
 aType "Контрол в фокусе" "Родительская форма контрола" "Найти VG-контрол по имени" =: l_VG
 "Кликаем контрол {( l_VG )}, принадлежащий VG-сцене"
 'text' "Сравнить с эталоном строковую переменную объекта {( l_VG )}"
 l_VG vg:control:Width .
 // 'width' "Сравнить с эталоном нецелочисленную переменную объекта {( l_VG )} (но округленную до целого числа)"
;


PROCEDURE "Кликнуть на ссылку 'Информация об изменениях' в правой части СР (для НК)"
 PROCEDURE Действия 
  "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(-130 5)}"
  "Клик левой кнопкой мыши"
 ;
 "Подготовить главное окно к тесту (установить ему размеры {( 1000 700 )} ) и выполнить" (
  "Запомнить позицию мыши и выполнить {(@ Действия )}"
 )
;

WORDWORKER "Для проверки сценария ошибки выполнить"
 "Подготовить главное окно к тесту (установить ему размеры {( 1000 700 )} ) и выполнить" (
  "Запомнить позицию мыши и выполнить {(@ ( WordToWork DO ) )}"
 )
;

PROCEDURE "Подвести курсор мыши к ссылке 'Проверить условия...' и убедиться, что ссылка не сместилась"
 "Перевести фокус в поле 'Запрос в службу Правовой поддержки онлайн' в ППО"
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(35 11)}"
 "Проверить, что курсор над ссылкой"
 "Отделить текст в эталоне"
 "Установить курсор мыши чуть правее правого края текущего редактора"
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(35 11)}"
 "Проверить, что курсор над ссылкой"
;

PROCEDURE "Кликнуть мышкой ссылку 'Договоры и иные сделки'"
 "Дождаться переключения вкладок"
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {( -100 100 )}"
 "Клик левой кнопкой мыши"
;

WORDWORKER "Открыть документ 57972022 и выполнить"
 "Подготовить главное окно к тесту (установить ему размеры {(1380 1050)} ) и выполнить" (
  "Сделать {(@ ( WordToWork DO ) )} с комментариями в документе {(57972022)}"
 )
;

WORDWORKER "Выключить показ пользовательских комментариев и выполнить"
 "Сделать {(@ ( WordToWork DO ) )} с выключенными пользовательскими комментариями"
;

PROCEDURE "Навести курсор мыши на иконку комментария и сравнить с эталоном хинт и контекстное меню"
 "Дать системе перерисоваться"
 "Установить курсор по координатам  {( 7 71 )} относительно контрола {(контрол::SubPanel:push)} и сравнить с эталоном хинт и контекстное меню"
;

WORDWORKER "Установить главному окну размеры , ширину левой части ААК в и выполнить" INTEGER IN formW INTEGER IN formH INTEGER IN aW
 PROCEDURE Действия
     "Выставить форме размеры {( formW formH )} ширину левой части ААК в {(aW)} и сделать {(@ ( WordToWork DO ) )}"
 ; 

 "Сделать {(@ Действия )} с изменением состояния и размеров окна {("Главное окно")}"
;

PROCEDURE "Подвинуть сплиттер до упора влево и сравнить с эталоном ширину левой части ААК"
 "Установить главному окну размеры {(1400 800)}, ширину левой части ААК в {( 0 )} и выполнить" (
  OBJECT VAR "Сплиттер"
  "Найти сплиттер в ААК" =: "Сплиттер"
  "Сплиттер" "Померить ширину" .
 )
;

PROCEDURE "Скроллим документ так, чтобы нижняя строчка комментария находилась на уровне верхнего параграфа на экране"
 "Прокрутить колесо мыши вниз {(6)} раз для контрола {(контрол::Text:push)}"
;

PROCEDURE "Установить фокус в нижнюю строку таблицы"
 2 раза "Перейти на параграф вниз"
;

PROCEDURE "Установить курсор мыши на ссылку в плашке ААК и сравнить с эталоном виден ли хинт"
 PROCEDURE Действия
  "Установить курсор мыши на ссылку в плашке ААК"
  "Дождаться переключения вкладок"
  "Проверить, виден ли хинт"
 ;
 "Установить главному окну размеры {(1000 700)}, ширину левой части ААК в {(400)} и выполнить" (
  "Запомнить позицию мыши и выполнить {(@ Действия )}" 
 )
;

WORDWORKER "##Для проверки сценария ошибки выполнить"
 "Установить окно оболочки на передний план"
 "Подготовить главное окно к тесту (установить ему размеры {( 1200 850 )} ) и выполнить" (
  "Запомнить позицию мыши и выполнить {(@ ( WordToWork DO ) )}"
 )
;

PROCEDURE "Подвести курсор мыши правее ссылки 'Налоги и взносы' и сравнить с эталоном индекс курсора мыши" 
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {( 30 45 )}"
 "Проверить, что курсор над ссылкой"
;

PROCEDURE "Подвести курсор мыши правее ссылки 'Налог на прибыль' и сравнить с эталоном индекс курсора мыши"
 "Перейти к следующей ссылке"
 "Установить курсор мыши чуть правее правого края текущего редактора"
 "Проверить, что курсор вне ссылки"
;

PROCEDURE "Изменить ширину левой части ААК (увеличить до 600), восстановить настройки конфигурации и убедиться, что ширина левой части ААК стала прежней"
 INTEGER VAR "Первоначальная ширина левой части"
 "Померить ширину левой части ААК-Содержания" >>> "Первоначальная ширина левой части"
 OBJECT VAR "Сплиттер"
 "Найти сплиттер в ААК-содержании" =: "Сплиттер"
 "Установить ширину контрола {("Сплиттер")} в пикселей {(600)}"
 "Восстановить все настройки текущей конфигурации"
 "Дождаться переключения вкладок"
 INTEGER VAR "Ширина с погрешностью слева"
 INTEGER VAR "Ширина с погрешностью справа"
 "Первоначальная ширина левой части" 1 - >>> "Ширина с погрешностью слева"
 "Первоначальная ширина левой части" 1 + >>>  "Ширина с погрешностью справа"
 Если ( "Первоначальная ширина левой части" "в интервале" ( "Ширина с погрешностью слева" "Ширина с погрешностью справа" ) ) то
  ( 'Ширина левой части ААК вернулась на свое место!' . )
 иначе
  ( false [ 'Ширина левой части ААК не вернулась на свое место! Должна быть: ' "Первоначальная ширина левой части" IntToStr ', а текущая: ' "Померить ширину левой части ААК-Содержания" IntToStr ] strings:Cat ASSERTS ) 
;

PROCEDURE "Потянуть вертикальный скроллер контрола вниз до конца редактора и сравнить его хинт с эталоном" OBJECT IN aControl
 "Проверить, что у контрола {(aControl)} есть вертикальный скроллер"
 VAR X
 VAR Y
 "Померить ширину {(aControl)}" >>> X
 X 10 - >>> X

  PROCEDURE Тянем_потянем
   "Установить курсор мыши по координатам {(X 19)} относительно контрола {(aControl)}"
   aControl "Померить высоту" >>> Y
   Y 30 - >>> Y
   THREAD (
    "Зажать левую кнопку мыши"
    "Установить курсор мыши по координатам {(X Y)} относительно контрола {(aControl)}"
    "Отпустить левую кнопку мыши" 
   )
   4 раза ( "Дождаться переключения вкладок"
    50 SLEEP 
    "Дать системе перерисоваться"
   )
   "Сравнить текст хинта с эталоном"
  ; // Тянем_потянем
 "Запомнить позицию мыши и выполнить {(@ Тянем_потянем)}"
;

PROCEDURE "Потянуть вертикальный скроллер в тексте вниз до конца и сравнить его хинт с эталоном"
 "Потянуть вертикальный скроллер контрола {("Контрол в фокусе")} вниз до конца редактора и сравнить его хинт с эталоном"
;

PROCEDURE "Сравнить с эталоном ширину кнопок статусбара"
  PROCEDURE Измеряем_ширину OBJECT IN l_It 
   "Дать системе перерисоваться"
   l_It ЯВЛЯЕТСЯ class::TnscStatusBarButton ? (
    l_It "Померить ширину" .   
   )
  ;

 "Для проверки сценария ошибки выполнить" (
  "Дождаться переключения вкладок"
  "Для всех видимых элементов статусбара {(контрол::StatusBar:push)} выполнить" Измеряем_ширину
 )
;

PROCEDURE "Убедиться, что у поля 'Дата принятия' есть красный крестик"
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(515 -20)}"
 "Дождаться появления хинта"
;

PROCEDURE "Установить высоту вкладки синхронного просмотра в 300 пикселей"
 300 "Вкладка синхронного просмотра документа" "Установить высоту"
;

PROCEDURE "Сравнить с эталоном высоту вкладки синхронного просмотра"
 "Вкладка синхронного просмотра документа" "Померить высоту" .
;

PROCEDURE "Несколько раз нажать PageDown, сравнить с эталоном текст ссылок, к которым перешли и убедиться, что дошли до конца документа"
 "Подготовить главное окно к тесту (установить ему размеры {(1380 900)} ) и выполнить" (
  "Вызываем форму контекстного поиска"
  "Поставить фокус в правую половину ААК-Содержания"
  6 раз ( "Нажать {('PgDn')}" )
  "Дождаться переключения вкладок"
  4 раза (
   "Сравнить выделенный текст текущего редактора с эталоном"
   'Номер параграфа в документе: ' "Узнать номер текущего параграфа" IntToStr Cat  .
   "Отделить текст в эталоне" 
   "Нажать {('PgDn')}"
  )
 )
;

PROCEDURE "Прокрутить КЗ так, чтобы 2-ая строка контекста стала верхней на экране"
 "Прокрутить колесо мыши вниз {(3)} раз для контрола {(контрол::Editor:push)}"
;

PROCEDURE "Провести курсором мышки по названиям полей"
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {( -100 -100 )}" 
 "Контрол в фокусе" pop:editor:CheckWithEtalon ( "Провести мышью вниз на {(300)} пикселей" )
;

PROCEDURE "Закрыть вкладку с СКР (крестиком)"
 "##Для проверки сценария ошибки выполнить" (
  "Дождаться переключения вкладок"
  OBJECT VAR "Комбобокс с выбором типа СКР"
  "Найти контрол {(контрол::bt_enCRList_SetType)} на форме {("Главное окно")}" =: "Комбобокс с выбором типа СКР"
  "Установить курсор мыши по координатам {(390 4)} относительно контрола {("Комбобокс с выбором типа СКР")}"
 "Дождаться появления хинта"
  Если ( "Узнать текущий хинт" РАВНО 'Закрыть' ) то
   ( "Клик левой кнопкой мыши" )
  иначе
   ( 'Не попали курсором мыши на кнопку Закрыть!' . )
 )
 "Дождаться переключения вкладок"
;

PROCEDURE "Кликнуть кнопку 'Ссылки из фрагмента (вид информации)' на тулбаре вкладки 'Оглавление'"
 "Перевести фокус в оглавление"
 "Кликаем кнопку {(контрол::bt_enDocumentBlock_opGetTypedRespondentList)} на тулбаре"
 "Дождаться переключения вкладок"
;

CONST Filter_for_test_K435457256 'K435457256'

WORDWORKER "Сохранить текущий объект в Мои документы и сделать"
 "Сохранить текущий объект в Мои документы и выполнить {(@  ( WordToWork DO ) )}"
;

PROCEDURE "Открыть модальное окно сохранения в Мои документы, выделить ранее сохраненный список и нажать кнопку 'Добавить'"
 PROCEDURE Добавляем_отфильтрованный_список
  "Найти контрол {(контрол::FoldersTree)} на форме {("Диалог сохранения в Мои документы")}" "Установить фокус"
  "Развернуть текущее дерево"
  "Нажать {('Down')}"
  "Добавить к списку"
 ;

 @ ( "Сохранить в Мои документы" ) MODAL ( Добавляем_отфильтрованный_список )
;

PROCEDURE "Сравнить с эталоном результат применения фильтра: если список есть - то названия документов, если список пустой - весь текст сообщения об этом"
 OBJECT VAR "Пустой список"
 "Найти контрол {("Информация о пустом списке")} на форме {("Главное окно")}" >>> "Пустой список"
 Если ( "Узнать, виден ли контрол {("Пустой список")}" ) то
  ( 'Видим пустой список:' . 
    "Установить фокус в пустой список"
   "Выделить всё"
   "Сравнить выделенный текст текущего редактора с эталоном" )
 иначе
  ( 'Список не пуст:' .
   "Сравнить список документов с эталоном" )
;

PROCEDURE "Сравнить с эталоном количество фильтров на одноименной вкладке"
 "Установить фокус во вкладку Фильтры"
 контрол::FiltersList:push "Узнать количество элементов дерева" .
;

WORDWORKER "Открыть окно создания фильтра и выполнить"
 @ "Создать новый фильтр" MODAL ( WordToWork DO )
 "##Дать тесту время для отрисовки контролов"
;

OBJECT FUNCTION "Группа в левом навигаторе" STRING IN aNameGroup
  PROCEDURE Действия_с_контролом OBJECT IN aCtrl
   Если ( ( aCtrl ЯВЛЯЕТСЯ class::TnscTasksPanelHideField )
   И ( aCtrl pop:HideField:GetCaption РАВНО aNameGroup ) ) то
    ( aCtrl =: Result
    "Закончить перебор контролов" )
  ; // Действия_с_контролом
 OBJECT VAR "Левый навигатор"
 контрол::LeftNavigator "Главное окно"  pop:control:FindControlByName =: "Левый навигатор"
 "Левый навигатор" "Узнать, существует ли объект" ! 'Не удалось найти левый навигатор' ASSERTS 
 "Выполнить для всех контролов {("Левый навигатор")}" Действия_с_контролом 
;

OBJECT FUNCTION "Группа 'Оглавление' в левом навигаторе"
 "Группа {('Оглавление')} в левом навигаторе" =: Result
;

WORDWORKER "Свернуть группу 'Оглавление' и выполнить"
 Если ( "Группа 'Оглавление' в левом навигаторе" pop:HideField:IsExpanded ) то
  ( false "Группа 'Оглавление' в левом навигаторе" pop:HideField:SetExpanded )
 "Дождаться переключения вкладок"
 ( WordToWork DO )
 "Дождаться переключения вкладок"
 Если ( "Группа 'Оглавление' в левом навигаторе" pop:HideField:IsExpanded ! ) то
  ( true "Группа 'Оглавление' в левом навигаторе" pop:HideField:SetExpanded )
; 

PROCEDURE "Сравнить с эталоном состояние свернутости группы 'Оглавление' в левом навигаторе"
 "Дождаться переключения вкладок"
 'Состояние свернутости группы Оглавление: ' "Группа 'Оглавление' в левом навигаторе" pop:HideField:IsExpanded ToPrintable Cat .
;

OBJECT FUNCTION "Группа 'Встроенные объекты' в левом навигаторе"
 "Группа {('Встроенные объекты')} в левом навигаторе" =: Result
;

PROCEDURE "Сравнить с эталоном состояние свернутости группы 'Встроенные объекты' в левом навигаторе"
 "Дождаться переключения вкладок"
 'Состояние свернутости группы Встроенные объекты: ' "Группа 'Встроенные объекты' в левом навигаторе" pop:HideField:IsExpanded ToPrintable Cat .
;

CONST Filter_for_test_K506709931 'K506709931'

PROCEDURE "Открыть сохраненный список из Моих документов и сравнить с эталоном статусную строку списка и выбран ли созданный фильтр"
 PROCEDURE Действия
  "Дождаться переключения вкладок"
  'Выбран ли фильтр (наличие синей галочки): ' .
  "Проверить, выбран ли фильтр с именем {(Filter_for_test_K506709931)}"
  "Убедиться, что фильтр {(Filter_for_test_K506709931)} автоприменяемый"
  "Отделить текст в эталоне"
  'Текущий список документов: ' .
  "Сравнить статусбар с эталоном"
 ;

 "Открыть сохраненный объект из Моих документов и выполнить {(@ Действия )}"
;

PROCEDURE "Сравнить с эталоном контекстное меню документа, поставленного на контроль (во вкладке 'Документы на контроле')"
 PROCEDURE Действия
  "Дождаться переключения вкладок"
  "Сравнить контекстное меню с эталоном"
 ;

 "Выполнить {(@ Действия )} с документами на контроле"
;

PROCEDURE "Сравнить с эталоном хинт кнопки на тулбаре" STRING IN aName
 OBJECT VAR "Кнопка на тулбаре"
 "Найти контрол {(aName)} на форме {("Главное окно")}" =: "Кнопка на тулбаре"
 "Аккуратно сравнить с эталоном логическое свойство {('ShowHint')} объекта {("Кнопка на тулбаре")}" 
 "Установить курсор по координатам {( 5 5 )} относительно контрола {("Кнопка на тулбаре")} и сравнить с эталоном его хинт"
;

PROCEDURE "Сравнить с эталоном хинты кнопок СКР на вкладке 'Оглавление'"
 "Сравнить с эталоном хинт кнопки {(контрол::bt_enDocumentBlock_opGetTypedCorrespondentList)} на тулбаре"
 "Сравнить с эталоном хинт кнопки {(контрол::bt_enDocumentBlock_opGetTypedRespondentList)} на тулбаре"
;

PROCEDURE "Установить фокус в дерево содержания первого уровня (слева)"
 "##Дать тесту время для отрисовки контролов"
 "Найти контрол {(контрол::FirstLevelContent)} на форме {("Главное окно")}" "Установить фокус"
;

PROCEDURE "Установить фокус в дерево атрибутов (справа)"
 "Дождаться переключения вкладок"
 "Найти контрол {(контрол::AttributeTree)} на форме {("Главное окно")}" "Установить фокус"
;

PROCEDURE "Слева выбираем ситуацию основного уровня 'Авиация' и сравниваем с эталоном 5 атрибутов из правой части, на которых стоит фокус"
 'Проверка при выборе атрибутов СЛЕВА: ' .
 "Установить фокус в дерево содержания первого уровня (слева)"
 "Найти атрибут {('Авиация')} в дереве {(контрол::FirstLevelContent)}"
 "Установить фокус в дерево атрибутов (справа)"
 5 раз ( "Сравнить заголовок текущего контрола с эталоном"
 "Стрелка вниз" )
;

PROCEDURE "Справа выбираем атрибут 'Авария' и сравниваем с эталоном 5 атрибутов из левой части, на которых стоит фокус"
 'Проверка при выборе атрибутов СПРАВА: ' .
  "Установить фокус в дерево атрибутов (справа)"
 "Переместиться в начало дерева"
 "Найти атрибут {('Авария')} в дереве {(контрол::AttributeTree)}"
 "Установить фокус в дерево содержания первого уровня (слева)"
 5 раз ( "Сравнить заголовок текущего контрола с эталоном"
 "Стрелка вниз" )
;

PROCEDURE "18 раз увеличить шрифт и сравнить с эталоном текущий размер текста (в диалоге Редактора стилей)"
 18 раз ( "Увеличить шрифт" )
 "Дождаться переключения вкладок"
 'Верхняя граница шрифта: ' "Текущий размер текста (в измененном Редакторе стилей)" ToPrintable Cat .
;

PROCEDURE "10 раз уменьшить шрифт и сравнить с эталоном текущий размер текста (в диалоге Редактора стилей)"
 10 раз ( "Уменьшить шрифт" )
 "Дождаться переключения вкладок"
 'Нижняя граница шрифта: ' "Текущий размер текста (в измененном Редакторе стилей)" ToPrintable Cat .
;

WORDWORKER "Поставить на контроль документы и выполнить" ARRAY IN anID

 PROCEDURE "Поставить на контроль? " BOOLEAN IN aNeedSet 
  @ ( INTEGER IN anItem
   "Открываем {( anItem )}" 
   Если ( aNeedSet ) то
    ( "Поставить на контроль" )
   иначе
    ( "Снять с контроля" )
  ) anID ITERATE
;

 "Поставить на контроль? {(true)}"
 TRY
  ( WordToWork DO )
 FINALLY 
  "Поставить на контроль? {(false)}"
 END
;

WORDWORKER "Открыть вкладку 'Документы на контроле' и выполнить"
 "Выполнить {( @ ( WordToWork DO ) )} с документами на контроле"
;

PROCEDURE "Сравнить с эталоном список документов, поставленных на контроль (сравниваем из вкладки)"
 "Открыть вкладку 'Документы на контроле' и выполнить" (
  "Сравнить развёрнутый список {(контрол::UnderControlList)} с эталоном"
 )
;

WORDWORKER "Вызвать диалог сохранения в Мои документы, открыть модальный диалог создания новой папки и выполнить"
 PROCEDURE Создаем_новую_папку
  OBJECT VAR "Кнопка Создать папку"
  "Найти контрол {(контрол::bt_enFolder_opNew)} на форме {("Диалог сохранения в Мои документы")}" >>> "Кнопка Создать папку"
  @ ( "Кнопка Создать папку" "Кликнуть" ) MODAL (
   "Дождаться переключения вкладок"  
   ( WordToWork DO )
  )
 ;

 @ ( "Сохранить в Мои документы" ) MODAL ( Создаем_новую_папку )
;

PROCEDURE "Сравнить с эталоном все активные настройки для пункта в Редакторе стилей" ARRAY IN aName
 "Выполнить с редактором стилей" (
  @ ( STRING IN aNameStyle
   "Установить фокус в Дерево стилей"
   "Переместиться в начало дерева"
   "Найти ссылку {(aNameStyle)} в дереве {(контрол::StyleTreeView)} и перейти по ней"
   30 раз ( 
    Если ( "Контрол в фокусе" "Имя компонента" РАВНО 'Editor' ) то 
      ( выходим )
    "Сравнить с эталоном имя текущего контрола"
    Если ( "Контрол в фокусе" ЯВЛЯЕТСЯ class::TeeCheckBox ) то
     ( "Получить состояние чекбокса {("Контрол в фокусе")}" . ) 
    иначе
     ( "Сравнить заголовок текущего контрола с эталоном" )
    "Отделить текст в эталоне"
    "Нажать {('Tab')}"
   )
  ) aName ITERATE
 )
;

PROCEDURE "Выполнить с комбобоксом фильтрации элементов папок по типу" IN aProc
 OBJECT VAR "Комбобокс фильтрации элементов папок по типу"
 PROCEDURE Действия
  "Найти контрол {(контрол::bt_enFolders_opFiltrate)} на форме {("Главное окно")}" =: "Комбобокс фильтрации элементов папок по типу"
  "Комбобокс фильтрации элементов папок по типу" "Узнать, существует ли объект" ! 'Не нашли кобобокс' ASSERTS
  "Комбобокс фильтрации элементов папок по типу" "Установить фокус"
  aProc DO
 ; // Действия

 "Открыть мои документы и выполнить {(@ Действия )}"
; // "Выполнить с комбобоксом фильтрации элементов папок по типу"

PROCEDURE "Сравнить с эталоном найдется ли значение 'Фильтры' в комбобоксе на вкладке 'Мои документы'"
 PROCEDURE Действия
  "Запомнить значение комбобокса {("Контрол в фокусе")} и выполнить" (
   "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Фильтры')}"
 )
 ; // Действия

 "Выполнить {(@ Действия )} с комбобоксом фильтрации элементов папок по типу"
;

PROCEDURE "Построить список ссылок на документ, если их больше 50 штук"
 "Ответить один раз Да для {(@ "Ссылки на документ")}"
;

WORDWORKER "Убедиться, что появился диалог с кнопкой 'Нет' после следующих действий"
  "{(@  ( WordToWork DO ) )} и проверить наличие диалога с кнопкой Нет"
;

PROCEDURE "Кликнуть 5 раз на кнопки для типов БП и сравнить с эталоном выбранность ВСЕХ кнопок расширенно " BOOLEAN IN anName
 INTEGER VAR X
 35 >>> X
 5 раз ( OBJECT VAR "Точка отсчета"
  "Найти контрол {(контрол::flAttributeSearch)} на форме {("Главное окно")}" =: "Точка отсчета"
  "Установить курсор мыши по координатам {( X -70 )} относительно контрола {("Точка отсчета")}"
  "Клик левой кнопкой мыши"
  Если ( anName ) то
   ( "Проверить выбранность всех типов информации для БП на ТБ24" )
  иначе 
   ( "Проверить выбранность всех типов информации для БП на ТБ27" )
  "Отделить текст в эталоне"
  X 140 + >>> X 500 SLEEP 
 )
;

PROCEDURE "Кликнуть 5 раз на кнопки для типов БП и сравнить с эталоном выбранность ВСЕХ кнопок на ТБ24"
 "Кликнуть 5 раз на кнопки для типов БП и сравнить с эталоном выбранность ВСЕХ кнопок расширенно {(true)}"
;

PROCEDURE "Кликнуть 5 раз на кнопки для типов БП и сравнить с эталоном выбранность ВСЕХ кнопок на ТБ27"
 "Кликнуть 5 раз на кнопки для типов БП и сравнить с эталоном выбранность ВСЕХ кнопок расширенно {(false)}"
;

PROCEDURE "Открыть диалог сохранения в папку и сравнить с эталоном значение типизированного фильтра"
 PROCEDURE Добавляем_отфильтрованный_список
  "Найти контрол {(контрол::bt_enFolders_opFiltrate)} на форме {("Диалог сохранения в Мои документы")}" "Установить фокус"
  "Заголовок текущего контрола" .
 ;

 @ ( "Сохранить в Мои документы" ) MODAL ( Добавляем_отфильтрованный_список )
;

WORDWORKER "Открыть вкладку ПЗ и выполнить"
 "Открыть панель задач и выполнить {(@  ( WordToWork DO ) )}"
;

PROCEDURE "Убедиться, что вкладка ПЗ не открыта"
 OBJECT VAR "Панель задач"
 "Найти контрол {(форма::TasksPanel)} по имени на форме {("Главное окно")}" =: "Панель задач"
 "Панель задач" "Узнать, существует ли объект" 'Вкладки ПЗ быть не должно!' ASSERTS 
;

OBJECT FUNCTION "Комбобокс для выбора страны в списке фармацевтических фирм"
 OBJECT VAR "Список фирм"
 "Контрол в фокусе" "Получить родительскую форму" =: "Список фирм"
 "Найти контрол {(контрол::bt_enMedicFirmList_opCountryFilter)} по имени на форме {("Список фирм")}" =: Result
 Result "Узнать, существует ли объект" ! 'Не нашли комбобокс' ASSERTS
;

PROCEDURE "Сравнить с эталоном индекс текущего значения в комбобоксе"
 "Контрол в фокусе" "Узнать индекс текущего значения в комбобоксе" .
;

PROCEDURE "Установить значение в текущем комбобоксе" INTEGER IN aNum 
 --! aNum 
 aNum "Контрол в фокусе" "Установить значение в комбобоксе"
;

PROCEDURE "Выделить 3 нижних параграфа в документе и сравнить их с эталоном"
 "В конец документа"
 3 раза ( "Перейти на параграф вверх" )
 "Выделить {(3)} параграфов"
 "Сравнить выделенный текст текущего редактора с эталоном"
; 

WORDWORKER "##Подготовить настройки системы к выполнению следующего теста и выполнить"
 "Восстановить все настройки текущей конфигурации"
 "Запомнить позицию мыши и выполнить {(@ ( WordToWork DO ) )}"
;

PROCEDURE "Настройка конфигурации - Настройка интерфейса - Панель навигации - с левой стороны - Положение: Авто"
 @ "Настройка конфигурации" MODAL (  
  "Путь до контрола: {(1)} раз вниз, {(2)} раз Tab"
  "Дождаться переключения вкладок"
  Если ( "Контрол в фокусе" ЯВЛЯЕТСЯ class::TvtComboBoxQS ) то 
   ( "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Авто')}" )
  иначе
   ( 'Не попали в нужный комбобокс!' . )
  "Кликаем Ок в Настройке конфигурации"
 )
 "Дождаться переключения вкладок"
;

WORDWORKER "##Для повторения ошибки (476367908) выполнить"
 "##Подготовить настройки системы к выполнению следующего теста и выполнить" (
 TRY
  ( WordToWork DO )
 FINALLY
  "Восстановить все настройки текущей конфигурации"
  "Дождаться переключения вкладок"
  "Перевести фокус в оглавление"
  "Перенос по словам"
 END
 )
;

PROCEDURE "Подводим курсор к левому краю окна для появления вкладки"
 "Установить курсор мыши по координатам {( 15 300 )} относительно контрола {("Главное окно")}"
 "Дождаться переключения вкладок"
;

PROCEDURE "Переводим фокус в документ (кликом мышки)"
 "Дождаться переключения вкладок"
 "Установить курсор мыши по координатам {( 500 300 )} относительно контрола {("Главное окно")}"
 "Клик левой кнопкой мыши"
 "Дождаться переключения вкладок"
;

PROCEDURE "Тянем мышкой выделение от самого начала вниз"
 INTEGER VAR X
 INTEGER VAR Y
 контрол::Text:push "Померить ширину" >>> X
 контрол::Text:push "Померить высоту" >>> Y
 X 2 / >>> X
 THREAD (
  400 SLEEP
  15 раз ( 
   "Установить курсор мыши по координатам {(X Y)} относительно контрола {("Контрол в фокусе")}"
   Y 2 + >>> Y
   300 SLEEP
  )
 "Отпустить левую кнопку мыши"
 )
 "Установить курсор мыши посередине редактора {("Контрол в фокусе")}"
 "Зажать левую кнопку мыши"
;

PROCEDURE "Нажать Enter и в появившемся модальном окне отметить все значения с атрибутом ИЛИ"
 PROCEDURE Действия
  "Выделить всё" 
  "Выбрать атрибут ИЛИ"
  "Дождаться переключения вкладок"
  "Нажать Искать"
 ;
 "Обработать Enter модально" ( Действия )
;

PROCEDURE "Скроллировать документ до начала"
 "Прокрутить колесо мыши вверх {(750)} раза для контрола {(контрол::Text:push)}"
;

WORDWORKER "##Запомнить позицию мыши и выполнить"
 "Запомнить позицию мыши и выполнить {(@ ( WordToWork DO ) )}"
;

PROCEDURE "Перевести фокус в поле 'Слова в тексте' и кликнуть 2 раза в этом поле мышкой"
 PROCEDURE Действия
  "Перевести фокус в поле 'Слова в тексте' в ППР"
  "Установить курсор мыши на левый край редактора {("Контрол в фокусе")}"
  "Двойной клик"
 ;
 "Запомнить позицию мыши и выполнить {(@ Действия )}"
;

WORDWORKER "Открыть документ 2001, отдочить вкладку 'Структура документа' и выполнить"
  PROCEDURE Действия_с_вкладкой
   "Перевести фокус в документ"
   ( WordToWork DO ) 
  ;
 PROCEDURE Действия
  "Перевести фокус в список внешних объектов"
  "Выполнить {(@ Действия_с_вкладкой )} с отдоченной вкладкой Оглавление"
 ;
 "Сделать {(@ Действия )} с комментариями в документе {(2001)}"
;

PROCEDURE "Установить курсор в первый комментарий"
 "В начало документа"
 "Перейти на параграф вниз"
;

PROCEDURE "Сравнить с эталоном ширину и высоту блока 'Мои комментарии' во вкладке 'Структура документа'"
 "Перевести фокус в комментарии"
 "Сравнить с эталоном размеры контрола {(контрол::lstComments:push)}"
;

PROCEDURE "Свернуть все пункты дерева Оглавления"
 "Перевести фокус в оглавление"
 "Свернуть текущее дерево"
 "Перевести фокус в документ"
;

PROCEDURE "Убедиться, что высота дерева Оглавления больше 450 пикселей"
 "Перевести фокус в оглавление"
 контрол::ContentsTree:push "Померить высоту" БОЛЬШЕ 450 'Почему-то высота дерева Оглавления меньше положенной!' ASSERTS
;

PROCEDURE "Прокрутить колесо мыши вниз раз для текста документа" INTEGER IN aCount
 "Прокрутить колесо мыши вниз {(aCount)} раз для контрола {(контрол::Text:push)}"
;

PROCEDURE "В поле 'Орган/Источник' ввести контекст 'Органы власти Волгоградской области'"
 "Перевести фокус в поле 'Орган/Источник' в ППР"
 "в поле 'Орган/Источник' ввести {('Органы власти Волгоградской области')}"
;

PROCEDURE "Удалить верхнюю строку с выбранным реквизитом кликом по красному крестику"
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(715 -54)}"
 "Дождаться появления хинта"
 "Узнать текущий хинт" РАВНО 'Удалить/очистить строку ввода' 'Не попали на нужную кнопку' ASSERTS
 "Клик левой кнопкой мыши"
 "Дождаться переключения вкладок"
;

PROCEDURE "Открыть баллон синей медали (в документе) и кликнуть по ссылке 'см. в справке'"
 "##Запомнить позицию мыши и выполнить" (
  "Ставим указатель мыши на ссылку в баллоне синей медали документов на контроле в документе"
  "Клик левой кнопкой мыши"
  "##Дать тесту время для отрисовки контролов"
 )
;

PROCEDURE "Сравнить введенный текст с эталоном"
 "Выделить всё"
 "Сравнить выделенный текст текущего редактора с эталоном"
;

WordAlias "Сравнить текущий текст с эталоном" "Сравнить введенный текст с эталоном"

PROCEDURE "Зайти в документ и открыть текущий документ в новом окне" INTEGER IN aNum
 "Открыть документ {(aNum)} в новом окне, предварительно выполнив с ним {(@ NOP)} и сделать {(@ NOP)}"
;

PROCEDURE "Вызвать контекстное меню из первой ячейки таблицы 2 раза"
 2 раза  ( "Перейти на параграф вниз" )
 THREAD ( "Секундная пауза"
  "Установить курсор мыши чуть левее левого края текущего редактора" 
  "Дождаться переключения вкладок"
  "Клик левой кнопкой мыши"
 )
 THREAD ( 400 SLEEP 
  "Установить курсор мыши на левый край текущего редактора"
  "Клик правой кнопкой мыши"
  "Дождаться переключения вкладок"
 )
 "Установить курсор мыши чуть правее левого края текущего редактора"
 "Клик правой кнопкой мыши"
;

PROCEDURE "Открыть вкладку 'Мои документы' и вызвать контектное меню на сохранённой закладке"
 "Открыть вкладку 'Мои документы' и выполнить" (
  3 раза "Дождаться переключения вкладок"
  "Дать системе перерисоваться"
  "Развернуть текущее дерево"
  "Стрелка вниз"
  "Дождаться переключения вкладок"
  THREAD ( 400 SLEEP
   "Установить курсор мыши по координатам {(75 5)} относительно контрола {(контрол::FoldersTree:push)}"
   "Клик левой кнопкой мыши"
  )
  "Установить курсор мыши по координатам {(75 25)} относительно контрола {(контрол::FoldersTree:push)}"
  "Клик правой кнопкой мыши"
 )
 "Дождаться переключения вкладок"
;

PROCEDURE "В комбобокс выбора размера шрифта для печати и экспорта ввести значение и сохранить изменения" STRING IN aSize
  PROCEDURE Действия_с_контролом OBJECT IN aCtrl
  ( aCtrl ЯВЛЯЕТСЯ class::TvtRadioButton ) 
  И ( aCtrl "Заголовок контрола"РАВНО 'Использовать для экспорта и печати следующий размер шрифта' ) ? (
   aCtrl "Узнать, отмечен ли RadioButton?" ! ? (
    true aCtrl "Нажать на RadioButton"
    "Нажать {('Down')}"
    "Дождаться переключения вкладок"
   ) // устанавливам RadioButton в true
  ) // ищем нужный RadioButton
  "Дождаться переключения вкладок"
  aCtrl ЯВЛЯЕТСЯ class::TvtComboBoxQS ? (
   aCtrl "Установить фокус"
   "Установить курсор мыши по координатам {( 10 10 )} относительно контрола {("Контрол в фокусе")}"
   "Двойной клик"
   "Ввести строку {(aSize)}"
   'После ввода значения в комбобоксе: ' "Заголовок контрола {("Контрол в фокусе")}" ToPrintable Cat .
  )
 ;
 "##Запомнить позицию мыши и выполнить" (
  OBJECT VAR "GroupBox"
  "Контрол в фокусе" "Перейти к родительской форме" >>> "GroupBox"
  "Выполнить для всех контролов {("GroupBox")}" Действия_с_контролом 
  "Кликаем Ок в Настройке конфигурации"
  "Дождаться переключения вкладок"
 )
;

PROCEDURE "Сравнить с эталоном, какой  размер шрифта для печати и экспорта выбран в комбобоксе в настройках конфигурации"
 TRY
  @ "Настройка конфигурации" MODAL (  
   "Путь до контрола: {(0)} раз вниз, {(12)} раз Tab"
   "Контрол в фокусе" ЯВЛЯЕТСЯ class::TvtComboBoxQS ? (
    'После сохранения настроек конфигурации в комбобоксе значение: ' "Заголовок контрола {("Контрол в фокусе")}" ToPrintable Cat .
   )
  )
 FINALLY
 "Дождаться переключения вкладок"
 "Восстановить все настройки текущей конфигурации"
 END
;

PROCEDURE "В комбобокс выбора размера шрифта для печати и экспорта ввести значение '7' и сохранить изменения"
 @ "Настройка конфигурации" MODAL (  
  "Путь до контрола: {(2)} раз вниз, {(12)} раз Tab"
  "В комбобокс выбора размера шрифта для печати и экспорта ввести значение {('7')} и сохранить изменения"
 )
 "Дождаться переключения вкладок"
;

PROCEDURE "В комбобокс выбора размера шрифта для печати и экспорта ввести значение '77' и сохранить изменения"
 @ "Настройка конфигурации" MODAL (  
  "Путь до контрола: {(2)} раз вниз, {(12)} раз Tab"
  "В комбобокс выбора размера шрифта для печати и экспорта ввести значение {('7')} и сохранить изменения"
 )
 "Дождаться переключения вкладок"
;

WORDWORKER "Открыть вкладку 'Список конфигураций' и выполнить"
 "Выполнить {(@ ( WordToWork DO ) )} с вкладкой Список конфигураций"
;

PROCEDURE "Удалить текущую конфигурацию"
 OnTest
  "Дождаться переключения вкладок"
 "Ответить один раз Да для {(@ "Нажать Del")}"
;

PROCEDURE "Открыть вкладку 'Список конфигураций' и скопировать Расширенную. Убедиться, что введя имя конфигурации 'Расширенная' получим диалог с ошибкой"
 TRY
  "Открыть вкладку 'Список конфигураций' и выполнить" (
  "Найти атрибут {('Расширенная')} в дереве {(контрол::tvConfs)}"  
  @ "Копировать текущую конфигурацию" MODAL (  
   "Путь до контрола: {(0)} раз вниз, {(1)} раз Tab"
   "Ввести строку {('Расширенная')}"
   "Выполнить подавив исключение" ( "Кликаем Ок в Настройке конфигурации" )
  )  
 )
FINALLY
 "Открыть вкладку 'Список конфигураций' и выполнить" (
  "Найти атрибут {('Копия Расширенная')} в дереве {(контрол::tvConfs)}"  
  "Контрол в фокусе" "Заголовок контрола" РАВНО 'Копия Расширенная' 'Текущая конфигурация не копия Расширенной!' ASSERTS 
  "Удалить текущую конфигурацию"
 )
END
;

PROCEDURE "Перейти по ссылке в документ 9003"
 "Дождаться переключения вкладок"
 3 раза "Перейти к следующей ссылке"
 "Перейти по текущей ссылке"
;

PROCEDURE "Дважды кликнуть ссылку 'Открыть ППР по скрипту'"
 "Дождаться появления хинта"
 "Узнать текущий хинт" РАВНО 'Хинт к ППР, который открывается по скрипту' 'Попали не на нужную ссылку! Хинт не для открытия ППР по скрипту' ASSERTS
 "Двойной клик"
;

PROCEDURE "Выбрать следующую редакцию"
 "Стрелка вверх"
 "Дождаться переключения вкладок"
;

PROCEDURE "Открыть вкладку Меню и сразу закрыть её"
 "Выполнить {(@ NOP)} с меню во вкладке и закрыть её"
;

PROCEDURE "Пробежаться по всем полям КЗ ППР (по Tab)"
 "Пробежаться по всем полям КЗ ППР (по Tab) и выполнить" ( NOP )
;

PROCEDURE "Открыть термин " STRING IN aStr
 "Перевести фокус в дерево терминов"
 "Найти ссылку {(aStr)} в дереве {(контрол::WordsTree)} и перейти по ней"
 "Перевести фокус в текст"
;

PROCEDURE "Поставить комментарий после заголовка и перед вторым абзацем текста, вызвать контекстный поиск и искать контекст 'в дальнейшем'"
 TRY
  "Ставим комментарий"
  2 раза ( "Перейти на параграф вниз" )
  "Ставим комментарий"
  "Найти в документе строку {('в дальнейшем')}"
 FINALLY
  "Удалить комментарий у {(3700001)} термина, поставленный в начале"
  2 раза ( "Перейти на параграф вниз" ) 
  "Контекстной операцией удаляем комментарий"
 END 
;

PROCEDURE "Сравнить с эталоном скопированный в буфер текст в формате EVEREST"
 CF_EVERESTBIN clipboard:GetFormattedText EvdBin2EvdTxt .
;

PROCEDURE "Сравнить с эталоном, что введено в поле 'Статус регистрации'"
 "Перевести фокус в поле 'Статус регистрации' в КЗ ИнФарма"
 'В поле "Статус регистрации" введено: ' . 
 "Сравнить абзац текущего редактора с эталоном"
 "Отделить текст в эталоне"
;

PROCEDURE "Открываем вкладку 'Аннотация к документу' в синхронном просмотре списка"
 "Кликаем кнопку {('bt_enSynchroView_opAnnotation')} на тулбаре" 
;

PROCEDURE "Переключиться в списке на документ 900100 и сравнить с эталоном нажата ли кнопка 'Текст документа' на тулбаре"
 "Перевести фокус в список"
 "Переместиться в начало дерева"
 "Найти документ {('Документ (900100) ver 1.0')} в списке"
 OBJECT VAR "Нужная кнопка"
 "Найти контрол {('bt_enSynchroView_ShowText')} на форме {("Главное окно")}" =: "Нужная кнопка" 
 'Нажата ли кнопка Текст документа?' .
 "Узнать численную {('Down')} переменную объекта {("Нужная кнопка")}" 0 ?!= .
 "Отделить текст в эталоне"
;

PROCEDURE "Переключиться на вкладку 'Синхронный просмотр' и сравнить с эталоном контрол в фокусе"
 "Переключиться на вкладку {('Синхронный просмотр')}"
 'Переключились на вкладку Синхронный просмотр. Фокус в : ' .
 "Контрол в фокусе" .
;

PROCEDURE "Кликнуть по кнопке выбора типа информации 'Судебная практика'"
 OBJECT VAR "Точка отсчета"
 "Найти контрол {(контрол::flAttributeSearch)} на форме {("Главное окно")}" =: "Точка отсчета"
 "Установить курсор мыши по координатам {( 335 -70 )} относительно контрола {("Точка отсчета")}"
 "Клик левой кнопкой мыши"
 "Дождаться переключения вкладок"
;

PROCEDURE "Ввести в БП контекст" STRING IN aStr
 "Очистить строку БП"
 "Ввести строку {(aStr)}"
;

PROCEDURE "В настройке конфигурации выбираем: Документ\Выделение текста\Постоянное"
 "Восстановить все настройки текущей конфигурации"
 @ "Настройка конфигурации" MODAL ( 
  "Путь до контрола: {(5)} раз вниз, {(9)} раз Tab"
  
  Если ( "Контрол в фокусе" ЯВЛЯЕТСЯ class::TvtComboBoxQS ) то
   ( "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Постоянное')}" )
  иначе
   ( "Контрол в фокусе" . )
  "Кликаем Ок в Настройке конфигурации" 
 )
; 

WORDWORKER "##Восстановить настройки конфигурации, выполнив перед этим"
 TRY
  "Запомнить позицию мыши и выполнить {(@ ( WordToWork DO ) )}"
 FINALLY
  "Восстановить все настройки текущей конфигурации"
 END
;

WORDWORKER "Зажать кнопку и выполнить" STRING IN aName
// PROCEDURE 
//  "Установить курсор мыши по координатам {(10 60)} относительно контрола {(контрол::Text:push)}"
//  "Клик левой кнопкой мыши"
// ;

 "Выполнить {(@ ( WordToWork DO ) )} с зажатой клавишей {(aName)}"
;

PROCEDURE "Выделить несколько отдельно стоящих фрагментов текста"
 3 раза ( "Выделить слово справа"
 2 раза "Перейти на параграф вниз" )
 "Дождаться переключения вкладок"
;

PROCEDURE "Кликнуть левой кнопкой мыши в текстовом поле редактора"
 "Ставим указатель мыши на конец текущего параграфа редактора {(контрол::Text:push)} со смещением {(10 10)}"
 "Клик левой кнопкой мыши"
 "Дождаться переключения вкладок"
;

PROCEDURE "Нажать на кнопку 'Сравнить полные тексты редакций' в статусной строке"
 PROCEDURE Ищем_нужную_кнопку OBJECT IN l_It 
  l_It "Заголовок контрола" РАВНО 'Сравнить полные тексты редакций' ? (
   l_It "Кликнуть" )
 ; 
 "Для всех видимых элементов статусбара {(контрол::StatusBar:push)} выполнить" Ищем_нужную_кнопку
 "Дождаться переключения вкладок"
;

PROCEDURE "Кликнуть слева от первого документа списка (на месте плюсика)"
 "##Запомнить позицию мыши и выполнить" (
  "Установить курсор мыши по координатам {(18 20)} относительно контрола {(контрол::tvList:push)}"
  "Клик левой кнопкой мыши"
 ) 
 "Дождаться переключения вкладок"
;

INTEGER FUNCTION "Количество открытых окон Гаранта"
 0 >>> Result
 PROCEDURE "Перебор главных окон" INTEGER IN hWnd
  STRING VAR lClass
  hWnd wnd:GetClassName >>> lClass
  ( lClass РАВНО 'TnsMainWindow' ) ? 
   ( ++! Result )  
 ; 

 @ "Перебор главных окон" IterateWindows
;

PROCEDURE "Ставим галочку в Настройке конфигурации\Документ\Открывать ссылки в новом окне"
 "Восстановить все настройки текущей конфигурации"
 @ "Настройка конфигурации" MODAL (  
  "Путь до контрола: {(5)} раз вниз, {(1)} раз Tab"
  "Поставить галочку в чекбоксе" 
  "Кликаем Ок в Настройке конфигурации"
 )
; 

PROCEDURE "Ставим галочку в Настройке конфигурации\Настройки интерфейса\Открывать ссылки из документов\В новом окне"
 "Восстановить все настройки текущей конфигурации"
 @ "Настройка конфигурации" MODAL (  
  "Путь до контрола: {(1)} раз вниз, {(7)} раз Tab"
  3 раза ( 
   Если ( "Контрол в фокусе" "Заголовок контрола" РАВНО 'В новом окне' ) то
    ( "Кликаем Ок в Настройке конфигурации"
     выходим
    )
   иначе ( 
    "Нажать {('Down')}"
   )
  )
 )
; 

WORDWORKER "Открыть гиперссылку в новом окне и переключиться на первое окно, предварительно выполнив в новом окне следующие действия"
 TRY 
  "Открыть гиперссылку в новом окне, выполнить в нём {(@  ( WordToWork DO ) )} и переключиться на предыдущее окно"
 FINALLY  
  "Закрыть все окна кроме текущего"
  "Восстановить все настройки текущей конфигурации"
 END
;

PROCEDURE "Сравнить с эталоном количество открытых окон Гаранта"
 "Количество открытых окон Гаранта" .
;

PROCEDURE "Нажать Enter, в появившемся модальном окне выделить все, выбрать пункт конт. меню 'Снять выделение', выбрать атрибут ИЛИ для выделенных значений и нажать ОК"
 PROCEDURE Действия
  "Выделить всё"
  "Снять выделение"
  "Выбрать атрибут ИЛИ"
  "Дождаться переключения вкладок"
  "Нажать Искать"
 ;
 "Обработать Enter модально" ( Действия )
;

WORDWORKER "##Для проверки сценария ошибки выполнить (широкое окно)"
 "Установить окно оболочки на передний план"
 "Подготовить главное окно к тесту (установить ему размеры {( 1420 850 )} ) и выполнить" (
  "Запомнить позицию мыши и выполнить {(@ ( WordToWork DO ) )}"
 )
;

PROCEDURE "Кликнуть по кнопке 'Ещё'"
 "Очистить строку БП"
 "Установить курсор мыши на VG-контрол {(контрол::MoreTab)}"
 "Клик левой кнопкой мыши"
;

PROCEDURE "Сравнить все пункты комбобокса с эталоном" OBJECT IN ComboboxName
Если ( ( ComboboxName ЯВЛЯЕТСЯ class::TvtComboBoxQS )
 ИЛИ ( ComboboxName ЯВЛЯЕТСЯ class::TvcmComboBox ) 
 ИЛИ ( ComboboxName ЯВЛЯЕТСЯ class::TvtColorBox ) ) то
 (
  VAR l_File
  script:FileName '.cmbx' sysutils:ChangeFileExt
  sysutils:ExtractFileName >>> l_File
  l_File ComboboxName pop:ComboBox:SaveItems
  l_File '%' tests:CheckEtalon
 )
;

PROCEDURE "Сравнить с эталоном все значения комбобокса: Настройка конфигурации - Документы на контроле - Подтверждения - Действие при выборе изм. док. на контроле"
 @ "Настройка конфигурации" MODAL (  
  "Путь до контрола (в подтверждениях или метках на полях): {(7)} раз вниз, {(1)} раз вниз, {(9)} раз Tab"
  "Сравнить все пункты комбобокса {("Контрол в фокусе")} с эталоном" 
  "Нажать кнопку Отмена в Настройке конфигурации"
 )
;

WORDWORKER "Установить документ на контроль. Переключиться на ТБ27 и выполнить" INTEGER IN aNumDoc

 PROCEDURE Действия
  "Выполнить {(@ ( WordToWork DO ) )} с переключённой базой"
 ; // Действия

 TRY
  "##Запомнить позицию мыши и выполнить" (
  "Выполнить {(@ Действия )} с документом {(aNumDoc)} установленным на контроль"
  ) 
 FINALLY 
  "Закрыть синюю медаль документов на контроле"
 END
; // "Установить документ на контроль. Переключиться на ТБ27 и выполнить"

PROCEDURE "Зажав левую кнопку мыши выделить контекст, отпустить левую кнопку мыши и сравнить выделенный текст с эталоном"
 "##Запомнить позицию мыши и выполнить" (
  // "Установить курсор мыши на левый край текущего редактора"
  "Установить курсор мыши чуть правее левого края текущего редактора"
  THREAD (
   200 SLEEP
   "Установить курсор мыши на правый край текущего редактора"
   "Отпустить левую кнопку мыши"
   "Сравнить выделенный текст текущего редактора с эталоном"
  )
  "Зажать левую кнопку мыши"
 )
;

WORDWORKER "Кликнуть по гиперссылке и выполнить"
 PROCEDURE Действия
   "Клик левой кнопкой мыши"
   3 раза ( "Дождаться переключения вкладок" )
   ( WordToWork DO )
 ;

 VAR l_Main
 "Сохранить активное окно" >>> l_Main
 TRY
  "##Запомнить позицию мыши и выполнить" (
  INTEGER VAR x
  INTEGER VAR y
  "Контрол в фокусе" pop:editor:CursorCoordsToScreen >>> y >>> x
  y 6 + >>> y
  x 20 - >>> x
  x y mouse:SetCursorPosition
  "Дождаться переключения вкладок"
  "Убедиться, что текущий индекс курсора мыши {('crHandPoint')} и выполнить {(@ Действия)}"
  )
 FINALLY
  l_Main "Восстановить активное окно"
  3 раза ( "Дождаться переключения вкладок" )
  "Закрыть все окна кроме текущего"
 END
;

WORDWORKER "Раскрыть первый баллон 'Информация об изменениях' в НК и выполнить"
 TRY
  "Кликнуть мышкой по ссылке 'информация об изменениях' в НК"
  ( WordToWork DO )
 FINALLY
  "Кликнуть мышкой по ссылке 'информация об изменениях' в НК"
  "Проверка, закрылся ли баллон 'Информация об изменениях' "
 END
;

PROCEDURE "Выделить 3 верхних параграфа и сравнить их с эталоном в формате RTF"
 "В начало документа"
 "Выделить {(3)} параграфов"
 "Сравнить выделенный текст текущего редактора с эталоном в формате {(CF_RTF)}"
; // "Выделить 3 верхних параграфа и сравнить их с эталоном в формате RTF"

PROCEDURE "Сравнить с эталоном введенный контекст в полях 'Слова в названии' и 'Раздел/Тема'"
 "Дождаться переключения вкладок"
 'Слова в названии: ' .
 "Сравнить абзац текущего редактора с эталоном"
 'Раздел/Тема: ' .
 "Установить фокус в поле 'Раздел/Тема' "
 "Сравнить абзац текущего редактора с эталоном"
;

PROCEDURE "Перейти по ссылке 'см. схему Коллективные договоры' и сравнить с эталоном заголовок окна оболочки"
 PROCEDURE Действия
  "Клик левой кнопкой мыши"
  "Дождаться переключения вкладок"
  "Сравнить заголовок окна оболочки с эталоном"
 ;

 "Установить курсор мыши по координатам {(300 683)} относительно контрола {("Главное окно")}"
 "Дождаться переключения вкладок"
 "Убедиться, что текущий индекс курсора мыши {('crDefault')} и выполнить {(@ Действия)}"
;

PROCEDURE "Включить контекстный фильтр в Левом навигаторе"
 "Дождаться переключения вкладок"
 OBJECT VAR "Кнопка контекстного фильтра"
 "Найти контрол {('ContextFilterButton')} на форме {("Левый навигатор")}" =: "Кнопка контекстного фильтра"
 Если ( "Узнать численную переменную {('Down')} объекта {("Кнопка контекстного фильтра")}" 0 ?!= ! ) то
 ( "Кнопка контекстного фильтра" "Кликнуть"
  "Дождаться переключения вкладок"
  )
;

PROCEDURE "Выключить контекстный фильтр в Левом навигаторе"
 "Дождаться переключения вкладок"
 OBJECT VAR "Кнопка контекстного фильтра"
 "Найти контрол {('ContextFilterButton')} на форме {("Левый навигатор")}" =: "Кнопка контекстного фильтра"
 Если ( "Узнать численную переменную {('Down')} объекта {("Кнопка контекстного фильтра")}" 0 ?!= ) то
 ( "Кнопка контекстного фильтра" "Кликнуть"
  "Дождаться переключения вкладок"
  )
;

PROCEDURE "Сравнить с эталоном номер позиции фокуса в списке (lister)"
 "Контрол в фокусе" "Узнать номер позиции фокуса в списке" .
;

PROCEDURE "Прокрутить колесо мыши 7 раз"
 "Прокрутить колесо мыши вниз {(7)} раз для контрола {(контрол::Editor:push)}"
;

PROCEDURE "Кликнуть по текущему полю и, зажав ЛКМ, и повести мышь вниз"
 "Установить курсор мыши чуть правее левого края текущего редактора"
 THREAD ( 300 SLEEP 
  OBJECT VAR "Комбобокс нижнего тулбара"
  "Найти контрол {(контрол::bt_enQuery_opSearchType)} на форме {("Главное окно")}" >>> "Комбобокс нижнего тулбара"
  "Установить курсор мыши по координатам {(200 10)} относительно контрола {("Комбобокс нижнего тулбара")}"
  "Отпустить левую кнопку мыши"
 )
 "Зажать левую кнопку мыши"
;

PROCEDURE "Сравнить  содержимое тулбара вкладки 'Синхронный просмотр' с эталоном"
 "Переключиться на вкладку {('Синхронный просмотр')}"
 "Сравнить  содержимое тулбара {(форма::SynchroView)} объекта {('tbfcSynchroViewTop')} с эталоном"
 "Сравнить  содержимое тулбара {(форма::SynchroView)} объекта {('tbTextFormTop')} с эталоном"
 "Сравнить  содержимое тулбара {(форма::SynchroView)} объекта {('tbefListTop')} с эталоном"
;

PROCEDURE "Кликнуть кнопку 'Похожие документы' на тулбаре вкладки 'Синхронный просмотр'"
 "Кликаем кнопку {(контрол::bt_enSynchroView_opSimilarDocuments)} на тулбаре" 
 "Дождаться переключения вкладок"
;

WORDWORKER "##Запомнить положение фокуса"
 "Выполнить {(@ ( WordToWork DO ) )} и восстановить фокус"
;

PROCEDURE "Переключиться на вкладку 'Синхронный просмотр' и сравнить контрол в фокусе с эталоном"
 "Переключиться на вкладку {('Синхронный просмотр')}"
 'Переключились на вкладку Синхронный просмотр. Фокус в : ' .
 "Контрол в фокусе" .
;

WORDWORKER "##Выполнить сценарий ошибки и удалить в конце все комментарии у документа " IN aDoc 
 TRY
  ( WordToWork DO )
 FINALLY 
  "Закрыть F1."
  "Открываем {(aDoc)}"
  "В документе не должно быть комментариев"
 END
;

PROCEDURE "По первой ветке рубрикатора открываем документ НК РФ"
 "Построить список по первой ветке рубрикатора"
 "Найти документ {('Налоговый кодекс Российской Федерации (НК РФ) (с изменениями и дополнениями)')} в списке и открыть его"
;

PROCEDURE "Установить фокус в правую часть ППС (преемственный вид)"
 OBJECT VAR Focus_Right
 OBJECT VAR Parent_Control
 "Найти контрол {(контрол::ChildZone)} на форме {("Главное окно")}" =: Parent_Control
 "Найти контрол {(контрол::AttributeTree)} на форме {(Parent_Control)}" =: Focus_Right
 "Установить фокус в {(Focus_Right)}"
;

PROCEDURE "Установить фокус в левую часть ППС (преемственный вид)"
 OBJECT VAR Focus_Left
 OBJECT VAR Parent_Control
 "Найти контрол {(контрол::MainZone)} на форме {("Форма ППС")}" =: Parent_Control
 "Найти контрол {(контрол::AttributeTree)} на форме {(Parent_Control)}" =: Focus_Left
 "Установить фокус в {(Focus_Left)}"
;

PROCEDURE "##Установить фокус в левую часть ППС после переключения баз"
 OBJECT VAR l_Form
 ANYUSERTYPE форма::TreeAttributeSelect vcm:FindForm 'Не найдена форма OldSituationSearch' ASSERTS
 >>> l_Form
 l_Form .TefTreeAttributeSelect.AttributeTree pop:control:SetFocus
  'Не удалось поставить фокус в левую часть ППС после переключения баз' ASSERTS
 "Установить фокус в левую часть ППС (преемственный вид)"
;

PROCEDURE "Сравнить с эталоном 3 верхних значения дерева" STRING IN aCtrl
 "Сравнить первого ребёнка дерева {(aCtrl)} с эталоном"
 2 раза ( "Стрелка вниз"
  "Сравнить первого ребёнка дерева {(aCtrl)} с эталоном" )
;

WORDWORKER "Выключить версионные комментарии и выполнить"
 "Выполнить {(@ ( WordToWork DO ) )} с выключенными версионными комментариями"
;

PROCEDURE "Дважды кликнуть в пустой ячейке таблицы"
 "Убедиться, что фокус в таблице"
 "##Запомнить позицию мыши и выполнить" (
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(400 -40)}"
 "Двойной клик" )
;

PROCEDURE "Выбрать в Настройке конфигурации 'Поведение системы\Начало работы\Поиск по ситуации' и сохранить изменения"
 @ "Настройка конфигурации" MODAL ( 
  "Путь до контрола: {(2)} раз вниз, {(1)} раз Tab"
  "Дождаться переключения вкладок"
  "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Поиск по ситуации')}"
  "Дождаться переключения вкладок"
  "Кликаем Ок в Настройке конфигурации"
 )
;

 PROCEDURE "Включить 'Перенос по словам' в Левом навигаторе"
 "Дождаться переключения вкладок"
 OBJECT VAR "Кнопка 'Перенос по словам'"
 "Найти контрол {(контрол::bt_enTree_opWrap)} на форме {("Левый навигатор")}" =: "Кнопка 'Перенос по словам'"
 Если ( "Узнать численную переменную {('Down')} объекта {("Кнопка 'Перенос по словам'")}" РАВНО 0 ) то
 ( "Кнопка 'Перенос по словам'" "Кликнуть"
  "Дождаться переключения вкладок"
  )
;

PROCEDURE "Выключить 'Перенос по словам' в Левом навигаторе"
 "Дождаться переключения вкладок"
 OBJECT VAR "Кнопка 'Перенос по словам'"
 "Найти контрол {(контрол::bt_enTree_opWrap)} на форме {("Левый навигатор")}" =: "Кнопка 'Перенос по словам'"
 Если ( "Узнать численную переменную {('Down')} объекта {("Кнопка 'Перенос по словам'")}" РАВНО 1 ) то
 ( "Кнопка 'Перенос по словам'" "Кликнуть"
  "Дождаться переключения вкладок"
  )
;

WORDWORKER "Включить 'Перенос по словам' в левом навигаторе и выполнить"
 TRY
  "Включить 'Перенос по словам' в Левом навигаторе"
  ( WordToWork DO ) 
 FINALLY
  "Выключить 'Перенос по словам' в Левом навигаторе"
 END
;

PROCEDURE "Проверить, что в Оглавлении включился 'Перенос по словам'"
  "Перевести фокус в оглавление"
  "Развернуть текущее дерево"
  INTEGER VAR aNode
  0 >>> aNode
  100 раз ( 
   Если ( aNode контрол::ContentsTree:push "Высота ноды дерева" БОЛЬШЕ 40 ) то
     выходим 
    иначе (
    ++! aNode
   )
  aNode НЕРАВНО 100 'Высота нод дерева оглавления всегда меньше трех строк!' ASSERTS
 )
;

PROCEDURE "Установить фокус на кнопку 'Ещё' в БП (кликом правой кнопкой мыши на ней)"
 "Для проверки сценария ошибки выполнить" (
  "Установить курсор мыши на VG-контрол {(контрол::MoreTab)}"
  "Дождаться переключения вкладок"
  "Клик правой кнопкой мыши"
 )
;

PROCEDURE "Убедиться, что группа Основные возможности в ОМ Инфарм не существует"
 "Найти контрол {('tvOperations')} на форме {("Главное окно")}" pop:object:IsNil 'Нашли группу Основные возможности в ОМ Инфарм!' ASSERTS
;

PROCEDURE "Включить в Настройках конфигирации: Поведение системы / Начало работы - Основное меню Инфарм"
 "Восстановить все настройки текущей конфигурации"
  @ "Настройка конфигурации" MODAL ( 
  "Путь до контрола: {(2)} раз вниз, {(1)} раз Tab"
  "Дождаться переключения вкладок"
  "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Основное меню Инфарм')}"
  "Дождаться переключения вкладок"
  "Кликаем Ок в Настройке конфигурации"
 )
;

PROCEDURE "В Редакторе стилей для стиля 'Таблицы (моноширинный)' выбрать размер шрифта равным 8"
 "Выполнить с редактором стилей" (  
  "Установить фокус в Дерево стилей"
  "Найти ссылку {('Таблицы (моноширинный)')} в дереве {(контрол::StyleTreeView)} и перейти по ней"
  "Установить фокус на кнопку Типа наследования группы Размер"
  2 раза  (  "Нажать {('Enter')}" )
  // Устанавливаем тип наследования - Собственный
  "Установить фокус в комбобокс выбора размера шрифта в измененном Редакторе стилей"
  "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('8')}"
  "Нажать Enter"
 )
;

PROCEDURE "Сравнить с эталоном хинт для первого значка дерева"
 "##Запомнить позицию мыши и выполнить" (
  "Установить курсор мыши по координатам {(40 20)} относительно контрола {(контрол::tvList:push)}"
  "Дождаться появления хинта"
  "Сравнить текст хинта с эталоном"
 )
;

PROCEDURE "Сравнить с эталоном хинт для первого вхождения первого документа списка"
 "Установить курсор мыши по координатам {(70 60)} относительно контрола {(контрол::tvList:push)}"
 "Дождаться появления хинта"
 "Сравнить текст хинта с эталоном"
;

PROCEDURE "Сравнить с эталоном хинты для первых четырех вхождений первого документа списка"
 "Сравнить с эталоном хинт для первого вхождения первого документа списка"
 "Установить курсор мыши по координатам {(70 110)} относительно контрола {(контрол::tvList:push)}"
 "Дождаться появления хинта"
 "Сравнить текст хинта с эталоном"
 "Установить курсор мыши по координатам {(70 150)} относительно контрола {(контрол::tvList:push)}"
 "Дождаться появления хинта"
 "Сравнить текст хинта с эталоном"
 "Установить курсор мыши по координатам {(70 190)} относительно контрола {(контрол::tvList:push)}"
 "Дождаться появления хинта"
 "Сравнить текст хинта с эталоном"
;

PROCEDURE "Сравнить с эталоном хинты для значков редакций и вхождения в списке"
 "##Для проверки сценария ошибки выполнить" (
  ППР
  "в поле 'Слова в тексте' ввести {('Арбитражный процессуальный кодекс')}"
  "в поле 'Искать в недействующих редакциях' поставить {('Да')}"
  "Нажать Искать"
  "Развернуть текущее дерево"
  "Сравнить с эталоном хинт для первого вхождения первого документа списка"
  "Установить курсор мыши по координатам {(70 110)} относительно контрола {(контрол::tvList:push)}"
  "Дождаться появления хинта"
  "Сравнить текст хинта с эталоном"
  "Установить курсор мыши по координатам {(95 150)} относительно контрола {(контрол::tvList:push)}"
  "Дождаться появления хинта"
  "Сравнить текст хинта с эталоном"
 )
;

PROCEDURE "Установить курсор мыши на изменённые параграфы в левой и правой частях СР и сравнить их хинты с эталоном"
 11 раз ( "Перейти на параграф вниз" )
 "Установить курсор мыши чуть правее левого края текущего редактора"
 "Дождаться появления хинта"
 "Сравнить текст хинта с эталоном"
 "##Отделить текст в эталоне"
 "Перевести фокус в левую редакцию"
 11 раз ( "Перейти на параграф вниз" )
 "Установить курсор мыши чуть правее левого края текущего редактора"
 "Дождаться появления хинта"
 "Сравнить текст хинта с эталоном"
;

WORDWORKER "Найти препарат и выполнить" STRING IN aName
 "Поиск лекарственного средства"
 "Ввести строку {(aName)}"
 "Нажать Искать"
 "Развернуть текущее дерево"
 ( WordToWork DO ) 
;

PROCEDURE "Выбрать вид информации 'Региональные акты' в комбобоксе 'Ещё'"
 "Установить фокус на кнопку 'Ещё' в БП (кликом правой кнопкой мыши на ней)"
 "Нажать Enter"
 "Убедиться, что выпадающий список 'Ещё' появился"
 2 раза ( "Нажать {('Down')}" )
 "Нажать Enter"
;

PROCEDURE "Раскрыть комбобокс вида информации 'Ещё' и закрыть его"
 "Установить фокус на кнопку 'Ещё' в БП (кликом правой кнопкой мыши на ней)"
 "Нажать Enter"
 "Убедиться, что выпадающий список 'Ещё' появился"
 "Нажать Esc"
;

PROCEDURE "Зажать 'Ctrl' и сбросить выделение последнего документа кликом мыши"
 "Установить курсор мыши по координатам {(100 250)} относительно контрола {(контрол::tvList:push)}"
 "Дождаться переключения вкладок"
 "Текущий индекс курсора мыши {('crHandPoint')}?"
 "Зажать кнопку {('Ctrl')} и выполнить" ( 
  "Клик левой кнопкой мыши" )
;

PROCEDURE "7 раз нажать 'Right' и убедиться, что фокус не ушел дальше поисковой строки БП"
 7 раз ( "Нажать {('Right')}" 
  "Контрол в фокусе" "Имя компонента" РАВНО контрол::ContextEdit 
   [ 'Фокус неожиданно оказался не в ContextEdit, а в : ' "Контрол в фокусе" "Имя компонента" ] strings:Cat 
    ASSERTS
 )
;

PROCEDURE "Установить фокус на кнопку 'Акты органов власти' в БП (кликом правой кнопкой мыши на ней)"
 "Для проверки сценария ошибки выполнить" (
  "Установить курсор мыши на VG-контрол {('Акты органов власти')}"
  "Дождаться переключения вкладок"
  "Клик правой кнопкой мыши"
 )
;

PROCEDURE "Установить фокус на кнопку 'Ещё' в БП в списке (кликом правой кнопкой мыши на ней)"
 "Перевести фокус в {(контрол::ContextEdit)} на форме {(форма::NewBaseSearch)}"
 "Для проверки сценария ошибки выполнить" (
  "Установить курсор мыши на VG-контрол {(контрол::MoreTab)}"
  "Дождаться переключения вкладок"
  "Клик правой кнопкой мыши"
 )
;

PROCEDURE "Выбрать вид информации 'Региональные акты' в комбобоксе 'Ещё' в списке (с помощью клавиатуры)"
 "##Для проверки сценария ошибки выполнить (широкое окно)" (
  "Установить фокус на кнопку 'Ещё' в БП в списке (кликом правой кнопкой мыши на ней)"
  "Нажать Enter"
  "Убедиться, что выпадающий список 'Ещё' появился"
  2 раза ( "Нажать {('Down')}" )
  "Нажать Enter"
  "Дождаться переключения вкладок"
 )
;

PROCEDURE "Кликнуть левой кнопкой мыши по заголовку 'Расширенные реквизиты документа'"
 "Не сохранять состояние редактора"
 "##Запомнить позицию мыши и выполнить" (
  "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(0 -55)}"
  "Клик левой кнопкой мыши"
 )
;

PROCEDURE "Сравнить с эталоном состояние свернутости заголовка 'Расширенные реквизиты документа'"
 "Узнать состояние развернутости группы {('AT_NORM')} в КЗ ППР" .
;

WORDWORKER "Свернуть группы Контекстный поиск, Правовой календарь, Реквизиты рег. в Миюсте, Расш. реквизиты документы и выполнить"
 "Свернуть {(true)} группы {( [ 'AT_TEXT_NAME' 'AT_REG_IN_MU' 'AT_NORM' 'AT_LC_IN_DATE' ] )} и выполнить" ( 
  ( WordToWork DO )
 )
;

PROCEDURE "Установить фокус на заголовок 'Оглавление' в левом навигаторе"
 "Найти контрол {('field_ContentsTree')} на форме {("Левый навигатор")}" "Установить фокус"
;

WORDWORKER "Свернуть все заголовки групп КЗ ППР и выполнить"
 "Свернуть {(true)} группы {( [ 'AT_TEXT_NAME' 'AT_TYPE'  'AT_LC_IN_DATE' 'AT_REG_IN_MU' 'AT_NORM' ] )} и выполнить" ( 
  "##Дать тесту время для отрисовки контролов"
  ( WordToWork DO )
 )
;

PROCEDURE "Включить показ меток на саб-панели на форме и сравнить с эталоном их видимость" OBJECT IN aForm
  PROCEDURE PrintSubDescription OBJECT IN aSubDescription INTEGER IN aHandle
   aSubDescription РАВНО 'TevSubLayerDescriptor' ? (
    [ 'Блок ' aHandle IntToStr ' виден: ' aSubDescription subdescriptor:GetVisible ToPrintable ] strings:Cat .
   )
  ;

 PROCEDURE Действия
  "Дать системе перерисоваться"
  OBJECT VAR aCtrl
  "Найти контрол {(контрол::SubPanel)} на форме {(aForm)}" >>> aCtrl
  @ ( PrintSubDescription ) aCtrl IterateSubDecriptorsOnSubPanel
 ;

 "Выполнить {(@ Действия )} с включёнными метками на саб-панели"
;

PROCEDURE "В поле 'Слова в тексте' ввести длинный контекст, удалить его и убедиться, что КЗ не растянулось"
 "Перевести фокус в поле 'Слова в тексте' в ППР"
 INTEGER VAR aFirstStateCoordY
 "Координата Y текущего параграфа" =: aFirstStateCoordY
 "в поле 'Слова в тексте' ввести {('С нею был коротко знаком человек очень замечательный. Вы слышали о графе Сен-Жермене, о котором рассказывают так много чудесного. Вы знаете, что он выдавал себя за вечного жида, за изобретателя жизненного эликсира и философского камня, и прочая. Над ним смеялись, как над шарлатаном, а Казанова в своих Записках говорит, что он был шпион; впрочем, Сен-Жермен, несмотря на свою таинственность, имел очень почтенную наружность и был в обществе человек очень любезный. Бабушка до сих пор любит его без памяти и сердится, если говорят об нем с неуважением. Бабушка знала, что Сен-Жермен мог располагать большими деньгами. Она решилась к нему прибегнуть. Написала ему записку и просила немедленно к ней приехать.')}"
 "Удалить"
 "Перевести фокус в поле 'Тип' в ППР"
 ( "Координата Y текущего параграфа" aFirstStateCoordY - ) МЕНЬШЕ 114 'КЗ ППР растянуто!' ASSERTS
;

OBJECT FUNCTION "Группа 'Мои комментарии' в левом навигаторе"
 "Группа {('Мои комментарии')} в левом навигаторе" =: Result
;

WORDWORKER "Свернуть группу 'Мои комментарии' и выполнить"
 Если ( "Группа 'Мои комментарии' в левом навигаторе" pop:HideField:IsExpanded ) то
  ( false "Группа 'Мои комментарии' в левом навигаторе" pop:HideField:SetExpanded ) 
 "Дождаться переключения вкладок"
 TRY
  ( WordToWork DO )
 FINALLY 
  "Дождаться переключения вкладок"
  Если ( "Группа 'Мои комментарии' в левом навигаторе" pop:HideField:IsExpanded ! ) то
  ( true "Группа 'Мои комментарии' в левом навигаторе" pop:HideField:SetExpanded )
 END
; 

PROCEDURE "Свернуть группу 'Мои комментарии', удалить комментарий и убедиться, что группа 'Оглавление' не пропала"
 "Свернуть группу 'Мои комментарии' и выполнить" (
  "Контекстной операцией удаляем комментарий" 
  "##Дать тесту время для отрисовки контролов"
  "Проверить, что контрол {("Группа 'Оглавление' в левом навигаторе")} видимый"
  "Перевести фокус в текст"
  "Ставим комментарий"
 )
;

PROCEDURE "Сравнить с эталоном значки на саб-панели формы " OBJECT IN aForm
 PROCEDURE PrintSubDescription OBJECT IN aSubDescription INTEGER IN aHandle
  [ 'Блок ' aHandle IntToStr ' на слое ' aSubDescription ToPrintable ': ' ] strings:Cat .
  'BitmapIndex: ' aSubDescription subdescriptor:GetDocumentBitmapIndex ToPrintable Cat .
  'BlockBitmapIndex: ' aSubDescription subdescriptor:GetBlockBitmapIndex ToPrintable Cat .
  'Visible: ' aSubDescription subdescriptor:GetVisible ToPrintable Cat .
  "Отделить текст в эталоне"
 ;

 "Дать системе перерисоваться"
 OBJECT VAR aCtrl
 "Найти контрол {(контрол::SubPanel)} на форме {(aForm)}" >>> aCtrl
 @ ( PrintSubDescription ) aCtrl IterateSubDecriptorsOnSubPanel
;


PROCEDURE "Сравнить с эталоном значки на саб-панели"
 "Сравнить с эталоном значки на саб-панели формы {("Главное окно")}"
;

PROCEDURE "Сравнить с эталоном значки на саб-панели вкладки"
 OBJECT VAR ChildForm
 "Найти окно по имени {(форма::Child)}" =: ChildForm  
 "Сравнить с эталоном значки на саб-панели формы {(ChildForm)}"
;

PROCEDURE "Прокрутить колесо мыши вниз раз для текущего контрола и сохранить результат в файл с расширением .shapes" INTEGER IN aCount
 aCount раз ( "Прокрутить колесо мыши вниз для контрола {("Контрол в фокусе")}" )
 "Контрол в фокусе" "Перерисовать редактор и сохранить результат в файл с расширением .shapes"
;

WordAlias "Прокрутить колесо мыши вниз раза для текущего контрола и сохранить результат в файл с расширением .shapes" "Прокрутить колесо мыши вниз раз для текущего контрола и сохранить результат в файл с расширением .shapes"

OBJECT FUNCTION "Сплиттер в левом навигаторе"
 PROCEDURE Действия_с_контролом OBJECT IN aCtrl
  Если ( aCtrl ЯВЛЯЕТСЯ class::TnpSplitter ) то
   ( aCtrl =: Result
   "Закончить перебор контролов" )
 ; // Действия_с_контролом

 "Выполнить для всех контролов {("Левый навигатор")}" Действия_с_контролом 
;

PROCEDURE "Нажать BackSpace и сравнить с эталоном оставшийся текст"
 "Дождаться переключения вкладок"
 "Нажать {('BkSp')}"
 "Сравнить абзац текущего редактора с эталоном"
;

WordAlias "Установить фокус в БП" "Установить фокус в БП после переключения баз"

PROCEDURE "Установить курсор мыши на сплиттер Левого навигатора"
 "Установить курсор мыши по координатам {(0 200 )} относительно контрола {("Сплиттер в левом навигаторе")}"
;

WORDWORKER "Кликнуть на ссылку 'Показать правила работы с контекстным поиском' и выполнить"
   PROCEDURE Действия_для_закрытия
    "Клик левой кнопкой мыши"
   ;

  PROCEDURE Действия_после_открытия
   "Клик левой кнопкой мыши"
   TRY
    ( WordToWork DO )
   FINALLY
    "Перевести фокус в поле 'Тип' в ППР"
    "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(-250 -95)}"
    "Убедиться, что текущий индекс курсора мыши {('crHandPoint')} и выполнить {(@ Действия_для_закрытия )}"
   END
  ;

 "Свернуть {(false)} группы {( [ 'AT_TEXT_NAME' 'AT_TYPE' ] )} и выполнить" (
  "Дождаться переключения вкладок"
  "Перевести фокус в поле 'Тип' в ППР"
  "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(-250 -95)}"
  "Убедиться, что текущий индекс курсора мыши {('crHandPoint')} и выполнить {(@ Действия_после_открытия )}"
 )
;

INTEGER FUNCTION "Узнать количество открытых выпадающих списков " STRING IN aName
 0 >>> Result
 PROCEDURE "Перебор главных окон" INTEGER IN hWnd
  STRING VAR lClass
  hWnd wnd:GetClassName >>> lClass
 ( lClass РАВНО aName ) ? (
  ( hWnd wnd:IsVisible ) ?
   ( ++! Result )
 ) 
; 

 @ "Перебор главных окон" IterateWindows
;

INTEGER FUNCTION "Узнать количество открытых выпадающих списков TevDropTree"
 "Узнать количество открытых выпадающих списков {('TevDropTree')}" =: Result
;

PROCEDURE "Сравнить с эталоном количество открытых выпадающих списков TevDropTree"
 'Количество открытых выпадающих списков: ' "Узнать количество открытых выпадающих списков TevDropTree" ToPrintable Cat .
;

WORDWORKER "Развернуть группу и выполнить" ARRAY IN aName
 "Свернуть {(false)} группы {( aName )} и выполнить" ( WordToWork DO ) 
;

PROCEDURE "Установить фокус в поле 'Тип' в ППР"
 "Не сохранять состояние редактора"
 OBJECT VAR l_QC
 "Убедиться, что фокус в редакторе"
 "Контрол в фокусе" >>> l_QC
 "Узнать состояние развернутости группы {('AT_TYPE')} в КЗ ППР" ! ?
  ( 'AT_TYPE' false l_QC "Установить свернутость группы КЗ" )
 "Перевести фокус в поле 'Тип' в ППР"
;

PROCEDURE "Навести мышкой на чекбокс с выбором логического условия, на кнопку-ссылку с названием реквизита и сохранить результат в файл с расширением .shapes"
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(-120 -55)}"
 "Провести мышью вниз на {(70)} пикселей"
 "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {(-180 -55)}"
 "Контрол в фокусе" pop:editor:CheckWithEtalon ( "Провести мышью вниз на {(70)} пикселей" )
;

PROCEDURE "Сравнить с эталоном все первые заголовки контрола tvTaxes в ОМ"
 "##Запомнить позицию мыши и выполнить" (
  "Перевести фокус в {(контрол::tvTaxes)} на форме {(форма::MainMenuNew)}"
  STRING VAR First_Value 
  "Заголовок текущего контрола" =: First_Value
  INTEGER VAR aIter
  0 =: aIter 
  "Установить курсор мыши по координатам {(10 -17)} относительно контрола {("Контрол в фокусе")}"
  10 раз (
   "Сравнить заголовок текущего контрола с эталоном"
   "Клик левой кнопкой мыши"
   ++! aIter
   aIter НЕРАВНО 10 'Или в ОМ слишком много нового или залипли!' ASSERTS
   "Дождаться переключения вкладок"
   Если ( "Заголовок текущего контрола" РАВНО First_Value ) то
    выходим
  )
 )
;

OBJECT FUNCTION  "Открыть гиперссылку в новом окне, записать его в стек и переключиться на предыдущее окно"
 VAR l_Main
 "Сохранить активное окно" >>> l_Main
 TRY
  "Открыть гиперссылку в новом окне"
  "Дождаться переключения вкладок"
  "Открытое окно" =: Result
 FINALLY
  l_Main "Восстановить активное окно"
  "Дождаться переключения вкладок"
 END
;

PROCEDURE "Открыть гиперссылку в новом окне, переключиться на первое окно и сравнить с эталоном активность кнопок навигации в НОВОМ окне"
 TRY
  OBJECT VAR New_Window
  "Открыть гиперссылку в новом окне, записать его в стек и переключиться на предыдущее окно" =: New_Window
  "Проверить активность кнопки {(контрол::bt_enHistory_opBack)} на форме {(New_Window)}"
  "Проверить активность кнопки {(контрол::bt_enHistory_opForward)} на форме {(New_Window)}"
 FINALLY
  "Закрыть все окна кроме текущего"
 END
;

PROCEDURE "Сравнить с эталоном наличие скроллера у контрола " OBJECT IN aCtrl
 'Вертикальный скроллер: ' aCtrl "Узнать, есть ли у контрола вертикальный скроллер" ToPrintable Cat .
;

PROCEDURE "Сравнить с эталоном наличие скроллера у Дерева оглавления"
 "Сравнить с эталоном наличие скроллера у контрола {(контрол::ContentsTree:push)}"
;

PROCEDURE "Открыть диалог Редактор стилей, найти стиль 'Напишите нам' и установить для него размер шрифта" STRING IN aSize
 PROCEDURE Изменяем_параметры_редактора_стилей
  "Установить фокус в Дерево стилей"
  "Перейти по ссылке {('Напишите нам')} в дереве {(контрол::StyleTreeView)}" ? (
   "Установить фокус в комбобокс выбора размера шрифта в Редакторе стилей"
   "Ввести строку {(aSize)}"
   "Нажать Enter"
  )
 ;

 "Выполнить с редактором стилей" ( Изменяем_параметры_редактора_стилей )
 "Дать системе перерисоваться"
;

PROCEDURE "Убедиться, что плашка 'Напишите нам' полностью видна"
 "##Дать тесту время для отрисовки контролов"
 "Проверить, что контрол {(контрол::edWriteToUs)} полностью виден"
;

PROCEDURE "Создать ссылку на документ (через главное меню) и сравнить с эталоном содержимое буфера"
 "##Дать тесту время для отрисовки контролов"
 'Фокус на: ' . 
 "Сравнить заголовок текущего контрола с эталоном"
 "Вызвать {('Файл/Создать ссылку на документ')} из главного меню"
 'В буфере: ' .
 "Записать содержимое буфера в эталон"
 "Отделить текст в эталоне"
;

WORDWORKER "Сделать фильтры и автоприменяемыми и выполнить" STRING IN aFilter1 STRING IN aFilter2 
 "Убедиться, что нет лишних фильтров"
 ППР
 "Открыть фильтры" 
 "Сделать фильтр {(aFilter1)} автоприменяемым и выполнить" (
  "Сделать фильтр {(aFilter2)} автоприменяемым и выполнить" (
   TRY
    ( WordToWork DO ) 
   FINALLY
    "##Действия для полного удаления фильтра"
   END
  )
 )
;

PROCEDURE "Установить курсор мыши на последнюю строку выпадающего списка Ещё"
 INTEGER VAR aW
 INTEGER VAR aH
 "Выпадающий список Ещё в БП" "Померить ширину" =: aW 
 "Выпадающий список Ещё в БП" "Померить высоту" =: aH
 aW 20 - =: aW
 aH 20 - =: aH
 "Установить курсор мыши по координатам {( aW aH )} относительно контрола {("Выпадающий список Ещё в БП")}"
 "Дождаться переключения вкладок"
 "Нажать {('Down')}"
 "Убедиться, что выпадающий список 'Ещё' появился"
;

PROCEDURE "Нажать стрелку влево"
 "Нажать {('Left')}"
;

WORDWORKER "Открыть документ со справкой и выполнить" INTEGER IN aNum
 "Открываем {(aNum)}"
 "В документе не должно быть комментариев"
 TRY
  ( WordToWork DO ) 
 FINALLY
  "Нажать {('BkSp')}" 
  aNum 100000 + =: aNum
  "Открываем {(aNum)}"
  "В документе не должно быть комментариев"
 END
;

PROCEDURE "Построить ОИД для первой и последней редакции"
 "Открыть вкладку Список редакций"
 "Выделить текущий элемент" 
 "Нажать {('Home')}"
 "Выделить текущий элемент" 
 "Нажать {('End')}"
 "Выделить текущий элемент"
 "Построить обзор изменений для выбранных редакций"
;

INTEGER FUNCTION "Узнать количество видимых значков на саб-панели формы " OBJECT IN aForm
 INTEGER FUNCTION PrintSubDescription OBJECT IN aSubDescription INTEGER IN aHandle
  0 =: Result
  aSubDescription subdescriptor:GetVisible ? ( ++! Result )
 ;

 "Дать системе перерисоваться"
 OBJECT VAR aCtrl
 "Найти контрол {(контрол::SubPanel)} на форме {(aForm)}" >>> aCtrl
 0 =: Result
 @ ( PrintSubDescription Result + =: Result ) aCtrl IterateSubDecriptorsOnSubPanel
;

PROCEDURE "Сравнить с эталоном количество видимых значков на саб-панели документа"
 "Узнать количество видимых значков на саб-панели формы {("Главное окно")}" .
;

WORDWORKER "Открыть диалог Настройка конфигурации и выполнить"
 @ "Настройка конфигурации" MODAL ( WordToWork DO )
;

PROCEDURE "Поставить галочку в чекбоксе Поиск - Подтверждения - Подтверждать построение списка"
 3 раза ( "Стрелка вниз" )
 2 раза ( "Разворачиваем текущий узел дерева" ) 
 "Нажать {('Tab')}"
 "Нажать {('Space')}"
;

PROCEDURE "Установить фокус в поле 'При количестве документов более' и ввести букву 'п'"
 "Нажать {('Tab')}"
 "Ввести строку {('п')}"
;

PROCEDURE "Снять галочку в чекбоксе Поиск - Подтверждения - Подтверждать построение списка"
 4 раза ( "Нажать {('Tab')}" )
 "Нажать {('Space')}"
;

PROCEDURE "Проверить, что в ППР и построенном списке есть вертикальный скроллер и он не пропадает"
 "##Для проверки сценария ошибки выполнить (широкое окно)" (
  ППР
  6 раз ( "Дождаться переключения вкладок"
   "Проверить, что у контрола {(контрол::Editor:push)} есть вертикальный скроллер"
  )
  "Нажать Искать"
  6 раз ( "Дождаться переключения вкладок"
   "Проверить, что у контрола {(контрол::tvList:push)} есть вертикальный скроллер"
  )
 )
;

PROCEDURE "Убедиться, что у флеша есть вертикальный скроллер"
 OBJECT VAR "Форма с флешем"
 "Контрол в фокусе" "Имя компонента" РАВНО 'Flash' 
  [ 'Фокус не во флеше, а в ' "Контрол в фокусе" "Имя компонента" ' : ' "Контрол в фокусе" pop:object:ClassName ' !' ] strings:Cat 
   ASSERTS
 "Контрол в фокусе" "Получить родительскую форму"  =: "Форма с флешем"
 "Проверить, что у контрола {("Форма с флешем")} есть вертикальный скроллер"
;

PROCEDURE "Сравнить с эталоном количество открытых выпадающих списков TnscSubTree"
 2 раза ( "Дождаться переключения вкладок" )
 INTEGER VAR Count_TnscSubTree
 "Узнать количество открытых выпадающих списков {('TnscSubTree')}" =: Count_TnscSubTree
 Если ( Count_TnscSubTree РАВНО 0 ) то 
  (  'Выпадающего списка нет!' . )
 иначе
  (
   Если ( Count_TnscSubTree РАВНО 1 ) то
    ( 'Выпадающий список виден!' . )
   иначе
    ( false  [ 'Похоже, что видим много выпадающих списков, а именно: ' Count_TnscSubTree IntToStr ' !' ] strings:Cat
     ASSERTS
    )
  )
;

PROCEDURE "Проверяем наличие выпадающего списка БП при вводе контекста" STRING IN aStr
  [ 'Контекст: '  aStr ' .' ] strings:Cat .
 "Очистить строку БП"
 CHAR VAR aContext_str
 INTEGER VAR i
 0 >>> i
 aStr string:Len раз ( 
  ''
  STRING VAR "Текущий контекст"
  i aStr string:[i] >>> aContext_str 
  aContext_str char:ToString Cat =: "Текущий контекст"
  "Ввести строку {("Текущий контекст")}" 
  "Сравнить с эталоном количество открытых выпадающих списков TnscSubTree"
  ++! i 
 ) 
 "Отделить текст в эталоне"
;

PROCEDURE "Ввести контекст и перебрать нажатием на стрелку вниз все доступные вырианты из выпадающего списка подсказок" STRING IN aStr
 "Очистить строку БП"
 "Ввести строку {(aStr)}"
 "Сравнить с эталоном количество открытых выпадающих списков TnscSubTree"
 20 раз ( "Нажать {('Down')}"
  "Дождаться переключения вкладок"
  "Заголовок текущего контрола" РАВНО aStr ?
   ( выходим )
  "Сравнить заголовок текущего контрола с эталоном" 
 )
;

PROCEDURE "Найти контекст в дереве оглавления" STRING IN aStr
 "##Запомнить положение фокуса" (
  "Перевести фокус в оглавление"
  "Развернуть текущее дерево"
  "Найти атрибут {(aStr)} в дереве {(контрол::ContentsTree)}"
 )
;

PROCEDURE "Ставим многострочный комментарий"
 "Ставим комментарий" 
 2 раза ( "Начинаем набирать {('наш_комментарий')}" 
  "Нажать Enter"
 )
;

PROCEDURE "Выделяем полностью комментарий"
 2 раза ( "Перейти на параграф вверх в редакторе {(контрол::Text:push)}" )
 "Дождаться переключения вкладок" 
 "Выделить {(2)} параграфов" 
;

PROCEDURE "Убедиться, что в структуре документа есть комментарий"
 "Выполнить {( @ ( "Перевести фокус в комментарии" ) )} и восстановить фокус"
;

WORDWORKER "Открыть документ и выполнить (##перед удалением перезаходим)" INTEGER IN aNumDoc 
 "##Выполнить сценарий ошибки и удалить в конце все комментарии у документа {(aNumDoc)}" ( 
  "Открываем {(aNumDoc)}" 
  ( WordToWork DO ) 
 )
;

PROCEDURE "Зажать кнопку Ctrl и кликнуть второй документ в списке"
 "Зажать кнопку {('Ctrl')} и выполнить" (
  "Установить курсор мыши по координатам {(200 200)} относительно контрола {(контрол::tvList:push)}" 
  "Клик левой кнопкой мыши"
 ) 
;

PROCEDURE "Вставить комментарий с картинкой"
 73 раз ( "Перейти на параграф вниз" ) 
 "Копировать"
 "Перейти на параграф вниз" 
 "Ставим комментарий"
 "Вставить" 
;

PROCEDURE "Сравнить параграфа с эталоном в формате RTF" INTEGER IN aCountPara
 "Выделить {(aCountPara)} параграфов"
 "Сравнить выделенный текст текущего редактора с эталоном в формате {(CF_RTF)}"
;

WordAlias "Сравнить параграфов с эталоном в формате RTF" "Сравнить параграфа с эталоном в формате RTF"
WordAlias "Сравнить параграф с эталоном в формате RTF" "Сравнить параграфа с эталоном в формате RTF"

PROCEDURE "Выбрать пункт контекстного меню 'Изменить имя и комментарий закладки' для иконки закладки"
 "##Запомнить позицию мыши и выполнить" ( 
 "Установить курсор мыши по координатам {( 25 10 )} относительно контрола {(контрол::SubPanel:push)}"
  THREAD ( 1500 SLEEP
  "Установить курсор мыши по координатам {( 35 65 )} относительно контрола {(контрол::SubPanel:push)}"
  "Клик левой кнопкой мыши"
  )
 "Клик правой кнопкой мыши" )
;

WORDWORKER "Установить закладку на документ и выполнить" 
 "Сохранить текущий объект в Мои документы и сделать" (
  ( WordToWork DO ) 
)
;

PROCEDURE "Сравнить с эталоном текст и иерархию текущего контрола в фокусе"
 "Проверить иерархию вложенности текущего контрола"
 "Сравнить выделенный текст текущего редактора с эталоном"
;

PROCEDURE "Проверить контрол 'Настройка конфигурации/Настройки интерфейса/Количество последних открытых документов' и увеличить на 1"
 "Восстановить все настройки текущей конфигурации"
 @ "Настройка конфигурации" MODAL (
 "Путь до контрола: {(1)} раз вниз, {(8)} раз Tab" 
  OBJECT VAR currentControl
  currentControl := "Контрол в фокусе"  
  "Убедиться, что текущий контрол {('TvtSpinEdit')}"
  "Проверить, активен ли контрол {(currentControl)}?"
  "Аккуратно сравнить с эталоном строковое значение свойства {('Hint')} объекта {(currentControl)}"
  'Значение по-умолчанию у спиннера равно ' currentControl pop:control:Caption ToPrintable Cat .
  "Ввести строку {('6')}" 
  "Кликаем Ок в Настройке конфигурации"
 )
;

PROCEDURE "Открыть 6 документов и проверить их наличие в последних открытых документах в ОМ"
 INTEGER VAR LastOpenDocCount 
 LastOpenDocCount  := 6
 INTEGER VAR aNumDoc
 aNumDoc := 2001
 LastOpenDocCount раз ( "Открываем {(aNumDoc)}" 
  ++! aNumDoc 
 )
 ОМ
 "Перевести фокус в последние открытые документы"
 "Контрол в фокусе" "Узнать количество элементов дерева" РАВНО LastOpenDocCount 
 'Количество последних открытых документов не совпало с настройками конфигурации!' ASSERTS
;

CONST Список_в_основном_окне 'efList'
CONST Основное_окно 'nsMainWindow'
CONST Список_в_СКР 'efList'
CONST Текст_документа 'TextForm'
CONST Текст_документа_после_открытия_из_списка 'TextForm_1'
CONST Залипшее_основное_окно 'nsMainWindow_1'

PROCEDURE "Убедиться, что линия с медалями объекта полностью видна" STRING IN aObject
 "Вывести окно оболочки на первый план"
 OBJECT VAR ReminderLineMainList
 "Найти линию медалей на форме {(aObject)}" =: ReminderLineMainList
 "Проверить, что линия с медалями {(ReminderLineMainList)} полностью видна" 
;

PROCEDURE "Убедиться, что линия с медалями в списке основного окна полностью видна" 
 "Убедиться, что линия с медалями объекта {(Список_в_основном_окне)} полностью видна"
;

PROCEDURE "Убедиться, что линия с медалями для основного окна полностью видна" 
 "Убедиться, что линия с медалями объекта {( Основное_окно)} полностью видна"
;

PROCEDURE "Убедиться, что линия медалей объекта полностью видна и сравнить с эталоном ее размеры" STRING IN aReminderLine
 "Дождаться переключения вкладок"
 OBJECT VAR ReminderLineMainList
 "Найти линию медалей на форме {(aReminderLine)}" =: ReminderLineMainList
 ReminderLineMainList pop:RemindersLine:Width .
 ReminderLineMainList pop:RemindersLine:Height . 
 "Убедиться, что линия с медалями в списке основного окна полностью видна" 
;

PROCEDURE "Сравнить с эталоном хинт для медали" STRING IN aName
 OBJECT VAR aReminder
 aName byname:control:push =: aReminder
 aReminder .
 'Показ отображения хинта (ShowHint): ' aReminder pop:Reminder:ShowHint ToPrintable Cat .
 "Сравнить с эталоном хинт медали {(aName)}"
 "##Отделить текст в эталоне"
;

PROCEDURE "На форме сравнить с эталоном дельту отступа для медали и баллона" STRING IN aForm STRING IN aReminder
 INTEGER VAR t_medal
 INTEGER VAR t_ballon
 OBJECT VAR ReminderLine
 "Найти линию медалей на форме {( aForm )}" =: ReminderLine
 'Видимость линии медалей: ' ReminderLine pop:RemindersLine:Visible ToPrintable Cat .
 ReminderLine pop:RemindersLine:AbsTop =: t_medal
 OBJECT VAR l_Rem
 OBJECT VAR l_Balloon
 aReminder byname:control:push =: l_Rem
 'Видимость медали: ' l_Rem pop:Reminder:Visible ToPrintable Cat .
 l_Balloon := ( l_Rem pop:Reminder:PopupForm )
 'Видимость баллона: ' l_Balloon pop:control:Visible ToPrintable Cat .
 l_Balloon pop:control:GetTop =: t_ballon
 'Дельта: ' t_medal t_ballon  - ToPrintable Cat .
;

PROCEDURE "Кликнуть левой кнопкой мыши кнопку DropButton для раскрытия подсказки в БП"
 "Вывести окно оболочки на первый план"
 "##Запомнить позицию мыши и выполнить" (
  INTEGER VAR X
  INTEGER VAR Y
  "Контрол в фокусе" "Померить ширину" 5 + =: X
  5 =: Y
  "Установить курсор мыши по координатам {(X Y)} относительно контрола {("Контрол в фокусе")}"
  "Клик левой кнопкой мыши" 
 )
;

PROCEDURE "Создать закладку на текущий документ ААК и сравнить с эталоном количество видимых значков на саб-панели"
 "Сохранить текущий объект в Мои документы и сделать" (
  "Поставить фокус в левую половину ААК"
  OBJECT VAR aParentForm
  "Контрол в фокусе" "Получить родительскую форму" =: aParentForm
  "Узнать количество видимых значков на саб-панели формы {(aParentForm)}" .
 )
;

WORDWORKER "##Отодвинуть медали основного окна и выполнить"
 "Переместить медаль {("Красная медаль с восклицательным знаком")} по координатам {( 500 500)} и выполнить {( @ ( WordToWork DO )  )}"
;

PROCEDURE "Открыть вкладку 'Меню', сделать ее плавающей и проверить, что ее высота находится в допустимых пределах (642-670 пикселей)"
/* PROCEDURE Действия
  OBJECT VAR "Форма вкладки"
  "Контрол в фокусе" 2 раза "Получить родительскую форму" =: "Форма вкладки"
  Если ( "Форма вкладки" "Померить высоту" "в интервале" ( 642 670 ) ) то 
   ( 'Высота отдоченной вкладки находится в допустимых пределах.' . )
  иначе
   ( 'Высота отдоченной вкладки вышла за допустимые пределы:' .
    "Форма вкладки" "Померить высоту" . )
 ;
 "Выполнить {(@ Действия )} с плавающей меню во вкладке и закрыть её"
 Этот вариант перестал подходить из-за "запоминания" размеров вкладки при уменьшении окна (вкладка соответствует размерам для ПЕРВОНАЧАЛЬНОГО размера окна)
 Костыль. Теперь отдочиваем ВРУЧНУЮ
*/
 "##Отодвинуть медали основного окна и выполнить" (
  "Меню во вкладке"
  "Дождаться переключения вкладок"
  "Установить курсор мыши по координатам {(50 -80)} относительно контрола {("Контрол в фокусе")}"
  THREAD ( 800 SLEEP 
   "Установить курсор мыши по координатам {(400 100)} относительно контрола {("Главное окно")}"
   "Отпустить левую кнопку мыши"
  )
  "Зажать левую кнопку мыши"
  2500 SLEEP 
  "Дождаться переключения вкладок"
  "Установить фокус в меню во вкладке" 
  OBJECT VAR "Форма вкладки"
  "Контрол в фокусе" 2 раза ( "Получить родительскую форму" ) =: "Форма вкладки"
  Если ( "Форма вкладки" "Померить высоту" "в интервале" ( 642 670 ) ) то 
   ( 'Высота отдоченной вкладки находится в допустимых пределах.' . )
  иначе
   ( 'Высота отдоченной вкладки вышла за допустимые пределы:' .
   "Форма вкладки" "Померить высоту" . )
  )
;

PROCEDURE "Кликнуть левой кнопкой мыши, нажать 'Home' и установить курсор мыши в область вкладок"
 OBJECT VAR District_tab
 "Найти область вкладок" =: District_tab
 "Клик левой кнопкой мыши"
 "Нажать {('Home')}"
 "##Дать тесту время для отрисовки контролов"
 "Установить курсор мыши по координатам {(5 5)} относительно контрола {(District_tab)}"
;  

PROCEDURE "Сравнить содержимое баллона зеленой медали МВ с эталоном"
 "Нажать на зелёную медаль МВ и проверить наличие баллона"
 "Дождаться переключения вкладок"
 "Установить фокус в баллон зелёной медали МВ"
 "Выделить всё"
 "Сравнить выделенный текст текущего редактора с эталоном"
;

PROCEDURE "Сравнить содержимое баллона зеленой медали МВ в списке с эталоном"
 "Нажать на зелёную медаль МВ в списке и проверить наличие баллона"
 "Установить фокус в баллон зелёной медали МВ в списке"
 "Выделить всё"
 "Сравнить выделенный текст текущего редактора с эталоном"
;

WORDWORKER "Открыть вкладку 'Конфигурации', отредактировать основную и расширенную конфигурации: Поведение системы -> Панель задач (Слева) и выполнить"
 TRY
  "Открыть вкладку 'Список конфигураций' и выполнить" (
   2 раза (
    PROCEDURE Действия_с_контролом OBJECT IN aCtrl
     ( aCtrl ЯВЛЯЕТСЯ class::TvtCheckBox ) 
     И ( aCtrl "Заголовок контрола" РАВНО 'Панель задач' ) ? (
      aCtrl "Установить фокус"
      "Дождаться переключения вкладок"
      "Поставить галочку в чекбоксе" 
     )
    ;
    @ оп::Контекстное_меню_конфигурации_Редактировать MODAL ( 
     "Путь до контрола: {(2)} раз вниз, {(2)} раз Tab"
     OBJECT VAR "GroupBox"
     "Контрол в фокусе" "Перейти к родительской форме" >>> "GroupBox"
     "Выполнить для всех контролов {("GroupBox")}" Действия_с_контролом 
     "Кликаем Ок в Настройке конфигурации"
    )
   "Стрелка вниз"
   )
  )
  ( WordToWork DO )
 FINALLY
  "Открыть вкладку 'Список конфигураций' и выполнить" (
   2 раза (
    "Ответить один раз Да для {(@ "Восстановить все настройки на вкладке Конфигурации" )}"
    "Стрелка вниз"
   )
  )
  "Дождаться переключения вкладок"
  OBJECT VAR "Кнопка 'Панель задач'"
  "Найти контрол {(контрол::bt_mo_Common_opTasksPanel)} на форме {("Главное окно")}" =: "Кнопка 'Панель задач'"
  ( "Узнать численную переменную {('Down')} объекта {("Кнопка 'Панель задач'")}" РАВНО 0 ! ) ? ( "Кнопка 'Панель задач'" "Кликнуть" ) 
 END
;

PROCEDURE "Сравнить следующие ссылки с эталоном"  INTEGER IN aC
 "Перевести фокус в текст"
 aC раза ( "Перейти к следующей ссылке"
  "Сравнить выделенный текст текущего редактора с эталоном" )
;

VOID WORDWORKER "##Запомнить ширину левого навигатора и выполнить"
 "Запомнить ширину левого навигатора и выполнить {(@ ( WordToWork DO ) )}"
;

PROCEDURE "Сравнить с эталоном состояние видимости верхнего края редактора текущего контрола"
 "##Дать тесту время для отрисовки контролов"
 'Верхний край редактора виден: ' "Контрол в фокусе" pop:editor:AtTop ToPrintable Cat .
;

PROCEDURE "Сравнить с эталоном состояние видимости нижнего края редактора текущего контрола"
 "##Дать тесту время для отрисовки контролов"
 'Нижний край редактора виден: ' "Контрол в фокусе" pop:editor:DocumentTailVisible ToPrintable Cat .
;

PROCEDURE "Выделяем текст в баллоне медали и, не отпуская левую кнопку мыши, переводим курсор мыши вниз"
 "##Запомнить позицию мыши и выполнить" (
  "Ставим указатель мыши на конец текущего параграфа редактора {("Контрол в фокусе")} со смещением {( -20 -20 )}"
  INTEGER VAR X
  INTEGER VAR Y
  "Запомнить позицию мыши" =: Y =: X
  THREAD ( 300 SLEEP 
   Y 30 + =: Y
   X Y "Восстановить позицию мыши"
   100 SLEEP
   "Отпустить левую кнопку мыши"
  )
  "Зажать левую кнопку мыши"
 )
;

PROCEDURE "Кликнуть левой кнопкой мыши над кнопкой раскрытия выпадающего списка с историей запросов и сравнить с эталоном количество выпадающих списков TevDropTree"
 "Не сохранять состояние редактора"
 "##Для проверки сценария ошибки выполнить (широкое окно)" (
  "##Подготовить главное окно к тесту"
   INTEGER VAR x
  INTEGER VAR y
  OBJECT VAR "Заголовок КЗ"
  "Найти контрол {(контрол::pnHeader )} на форме {("Главное окно")}" >>> "Заголовок КЗ"
  "Заголовок КЗ" "Померить ширину"  >>> x
  x 210 - >>> x
  65  >>> y
  "Установить курсор мыши по координатам {(x y)} относительно контрола {("Заголовок КЗ")}"
  "Дождаться переключения вкладок"
  "Клик левой кнопкой мыши"
  "Узнать количество открытых выпадающих списков TevDropTree" .
  "Нажать Esc"
 )
;

VOID WORDWORKER "Открыть диалог переписки с верхним пользователем и выполнить"
 "Открыть вкладку 'Совещание онлайн' и выполнить"  (
  "Выбрать первого пользователя, открыть диалог и выполнить {(@ ( WordToWork DO ) )}"
 )
;

PROCEDURE "Дождаться появления хинта и сравнить его текст с эталоном"
 "Дождаться появления хинта"
 "Сравнить текст хинта с эталоном"
;

PROCEDURE "Если попали в комбобокс 'Ссылки на документ' - выставить значение 'Не показывать'"
 "Заголовок текущего контрола" РАВНО 'Ссылки на документ' ?  (
  "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Не показывать')}" ) 
;

PROCEDURE "Восстанавливаем настройки и возвращаемся в нужное место"
 "Ответить один раз Да для {(@ "Нажать кнопку Восстановить все в Настройке конфигурации" )}"
 "Нажать {('Tab')}" // восстанавливаем фокус
 "Путь до контрола: {(5)} раз вниз, {(10)} раз Tab"
;

PROCEDURE "Сделать эталон-скриншот контрола , отступив от левого верхнего угла и от правого нижнего угла" OBJECT IN aCtrl INTEGER IN aXLeft INTEGER IN aYLeft INTEGER IN aXRight INTEGER IN aYRight
 OBJECT  VAR Check_Control
 aCtrl =: Check_Control
 INTEGER VAR l_Handle
 Check_Control pop:control:GetHandle >>> l_Handle
 INTEGER VAR X1
 INTEGER VAR Y1
 INTEGER VAR X2
 INTEGER VAR Y2
 X1 := 0
 Y1 := 0
 X1 aXLeft + =: X1
 Y1 aYLeft + =: Y1
  Check_Control "Померить ширину" =: X2
 Check_Control "Померить высоту" =: Y2
 X2 aXRight - =: X2
 Y2 aYRight - =: Y2
 STRING VAR l_FileName
 script:FileName '.bmp' sysutils:ChangeFileExt
 sysutils:ExtractFileName >>> l_FileName		
 l_FileName Y2 X2 Y1 X1 l_Handle ScreenShot2FileWithCheck
;

PROCEDURE "Сделать эталон-скриншот контрола , отступив от начальной точки и задав измеряемую область в " OBJECT IN aCtrl INTEGER IN aX0 INTEGER IN aY0 INTEGER IN aX1 INTEGER IN aY1
 OBJECT  VAR Check_Control
 aCtrl =: Check_Control
 INTEGER VAR l_Handle
 Check_Control pop:control:GetHandle >>> l_Handle
 INTEGER VAR X1
 INTEGER VAR Y1
 INTEGER VAR X2
 INTEGER VAR Y2
 X1 := 0
 Y1 := 0
 X1 aX0 + =: X1
 Y1 aY0 + =: Y1
 X1 aX1 + =: X2
 Y1 aY1 + =: Y2
 STRING VAR l_FileName
 script:FileName '.bmp' sysutils:ChangeFileExt
 sysutils:ExtractFileName >>> l_FileName		
 l_FileName Y2 X2 Y1 X1 l_Handle ScreenShot2FileWithCheck
;

PROCEDURE "Сделать эталон-скриншот контрола , отступив от правого нижнего угла" OBJECT IN aCtrl INTEGER IN aX INTEGER IN aY
 "Сделать эталон-скриншот контрола {(aCtrl)}, отступив от левого верхнего угла {(0 0)} и от правого нижнего угла {(aX aY)}"
;

PROCEDURE "Сделать эталон-скриншот контрола" OBJECT IN aCtrl
 "Сделать эталон-скриншот контрола {(aCtrl)}, отступив от правого нижнего угла {(0 0)}"
;

PROCEDURE "Сделать эталон-скриншот части контрола , от левого верхнего угла до координат " OBJECT IN aCtrl INTEGER IN aX INTEGER IN aY
 "Сделать эталон-скриншот контрола {(aCtrl)}, отступив от начальной точки {(0 0)} и задав измеряемую область в {(aX aY)}"
;

PROCEDURE "Сделать эталон-скриншот части контрола , отступив от левого верхнего угла  на и до координат " OBJECT IN aCtrl INTEGER IN aX0 INTEGER IN aY0 INTEGER IN aX1 INTEGER IN aY1
 "Сделать эталон-скриншот контрола {(aCtrl)}, отступив от начальной точки {(aX0 aY0)} и задав измеряемую область в {(aX1 aY1)}"
;

PROCEDURE "Сделать эталон-скриншот типов информации на вкладке БП" 
 "##Дать тесту время для отрисовки контролов"
 OBJECT VAR "Вкладка БП"
 "Найти контрол {(форма::NewBaseSearch )} на форме {("Главное окно")}" >>> "Вкладка БП"
 "Сделать эталон-скриншот контрола {("Вкладка БП")}, отступив от начальной точки {(0 0)} и задав измеряемую область в {(1060 38)}"
;

PROCEDURE "Сделать эталон-скриншот левой части редактора"
 "Дать системе перерисоваться"
 INTEGER VAR aWText
 контрол::Text:push "Померить ширину" =: aWText
 aWText 75 - =: aWText
 "Сделать эталон-скриншот контрола {(контрол::Text:push)}, отступив от левого верхнего угла {(0 110)} и от правого нижнего угла {(aWText 200)}"
;

PROCEDURE "Выделить ячейку с картинкой в правой части ААК-Содержания"
 "Закрыть форму БП"
 "Поставить фокус в правую половину ААК-Содержания"
 13 раз ( "Стрелка вниз" )
 5 раз ( "Перейти на параграф вверх" ) 
 "Дать системе перерисоваться"
 "Выделить вторую ячейку первой строки в текущей таблице"
;

PROCEDURE "Сделать эталон-скриншот комбобокса и панели контексного поиска"
 "##Дать тесту время для отрисовки контролов"
 OBJECT VAR "Список фирм"
 "Контрол в фокусе" "Получить родительскую форму" =: "Список фирм"
 OBJECT VAR "Комбобокс"
 "Найти контрол {(контрол::bt_enMedicFirmList_opCountryFilter)} по имени на форме {("Список фирм")}" =: "Комбобокс"
 "Сделать эталон-скриншот контрола {("Комбобокс")}, отступив от правого нижнего угла {(-74 -35)}"
;

PROCEDURE "##Подготовить БП к тесту (очистить введенный контекст и историю запросов)"
 ClearDocumentContextSearchHistory
 "Очистить строку БП"
;

PROCEDURE "Последовательно переключаться между редакциями НК, чтобы заполнить историю навигации только редакциями"
 11 раз ( "Стрелка вниз" )
;

PROCEDURE "Нажимать кнопку 'Назад', пока не закончится история"
 vcm:History:GetBackCount раз ( "Назад по истории без перерисовки" )
;

PROCEDURE "Сравнить с эталоном хинт закладки на саб-панели"
 "Установить курсор мыши по координатам {( 25 10 )} относительно контрола {(контрол::SubPanel:push)}"
 "Дождаться появления хинта и сравнить его текст с эталоном"
;

PROCEDURE "Выставить в 'Настройке конфигурации/Документ/Показывать историю изменений в документе' значение 'В развернутом виде'"
 "Открыть диалог Настройка конфигурации и выполнить" (
  "Путь до контрола: {(5)} раз вниз, {(7)} раз Tab"
  "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('В развернутом виде')}"
  "Кликаем Ок в Настройке конфигурации"
 )
;

PROCEDURE "Выделить 2 параграфа и сравнить выделенный текст с эталоном"
 2 раза ( "Перейти на параграф вниз" )
 "Переместиться в начало строки"
 cc:ExtFirstPage
 "Сравнить выделенный текст текущего редактора с эталоном"
;

VOID WORDWORKER "##Запомнить главное окно Гаранта и выполнить"
 VAR l_Main
 "Сохранить активное окно" >>> l_Main
 TRY
  ( WordToWork DO )
 FINALLY
  l_Main "Восстановить активное окно"
  2 раза ( "Дождаться переключения вкладок" )
  "Закрыть все окна кроме текущего"
 END
;

VOID WORDWORKER "Убедиться, что после следующих действий новое окно не открылось"
 "##Запомнить главное окно Гаранта и выполнить" (
  INTEGER VAR aHandle
  aHandle := "Сохранить активное окно" 
  ( WordToWork DO )  
  "Дождаться переключения вкладок"
  "Сохранить активное окно" РАВНО aHandle 'Открылось новое окно, хотя не должно!' ASSERTS 
 )
;

VOID WORDWORKER "Убедиться, что после следующих действий новое окно  открылось"
 "##Запомнить главное окно Гаранта и выполнить" (
  INTEGER VAR aHandle
  aHandle := "Сохранить активное окно" 
  ( WordToWork DO )  
  "Дождаться переключения вкладок"
  "Сохранить активное окно" НЕРАВНО aHandle 'Новое окно не открылось, хотя должно!' ASSERTS 
 )
;

PROCEDURE "Выставить в 'Настройке конфигурации/Документ/По ссылке в инф. об изм. в тексте документа открывать' значение 'Текст редакции'"
 "Открыть диалог Настройка конфигурации и выполнить" (
  "Путь до контрола: {(5)} раз вниз, {(6)} раз Tab"
  "Выбрать в комбобоксе {("Контрол в фокусе")} значение {('Текст редакции')}"
  "Кликаем Ок в Настройке конфигурации"
 )
;

PROCEDURE "##Убедиться, что в списке несколько документов"
 STRING VAR aNameFirstDoc
 aNameFirstDoc := "Заголовок текущего контрола"
 "Стрелка вниз"
 "Заголовок текущего контрола" НЕРАВНО aNameFirstDoc 'В списке мало документов!' ASSERTS 
 "Стрелка вверх"
;

PROCEDURE "Попереключаться между вкладками 'Комментарии' и 'Судебная практика' в синхронном просмотре списка"
 5 раз ( "Открываем вкладку 'Комментарии' в синхронном просмотре списка"
 "Открываем вкладку 'Судебная практика' в синхронном просмотре списка" )
;

PROCEDURE "Сравнить с эталоном родительскую форму для контрола в фокусе"
 "Дождаться переключения вкладок"
 "Контрол в фокусе" "Получить родительскую форму" .
;

PROCEDURE "Сравнить с эталоном имя текущего элемента вкладки Меню"
 "Получить имя текущего элемента дерева {(контрол::NavigatorTree)}"
; 



CONST "ГК РФ" 'Гражданский кодекс Российской Федерации (части первая, вторая и третья) (с изм. и доп. от 20 февраля, 12 августа 1996 г., 24 октября 1997 г., 8 июля, 17 декабря 1999 г., 16 апреля, 15 мая, 26 ноября 2001 г., 21 марта, 14, 26 ноября 2002 г., 10 января, 26 марта, 11 ноября, 23 декабря 2003 г.)'

PROCEDURE "Удалить все документы списка, кроме ГК РФ и сравнить с эталоном его вхождения"
 "Свернуть текущее дерево"
 "Контрол в фокусе" tree:GetItemsCount раз (
  "Дождаться переключения вкладок"
  Если ( "Заголовок текущего контрола" РАВНО "ГК РФ" ) то
   ( "Стрелка вниз" )
  иначе
   ( "Удалить элемент, подтвердив в диалоге удаление" )
 )
 "Сравнить развёрнутый список {(контрол::tvList)} с эталоном"
;

VOID WORDWORKER "Открыть сохранённый список из Моих документов и выполнить"
 "Открыть сохраненный объект из Моих документов и выполнить {(@ ( WordToWork DO ) )}"
;

PROCEDURE "Вычесть сохраненный список и сравнить с эталоном получившийся список" STRING IN aNameList
 @ ( оп::Список_Вычесть_список... ) MODAL (
  "Найти ссылку {(aNameList)} в дереве {(контрол::FoldersTree)} и перейти по ней"
  // Тут получаем Предупреждение, что получается пустой список (по-этому вычетания не случится). Обрабатывать такое пока не умеем
 )
 "Дождаться переключения вкладок"
 "##Отделить текст в эталоне"
 'Финальный список: ' .
 "Сравнить развёрнутый список {(контрол::tvList)} с эталоном"
;

PROCEDURE "Во вкладке Мои документы не должно остаться сохраненных объектов"
 PROCEDURE Действия
  2 раза ( "Дождаться переключения вкладок" ) 
  0 "Контрол в фокусе" tree:ChildrenCount раз ( 
   "Переместиться в начало дерева"
   "Развернуть текущее дерево"
   "Стрелка вниз"
   "Удалить объект и подтвердить удаление"
  )
 ;

 IsMyDocumentsEmpty ! ? (
  "Открыть мои документы и выполнить {(@ Действия)}"
  )
 IsMyDocumentsEmpty 'Не смогли почистить вкладку Мои документы!' ASSERTS 
;


VOID WORDWORKER "##Удалить после теста все лишнее из Моих документов"
 TRY
  ( WordToWork DO )
 FINALLY
  "Во вкладке Мои документы не должно остаться сохраненных объектов"
 END
;

WORDWORKER "Убедиться, что появился диалог с кнопкой 'Ок' после следующих действий"
 "{(@  ( WordToWork DO ) )} и проверить наличие диалога с кнопкой Ок"
;

PROCEDURE "Сравнить с эталоном содержимое статусбара главного окна"
 'Содержимое статусбара главного окна: ' . 
 "##Дать тесту время для отрисовки контролов"
 "Сравнить статусбар окна {("Главное окно")} с эталоном"
;

PROCEDURE "Открыть диалог 'Регистрационные данные', установить фокус в поле 'Подтверждение пароля' и переместить окно на контрол hfTaxes"
 OBJECT VAR aObjectForScreenshot
 "Найти контрол {(контрол::hfTaxes)} на форме {("Главное окно")}" =: aObjectForScreenshot 
 @ ( "Изменить мои регистрационные данные" ) MODAL ( 
  "Найти контрол {('edConfirm')} на форме {("Диалог Регистрационные данные")}" "Установить фокус"
  INTEGER VAR X
  INTEGER VAR Y
  "Контрол в фокусе" "Координаты курсора относительно левого верхнего угла монитора" >>> Y >>> X
  Y 75 - =: Y
  "Установить курсор мыши по координатам {(X Y)}"
  THREAD ( 400 SLEEP 
   Если ( "Система x64?" ) то
    ( "Установить курсор мыши по координатам {( -70 0 )} относительно контрола {(aObjectForScreenshot )}" )
   иначе
    ( "Установить курсор мыши по координатам {( -120 0 )} относительно контрола {(aObjectForScreenshot )}" )
   "Отпустить левую кнопку мыши"
  )
 "Зажать левую кнопку мыши"
 600 SLEEP
 // "Ввести {('1')}"
 )
;

PROCEDURE "Сделать эталон-скриншот для контрола hfTaxes"
 OBJECT VAR aObjectForScreenshot
 "Найти контрол {(контрол::hfTaxes)} на форме {("Главное окно")}" =: aObjectForScreenshot 
 "Сделать эталон-скриншот части контрола {(aObjectForScreenshot)}, от левого верхнего угла до координат {(540 162)}"
;

PROCEDURE "Сравнить с эталоном текущие свойства для чекбокса 'Масштабируемый' в Редакторе стилей и снять с него галочку"
 "Выполнить с редактором стилей" (
  PROCEDURE Ищем_чекбокс_Масштабируемый_и_снимаем_галочку OBJECT IN aCtrl
   ( aCtrl РАВНО 'FontScalableCheckBox : TvtCheckBox' ) ? (
    "Установить фокус в {(aCtrl)}"
    "Дождаться переключения вкладок"
    "Сравнить с эталоном имя текущего контрола"   
    OBJECT VAR l_CheckBox
    "Контрол в фокусе" >>> l_CheckBox
    'Галочка в чекбоксе: ' "Получить состояние чекбокса {(l_CheckBox)}" ToPrintable Cat .
    'Активность:' l_CheckBox "Убедиться, что контрол активен" ToPrintable Cat .
    "Аккуратно сравнить с эталоном строковое значение свойства {('Hint')} объекта {(l_CheckBox)}"
    "Снять галочку в чекбоксе"
    "Закончить перебор контролов"
   ) 
  ;
  "Выполнить для всех контролов {( "Диалог редактора стилей" )}" Ищем_чекбокс_Масштабируемый_и_снимаем_галочку
  "Нажать Enter"
 )
;

PROCEDURE "Установить курсор мыши относительно текстового курсора текущего редактора со смещением и сравнить с эталоном элементы редактора, которые перерисовались" INTEGER IN DeltaX INTEGER IN DeltaY
 OBJECT VAR Editor
 контрол::Text:push =: Editor
 Editor pop:control:Repaint
 INTEGER VAR x
 INTEGER VAR y
 Editor pop:editor:CursorCoordsToScreen >>> y >>> x
 y DeltaY + >>> y
 x DeltaX + >>> x
 "##Дать тесту время для отрисовки контролов"
 Editor pop:editor:CheckWithEtalon ( "Установить курсор мыши по координатам {(x y)}" 50 SLEEP )
;

PROCEDURE "Изменить в редакторе стилей название шрифта на и его размер на для стиля" STRING IN aNameFont INTEGER IN aStyleFontSize STRING IN aStyleName 
 PROCEDURE Изменяем_параметры_редактора_стилей
  "Установить фокус в Дерево стилей"
  "Найти ссылку {(aStyleName)} в дереве {(контрол::StyleTreeView)} и перейти по ней"
  "Установить фокус в комбобокс выбора названия шрифта"
  "Сразу выбрать в текущем комбобоксе значение {(aNameFont)}" 
  "Установить фокус в комбобокс выбора размера шрифта в измененном Редакторе стилей"
  STRING VAR aStyleFontSizeStr
  aStyleFontSize IntToStr =: aStyleFontSizeStr 
  "Сразу выбрать в текущем комбобоксе значение {(aStyleFontSizeStr )}"
  "Нажать Enter"
 ;
  
 "Выполнить с редактором стилей" ( Изменяем_параметры_редактора_стилей )
 "Дать системе перерисоваться"
;

VOID WORDWORKER "Убедиться, что после выполнения указанных действий ширина ячейки таблицы не изменилась"
 "Убедиться, что фокус в таблице"
 INTEGER VAR aFirstCoordY
 "Контрол в фокусе" "Координаты курсора относительно левого верхнего угла монитора" DROP =: aFirstCoordY
 ( WordToWork DO ) 
 INTEGER VAR aModifiedCoordY
 "Контрол в фокусе" "Координаты курсора относительно левого верхнего угла монитора" DROP =: aModifiedCoordY
 ( aModifiedCoordY aFirstCoordY - ) МЕНЬШЕ 300 'Ячейка, после удаления коментария, не вернулась к своим первоначальным размерам!' ASSERTS 
;

PROCEDURE "Вставить в комментарий таблицу"
 "Вставить таблицу"
 2 раза ( cc:Up )
 "##Дать тесту время для отрисовки контролов"
 ( cc:Up )
 // "Убедиться, что фокус в таблице"
 // уводим курсор из комментария, в случае удаления комментария оказываемся в другой ячейке
;

PROCEDURE "Удалить единичный комментарий из оглавления"
 "Перевести фокус в комментарии"
 "Нажать Del"
 "Проверить, что нельзя перевести фокус в комментарии"
 "Перевести фокус в текст"
;

WORDWORKER "Игнорировать любую ошибку после действий"
 TRY
  WordToWork DO
 EXCEPT
  // гасим любое исключение
 END
 "Дождаться переключения вкладок"
;

PROCEDURE "Сравнить с эталоном контекстное меню выделенной ссылки"
 VAR Editor
 "Выделить слово слева"
 "Контрол в фокусе" >>> Editor
 "Установить в редакторе {(Editor)} указатель мыши на точку {(0 10)} для вызова КМ"
 "Сравнить контекстное меню для точки с эталоном"
;

PROCEDURE "Открыть вкладку в текущем окне и сравнить с эталоном иерархию вложенности текущего контрола после перехода"
 "Открыть вкладку на всё окно"
 "##Дать тесту время для отрисовки контролов"
 "Проверить иерархию вложенности текущего контрола"
;

PROCEDURE "Открыть НК по 'прямой' ссылке из БП"
 "Ввести строку {('НК')}"
 "Дождаться переключения вкладок"
 "Нажать {('Down')}"
 "Нажать Enter"
 "Убедиться, что фокус в редакторе"
;

WORDWORKER  "Построить список корреспондентов к фрагменту текста через вкладку ПЗ и выполнить"
 ПЗ
 THREAD ( 600 SLEEP
  THREAD ( 1700 SLEEP
   "Установить курсор мыши по координатам {(200 132)} относительно контрола {("Левый навигатор")}"
   "Клик левой кнопкой мыши"
   "##Дать тесту время для отрисовки контролов"
   (  WordToWork DO )
  )
  "Установить курсор мыши по координатам {(100 132)} относительно контрола {("Левый навигатор")}"
  "##Дать тесту время для отрисовки контролов"
 )
 "Установить курсор мыши по координатам {(100 85)} относительно контрола {("Левый навигатор")}"
 "Клик левой кнопкой мыши"
 "##Дать тесту время для отрисовки контролов"
;

PROCEDURE "Открыть рубрикатор из ОМ" STRING IN aNameLink
 "Перевести фокус в {(контрол::tvReferences)} на форме {(форма::MainMenuNew)}"
 "Найти ссылку {(aNameLink)} в дереве {(контрол::tvReferences)} и перейти по ней"
;

PROCEDURE "Отделить фигурной чертой текст в эталоне"
 '~~~~~~~~~~~~~~~~' .
;

PROCEDURE "Кликнуть кнопку 'Онлайн-ресурсы' в ОМ"
 OBJECT VAR "Кнопка Онлайн-ресурсы"
 контрол::pbCourtsOnline:push =: "Кнопка Онлайн-ресурсы"
 "Проверить, что контрол {("Кнопка Онлайн-ресурсы")} видимый"
 "Кнопка Онлайн-ресурсы" pop:object:IsNil ! 'Контрол не найден' ASSERTS
 "Кнопка Онлайн-ресурсы" "Кликнуть"
 3 раза ( "Дождаться переключения вкладок" )
;

PROCEDURE "Выбрать следующую новостную ленту"
 STRING VAR aFirstCaptionNewsLine
 "Заголовок текущего контрола" =: aFirstCaptionNewsLine
 "Стрелка вниз"
 "Заголовок текущего контрола" НЕРАВНО aFirstCaptionNewsLine 'Переход к новой новостной ленте не произошёл!' ASSERTS
 "##Дать тесту время для отрисовки контролов"
;

PROCEDURE "Проверить активность кнопок 'Сравнение редакций' и 'Построить обзор изменений' в Левом навигаторе"
 "Проверить активность кнопки {(контрол::bt_enEditions_opDoCompareEditions)} на форме {("Левый навигатор")}"
 "Проверить активность кнопки {(контрол::bt_enEditions_opBuildChangedFragments)} на форме {("Левый навигатор")}"
;

PROCEDURE "Сравнить с эталоном наличие галочки для всех редакций"
 INTEGER VAR l_Iteration
 l_Iteration := 0
 "Контрол в фокусе" tree:GetItemsCount раз (
  INTEGER VAR l_ImageIndex 
  BOOLEAN VAR l_Checked
  l_Iteration "Узнать индекс иконки в дереве {("Контрол в фокусе")}" >>> l_ImageIndex
  Если ( ( l_ImageIndex РАВНО 11 ) ИЛИ ( l_ImageIndex РАВНО 13 ) ИЛИ ( l_ImageIndex РАВНО 15 ) ) то
   ( [ 'Галочка у редакции ' l_Iteration IntToStr ' ЕСТЬ!' ] strings:Cat . )
  иначе
   ( [ 'Галочки у редакции ' l_Iteration IntToStr ' НЕТ!' ] strings:Cat . ) 
  ++! l_Iteration
 )
;

PROCEDURE "Сравнить с эталоном номер текущего документа"
 "##Запомнить положение фокуса" (
  "Перевести фокус в документ"
  'Номер открытого документа: ' DocumentText textform:GetDocumentID ToPrintable Cat .
 )
;

PROCEDURE "Кликнуть левой кнопкой мыши на текст верхней редакции"
 "##Дать тесту время для отрисовки контролов"
 "Установить курсор мыши по координатам {(70 100)} относительно контрола {("Левый навигатор")}"
 "Клик левой кнопкой мыши"
;

PROCEDURE "Кликнуть левой кнопкой мыши на комбобокс верхней редакции"
 "##Дать тесту время для отрисовки контролов"
 "Установить курсор мыши по координатам {(30 100)} относительно контрола {("Левый навигатор")}"
 "Клик левой кнопкой мыши"
;

WORDWORKER "Вызвать Список редакций из статусной строки и выполнить"
 "Вызвать Список редакций из статусной строки и сделать {( @  ( WordToWork DO ) )}"
;

PROCEDURE "Изменить значения всех комбобоксов и чекбоксов в Настройках конфигурации - Поведение системы - Вкладки"
 PROCEDURE Действия_с_контролом OBJECT IN aCtrl
  ( aCtrl ЯВЛЯЕТСЯ class::TvtCheckBox ) ? (
   aCtrl "Установить фокус"
   "Поставить галочку в чекбоксе" 
   "Заголовок контрола {(aCtrl)}" .
   'Галочка в чекбоксе: ' "Получить состояние чекбокса {(aCtrl)}" ToPrintable Cat .
  )
  aCtrl ЯВЛЯЕТСЯ class::TvtComboBoxQS ? (
   aCtrl "Установить фокус"
   "Выбрать следующее значение в комбобоксе {("Контрол в фокусе")}"
   'Значение в комбобоксе: ' "Заголовок контрола {(aCtrl)}" ToPrintable Cat .
  )
 ;
 @ "Настройка конфигурации" MODAL (  
  "Путь до контрола: {(2)} раз вниз, {(2)} раз Tab"
  OBJECT VAR "GroupBox"
  "Контрол в фокусе" "Перейти к родительской форме" >>> "GroupBox"
  "Выполнить для всех контролов {("GroupBox")}" Действия_с_контролом 
  "Кликаем Ок в Настройке конфигурации"
 )
;

PROCEDURE "Сравнить с эталоном значения всех комбобоксов и чекбоксов в Настройках конфигурации - Поведение системы - Вкладки"
 PROCEDURE Действия_с_контролом_после_восстановленя OBJECT IN aCtrl
  ( aCtrl ЯВЛЯЕТСЯ class::TvtCheckBox ) ? (
   "Заголовок контрола {(aCtrl)}" .
   'Галочка в чекбоксе: ' "Получить состояние чекбокса {(aCtrl)}" ToPrintable Cat .
  )
  aCtrl ЯВЛЯЕТСЯ class::TvtComboBoxQS ? (
   'Значение в комбобоксе: ' "Заголовок контрола {(aCtrl)}" ToPrintable Cat .
  )
 ;

 @ "Настройка конфигурации" MODAL (  
  "Путь до контрола: {(2)} раз вниз, {(2)} раз Tab"
  OBJECT VAR "GroupBox"
  "Контрол в фокусе" "Перейти к родительской форме" >>> "GroupBox"
  "Выполнить для всех контролов {("GroupBox")}" Действия_с_контролом_после_восстановленя 
  "Кликаем Ок в Настройке конфигурации"
 )
;

PROCEDURE "Заполнить обязательные поля ППО"
 OBJECT VAR l_QC
 "Убедиться, что фокус в редакторе"
 focused:control:push >>> l_QC
 'AT_USER_NAME' '1234' l_QC pop:QueryCard:SetAttribute
 'AT_USER_PHONE' '1234' l_QC pop:QueryCard:SetAttribute
 'AT_USER_PHONE#2' '1234' l_QC pop:QueryCard:SetAttribute
 'AT_EMAIL' '1234' l_QC pop:QueryCard:SetAttribute
 cc:LastPage
;

WORDWORKER "Отправить консультацию (на невалидной базе ТБ24) и выполнить"
 TRY
  wait:Ok
  TRY
   wait:Ok
   TRY
    OBJECT VAR "Кнопка ОК"
    контрол::bt_enResult_opOkExt "Главное окно" pop:control:FindControlByName =: "Кнопка ОК"
    "Кнопка ОК" "Кликнуть"
    13 раз ( "Дождаться переключения вкладок" )
    // т.к. второй диалог поднимается с задержкой 
   FINALLY 
    waited:? ASSERT
   END
  FINALLY 
   waited:? ASSERT
  END
  ( WordToWork DO )
 FINALLY
  "Открыть вкладку 'Мои документы' и выполнить" (
   "Развернуть текущее дерево"
   "Перейти к концу"
   Если ( "Заголовок текущего контрола" НЕРАВНО 'Неподтвержденные' ) то
    ( "Ответить один раз Да для {(@ "Нажать Del")}" )
  )
 END
;

PROCEDURE "Открыть неотправленную консультацию из Моих документов и кликнуть левой кнопкой мыши в её тексте"
 "Открыть вкладку 'Мои документы' и выполнить" (
  "Развернуть текущее дерево"
  "Перейти к концу"
  Если ( "Заголовок текущего контрола" РАВНО 'Неподтвержденные' ) то
   ( false 'Отправленной консультации нет!' ASSERTS
    HALT )
  "Нажать Enter"
  "##Дать тесту время для отрисовки контролов"
  "Установить курсор мыши по координатам {(120 45)} относительно контрола {("Контрол в фокусе")}"
  "Клик левой кнопкой мыши"
 )
;

PROCEDURE "Нажать на клавиатуре стрелочку вниз"
 "Нажать {('Down')}"
 "##Дать тесту время для отрисовки контролов"
;

PROCEDURE "Сделать эталон перерисованной части текстового редактора левой части ААК"
 "Дождаться переключения вкладок"
 контрол::Text:push pop:editor:CheckWithEtalon ( "Поставить фокус в левую половину ААК" )
;

PROCEDURE "Открыть вкладку 'Редакции' и отметить редакцию " STRING IN aNameRedaction 
 "Открыть вкладку Список редакций"
 "Найти атрибут {(aNameRedaction)} в дереве {(контрол::RedactionTree)}"
 "Выделить текущий элемент"
;

WORDWORKER "##Выставить диалогу чата размер и выполнить" INTEGER IN X INTEGER IN Y
 "Ставим форме {(форма::ChatWindow)} размеры {( X Y )} и {(@ ( WordToWork DO ) )}"
;

PROCEDURE "Вывести окно чата на передний план"
 "Узнать Handle диалога чата" "Восстановить активное окно"
 "##Дать тесту время для отрисовки контролов"
;

PROCEDURE "Скопировать в буфер текст с вкладки 'Предупреждение'"
 "Дождаться переключения вкладок"
 "Перевести фокус в {(контрол::Viewer)} на форме {(форма::Warning)} типа {(Простое_предупреждение)}"
 "Выделить всё"
 "Копировать"
;

PROCEDURE "Вставить текст из буфера и кликнуть на ссылку в окне чата"
 "##Выставить диалогу чата размер {( 400 300 )} и выполнить" (
  "Вставить"
  "Вывести окно чата на передний план"  
  "Ставим указатель мыши на конец текущего параграфа редактора {(контрол::BottomEditor:push)} со смещением {( 5 -30 )}"
  "Дождаться переключения вкладок"
  "Дождаться появления хинта"
  "Клик левой кнопкой мыши"
 )
;

WordAlias "Выделить и скопировать текущий текст" "Выделить текст термина и скопировать его в буфер"

 PROCEDURE "Сравнить с эталоном, что введено в поле 'Слова в тексте'"
 "Убедиться, что фокус в редакторе"
 "Перевести фокус в поле 'Слова в тексте' в ППР"
 'В поле "Слова в тексте" введено: ' . 
 "Сравнить абзац текущего редактора с эталоном"
 "Отделить текст в эталоне"
; 

PROCEDURE "##Готовимся к выполнению теста K562611367"
 "Список всех документов"
 "Открыть фильтры"
 "Дождаться переключения вкладок"
 "Вызвать из главного меню {('Анализ/Фильтры/05. Книги')}"
 ОМ
;

PROCEDURE "Сравнить с эталоном настройки стиля " STRING IN aNameStyle
  PROCEDURE Действия_с_контролом OBJECT IN aCtrl
   Если ( ( aCtrl ЯВЛЯЕТСЯ class::TvtLabel )
    ИЛИ ( aCtrl ЯВЛЯЕТСЯ class::TElPopupButton )
    ИЛИ ( aCtrl ЯВЛЯЕТСЯ class::TvtCheckBox )
    ИЛИ ( aCtrl ЯВЛЯЕТСЯ class::TvtComboBoxQS )
    ИЛИ ( aCtrl ЯВЛЯЕТСЯ class::TScrollBox )
   ) то
   ( aCtrl "Имя компонента" .
   'Активность: ' aCtrl "Убедиться, что контрол активен" ToPrintable Cat . 
   'Видимость: ' aCtrl pop:control:Visible ToPrintable Cat . 
    Если ( aCtrl ЯВЛЯЕТСЯ class::TeeCheckBox ) то
     ( 'Галочка: ' "Получить состояние чекбокса {(aCtrl)}" ToPrintable Cat . ) 
    иначе
     ( 'Заголовок: ' aCtrl pop:control:Caption ToPrintable Cat .  )
   "Отделить текст в эталоне"
  ) 
;

 PROCEDURE Проверка_значений
  "Установить фокус в Дерево стилей"
  "Переместиться в начало дерева"
  "Найти ссылку {(aNameStyle)} в дереве {(контрол::StyleTreeView)} и перейти по ней"
  "Нажать {('Tab')}"
  OBJECT VAR "Настройки редактора стилей"
  "Контрол в фокусе" "Получить родительскую форму" >>> "Настройки редактора стилей"
  "Выполнить для всех контролов {("Настройки редактора стилей")}" Действия_с_контролом
 ;

 "Выполнить с редактором стилей" ( Проверка_значений )
;

PROCEDURE "Выбрать цвет и фон для стиля " STRING IN aColor STRING IN aBackColor STRING IN aNameStyle
 PROCEDURE Изменяем_параметры_редактора_стилей:_цвет_и_фон
  "Установить фокус в Дерево стилей"
  "Найти ссылку {(aNameStyle)} в дереве {(контрол::StyleTreeView)} и перейти по ней"
  "Установить фокус в комбобокс выбора цвета"
  "Сразу выбрать в текущем комбобоксе значение {(aColor)}"
  "Установить фокус в комбобокс выбора цвета фона"
  "Сразу выбрать в текущем комбобоксе значение {(aBackColor)}"
  "Кликаем Ок в Настройке конфигурации"
  ;

 "Выполнить с редактором стилей" ( Изменяем_параметры_редактора_стилей:_цвет_и_фон )
;

PROCEDURE "Установить всем настройкам тип наследования 'Собственный' и выставить все галочки в чекбоксах для стиля " STRING IN aNameStyle
  PROCEDURE Действия_с_контролом OBJECT IN aCtrl
   Если ( 
    ( aCtrl "Имя компонента" РАВНО контрол::FontNameInheritanceButton ) 
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontForeColorInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontBackColorInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontSizeInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontBoldInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontItalicInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontUnderlineInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontStrikeoutInheritanceButton )
   ) то 
   (  
    Если ( aCtrl "Заголовок контрола" РАВНО 'Р' ) то
     ( "Установить фокус в {(aCtrl)}"
      "Нажать Enter" ) 
    Если ( aCtrl "Заголовок контрола" РАВНО 'П' ) то
     ( "Установить фокус в {(aCtrl)}"
      "Нажать Enter" )
   )
  Если ( aCtrl ЯВЛЯЕТСЯ class::TvtCheckBox ) то (
   "Установить фокус в {(aCtrl)}" 
   "Поставить галочку в чекбоксе"  )
  "Кликаем Ок в Настройке конфигурации"
  ;

 PROCEDURE Изменяем_параметры_редактора_стилей:_наследование_и_чекбоксы
  "Установить фокус в Дерево стилей"
  "Найти ссылку {('Цветовое выделение')} в дереве {(контрол::StyleTreeView)} и перейти по ней"
  "Нажать {('Tab')}"
  OBJECT VAR "Настройки редактора стилей"
  "Контрол в фокусе" "Получить родительскую форму" >>> "Настройки редактора стилей"
  "Выполнить для всех контролов {("Настройки редактора стилей")}" Действия_с_контролом
 ;

 "Выполнить с редактором стилей" ( Изменяем_параметры_редактора_стилей:_наследование_и_чекбоксы )
;

PROCEDURE "Установить всем настройкам тип наследования 'Родительский' для стиля " STRING IN aNameStyle
  PROCEDURE Действия_с_контролом OBJECT IN aCtrl
   Если ( 
    ( aCtrl "Имя компонента" РАВНО контрол::FontNameInheritanceButton ) 
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontForeColorInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontBackColorInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontSizeInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontBoldInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontItalicInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontUnderlineInheritanceButton )
    ИЛИ ( aCtrl "Имя компонента" РАВНО контрол::FontStrikeoutInheritanceButton )
   ) то 
   (  
    Если ( aCtrl "Заголовок контрола" РАВНО 'П' ) то
     ( "Установить фокус в {(aCtrl)}"
      "Нажать Enter" ) 
    Если ( aCtrl "Заголовок контрола" РАВНО 'С' ) то
     ( "Установить фокус в {(aCtrl)}"
      "Нажать Enter" )
   )
   "Кликаем Ок в Настройке конфигурации"
  ;

 PROCEDURE Изменяем_параметры_редактора_стилей:_наследование
  "Установить фокус в Дерево стилей"
  "Найти ссылку {('Сравнение редакций. Добавленный фрагмент')} в дереве {(контрол::StyleTreeView)} и перейти по ней"
  "Нажать {('Tab')}"
  OBJECT VAR "Настройки редактора стилей"
  "Контрол в фокусе" "Получить родительскую форму" >>> "Настройки редактора стилей"
  "Выполнить для всех контролов {("Настройки редактора стилей")}" Действия_с_контролом
 ;

 "Выполнить с редактором стилей" ( Изменяем_параметры_редактора_стилей:_наследование )
;

PROCEDURE "Ищем некорректный контекст через БП (указываем 'Продолжить поиск')" STRING IN aIncorrectContext
 2 wait:Choice
 TRY
  "В БП ищем контекст {(aIncorrectContext)}"
 FINALLY
  waited:? ASSERT
 END
;

VOID WORDWORKER "Открыть диалог 'О программе' и выполнить"
 @ "О программе..." MODAL ( WordToWork DO )
;

VOID WORDWORKER "Открыть диалог 'Открыть документ по номеру' и выполнить"
 @ ( "Нажать {('Alt+N')}" ) MODAL ( WordToWork DO )
;

VOID WORDWORKER "Открыть диалог 'Условия использования' и выполнить"
 @ "Условия использования" MODAL ( WordToWork DO )
;

VOID WORDWORKER "Открыть модальный диалог 'Новая папка' и выполнить"
 "##Дать тесту время для отрисовки контролов" 
 @ (
  OBJECT VAR Parent
  "Контрол в фокусе" 2 раза ( "Получить родительскую форму" ) =: Parent
  "Найти контрол {(контрол::FoldersTree)} на форме {(Parent)}" "Установить фокус"
  "Создать папку" )
 MODAL ( 
  ( WordToWork DO ) 
  "Нажать Esc"
 )
;

VOID WORDWORKER "Открыть модальный диалог 'Мои документы (Сохранить как...)' и выполнить"
 @ ( "Сохранить в Мои документы" ) MODAL ( 
  ( WordToWork DO )
  "##Дать тесту время для отрисовки контролов" 
  "Нажать Esc"
 )
;

VOID WORDWORKER "Открыть диалог 'Анализ списка' и выполнить"
 @ "Анализ списка" MODAL ( WordToWork DO )
;

PROCEDURE "Установить фокус во вкладку синхронного просмотра документа Инфарма"
 OBJECT VAR Parent
 "Контрол в фокусе"  2 раза ( "Получить родительскую форму" ) =: Parent
 "Найти контрол {(контрол::Text)} на форме {(Parent)}" "Установить фокус"
 "Дождаться переключения вкладок"
;

VOID WORDWORKER "Открыть диалог 'Настройка страницы' и выполнить"
 @ "Настройка страницы" MODAL ( WordToWork DO )
;

VOID WORDWORKER "Открыть диалог 'Информация о картинке' и выполнить"
 @ ( "Нажать {('Alt+I')}" ) MODAL ( WordToWork DO )
;

VOID WORDWORKER "Открыть диалог 'Регистрационные данные' и выполнить"
 @ "Изменить мои регистрационные данные" MODAL ( WordToWork DO )
;

VOID WORDWORKER "Открыть диалог 'Включить Машину времени' и выполнить"
 @ "Включить Машину Времени (показать диалог)" MODAL ( WordToWork DO )
;

VOID WORDWORKER "Вернуться к текущему окну Гаранта, предварительно выполнив"
 INTEGER VAR "Первое главное окно" 
 0 >>> "Первое главное окно"
 "Сохранить активное окно" >>> "Первое главное окно" 
 ( WordToWork DO )
 "##Дать тесту время для отрисовки контролов"
 "Первое главное окно" "Восстановить активное окно"
;

PROCEDURE "Перетащить третий документ списка в сохраненный список во вкладке 'Мои документы'"
 "Открыть вкладку 'Мои документы' и выполнить" (
  "Развернуть текущее дерево"
  "Перевести фокус в список"
  "Установить курсор мыши по координатам {(70 120)} относительно контрола {(контрол::tvList:push)}"
  THREAD ( 300 SLEEP
   OBJECT VAR "Дерево вкладки Мои документы"
   "Найти контрол {(контрол::FoldersTree)} на форме {("Главное окно")}"  =: "Дерево вкладки Мои документы"
   1 wait:Choice
   TRY
    "Установить курсор мыши по координатам {(100 30)} относительно контрола {("Дерево вкладки Мои документы")}"
    "##Дать тесту время для отрисовки контролов"
    "Отпустить левую кнопку мыши"
   FINALLY
    waited:? ASSERT
   END
  )
  "Зажать левую кнопку мыши"
 )
;

PROCEDURE "Сравнить сохраненный список с эталоном"
 "Открыть сохранённый список из Моих документов и выполнить" (
  "Сравнить текущий список с эталоном"
 )
;

PROCEDURE "Проскроллировать мышкой текст вниз и убедиться, что скроллирование проходит корректно"
 OBJECT VAR aEditor
 контрол::Text:push =: aEditor
 "Прокрутить колесо мыши вниз {(30)} раз для контрола {(aEditor)}"
 "Узнать позицию вертикального скроллбара у контрола {(aEditor)}" БОЛЬШЕ 5 'Документ скроллируется до комментария!' ASSERTS
;

VOID WORDWORKER "##Удалить залипший комментарий из документа , который получился по сценарию" STRING IN aNameDoc
 TRY
  ( WordToWork DO )
 FINALLY
  "Открыть список документов с комментариями"
  "Найти документ {(aNameDoc)} в списке и открыть его"
  "В документе не должно быть комментариев"
 END
;

PROCEDURE "Ввести строку (выпадающий список убрать)" STRING IN aContex
 "Ввести строку {(aContex)}"
 "##Дать тесту время для отрисовки контролов" 
 "Узнать количество открытых выпадающих списков {('TnscSubTree')}" РАВНО 1 ? (
  "Нажать Esc"
 )
;

PROCEDURE "Убедиться, что в левой и правой редакциях горизонтальные скроллеры занимают правильные позиции"
 "##Дать тесту время для отрисовки контролов"
 "Перевести фокус в правую редакцию"
 "Позиция горизонтального скроллбара у текущего редактора" "в интервале" ( 1700 2300 ) 'Позиция горизонтального скроллера в правой редакции вышла из диапазана!' ASSERTS
 "Перевести фокус в левую редакцию"
 "Позиция горизонтального скроллбара у текущего редактора" "в интервале" ( 2400 3000 ) 'Позиция горизонтального скроллера в левой редакции вышла из диапазана!' ASSERTS
;

VOID WORDWORKER "Выбрать второй вариант в диалоге, выполнив"
 2 wait:Choice
 TRY
  ( WordToWork DO )
 FINALLY
  waited:? ASSERT
 END
;

PROCEDURE "Открыть документ сразу в сравнении с предыдущей редакцией"
 "Выбрать второй вариант в диалоге, выполнив" (
  "Нажать Enter"
 )
 "Дождаться переключения вкладок"
;

PROCEDURE "Сделать вкладку 'Оглавление' автораспахивающейся"
 "Дождаться переключения вкладок"
 "Перевести фокус в оглавление"
 "Свернуть текущее дерево"
 "Сделать оглавление неплавающим"
 "Сделать левый навигатор автораспахивающимся"
 3 раза ( "Дождаться переключения вкладок" )
;

PROCEDURE "Сделать вкладку 'Оглавление' НЕавтораспахивающейся"
 "Перевести фокус в оглавление"
 "Сделать левый навигатор НЕавтораспахивающимся"
 3 раза ( "Дождаться переключения вкладок" )
 "Дать системе перерисоваться"
 "Перевести фокус в оглавление"  
;

PROCEDURE "Выделить первую строку в таблице (кликнуть слева от первой ячейки)"
 OBJECT VAR aSubPanel
 контрол::SubPanel:push =: aSubPanel 
 INTEGER VAR aWidth
 "Померить ширину {(aSubPanel)}" =: aWidth
 aWidth 3 + =: aWidth 
 "Установить курсор мыши по координатам {( aWidth  271 )} относительно контрола {(aSubPanel)}"
 "Дождаться появления хинта и сравнить его текст с эталоном"
 "Клик левой кнопкой мыши"
;

PROCEDURE "Сравнить следующих изменений в СР с эталоном" INTEGER IN aCountFollowingChange
 "##Дать тесту время для отрисовки контролов"
 aCountFollowingChange раз (
  "Следующее изменение"
  'ParaID: ' "Узнать номер текущего параграфа" ToPrintable Cat .
  "Сравнить абзац текущего редактора с эталоном"
  "##Отделить текст в эталоне"
 )
;

PROCEDURE "Выделить пункт 6 статьи 1, статью 4 и статью 6 в оглавлении"
 "Перевести фокус в оглавление"
 "Развернуть текущее дерево"
 "Найти атрибут {('Статья 6. Несоответствие нормативных правовых актов о налогах и сборах настоящему Кодексу')} в дереве {(контрол::ContentsTree)}"
 "Зажать кнопку {('Ctrl')} и выполнить" (
  "Установить курсор мыши по координатам {(110 312)} относительно контрола {(контрол::ContentsTree:push)}"
  "Клик левой кнопкой мыши"
  "Установить курсор мыши по координатам {(110 152)} относительно контрола {(контрол::ContentsTree:push)}"
  "Клик левой кнопкой мыши"
 )
;
