VOID TestWithDump ObjectTest
 IMMEDIATE VOID MACRO .FakeField
  ^@ IN Self
  Self
  'FakeField'
  ExpandMethodName
 ; // IMMEDIATE VOID MACRO .FakeField
 
 Object1Class class_impl _:Object1
  %CLASS-METHODS %Class-Methods
  ; // %CLASS-METHODS %Class-Methods
  
  %CONSTRUCTORS %Constructors
   'new'
  ; // %CONSTRUCTORS %Constructors
  
  %INHERITS %G
   @
   _:Object
  ; // %INHERITS %G
  
  %METHODS %Methods
  ; // %METHODS %Methods
  
  %PROPERTIES %Props
  ; // %PROPERTIES %Props
  
  INTEGER CONST c:Offset:Fake
   1
  FieldOffset STATIC-VAR c:Offset:Instance:Size
  INTEGER CONST c:Offset:VMT
   0
  _:Object1
  Result
  pop:Word:SetValue
 ; // Object1Class class_impl _:Object1
 
 Object2Class class_impl _:Object2
  %CLASS-METHODS %Class-Methods
  ; // %CLASS-METHODS %Class-Methods
  
  %CONSTRUCTORS %Constructors
   'new'
  ; // %CONSTRUCTORS %Constructors
  
  %INHERITS %G
   @
   _:Object
  ; // %INHERITS %G
  
  %METHODS %Methods
  ; // %METHODS %Methods
  
  %PROPERTIES %Props
   'FakeField'
  ; // %PROPERTIES %Props
  
  INTEGER CONST c:Offset:Fake
   1
  INTEGER CONST c:Offset:FakeField
   2
  FieldOffset STATIC-VAR c:Offset:Instance:Size
  INTEGER CONST c:Offset:VMT
   0
  _:Object2
  Result
  pop:Word:SetValue
 ; // Object2Class class_impl _:Object2
 
 Object1Class class_impl _:Object1
  %CLASS-METHODS %Class-Methods
  ; // %CLASS-METHODS %Class-Methods
  
  %CONSTRUCTORS %Constructors
   'new'
  ; // %CONSTRUCTORS %Constructors
  
  %INHERITS %G
   @
   _:Object
  ; // %INHERITS %G
  
  %METHODS %Methods
  ; // %METHODS %Methods
  
  %PROPERTIES %Props
  ; // %PROPERTIES %Props
  
  INTEGER CONST c:Offset:Fake
   1
  FieldOffset STATIC-VAR c:Offset:Instance:Size
  INTEGER CONST c:Offset:VMT
   0
  _:Object1
  Result
  pop:Word:SetValue
 ; // Object1Class class_impl _:Object1
 
 Object2Class class_impl _:Object2
  %CLASS-METHODS %Class-Methods
  ; // %CLASS-METHODS %Class-Methods
  
  %CONSTRUCTORS %Constructors
   'new'
  ; // %CONSTRUCTORS %Constructors
  
  %INHERITS %G
   @
   _:Object
  ; // %INHERITS %G
  
  %METHODS %Methods
  ; // %METHODS %Methods
  
  %PROPERTIES %Props
   'FakeField'
  ; // %PROPERTIES %Props
  
  INTEGER CONST c:Offset:Fake
   1
  INTEGER CONST c:Offset:FakeField
   2
  FieldOffset STATIC-VAR c:Offset:Instance:Size
  INTEGER CONST c:Offset:VMT
   0
  _:Object2
  Result
  pop:Word:SetValue
 ; // Object2Class class_impl _:Object2
 
 Object VAR l_Obj
 Object1 VAR l_Obj1
 Object2 VAR l_Obj2
 IMMEDIATE VOID TYPE Object1
  TtfwValueTypes
  Ctx:IncludeValueTypes
 ; // IMMEDIATE VOID TYPE Object1
 
 ObjectClass readonly Object:class
  Object IN Self
  Self
  FieldByOffset
  ^@ (
   _:Object _:Object pop:Word:SetValue ::
   'c:Offset:VMT'
  )
  Result
  pop:Word:SetValue
 ; // ObjectClass readonly Object:class
 
 STRING method Object:ClassName
  Object IN Self
  Self
  Object:class
  ObjectClass:ClassName
  Result
  pop:Word:SetValue
 ; // STRING method Object:ClassName
 
 INTEGER method Object:InstanceSize
  Object IN Self
  Self
  Object:class
  ObjectClass:InstanceSize
  Result
  pop:Word:SetValue
 ; // INTEGER method Object:InstanceSize
 
 REDIFINITION Object1 constructor Object1:new
  ARRAY [
   @
   _:Object1
   'uninited member'
  ]
  Result
  pop:Word:SetValue
 ; // REDIFINITION Object1 constructor Object1:new
 
 VIRTUAL VOID method Object:Print
  Object IN Self
  Self
  Object:ToPrintable
  Print
 ; // VIRTUAL VOID method Object:Print
 
 VIRTUAL STRING method Object:ToPrintable
  Object IN Self
  Self
  ToPrintable
  Result
  pop:Word:SetValue
  ARRAY [
   Self
   Object:ClassName
   ' : '
   Result
  ]
  strings:Cat
  Result
  pop:Word:SetValue
 ; // VIRTUAL STRING method Object:ToPrintable
 
 IMMEDIATE VOID TYPE Object1Class
  TtfwValueTypes
  Ctx:IncludeValueTypes
 ; // IMMEDIATE VOID TYPE Object1Class
 
 STRING : ObjectClass:ClassName
  ObjectClass IN Self
  Self
  |N
  ':'
  string:Split
  Result
  pop:Word:SetValue
  DROP
 ; // STRING : ObjectClass:ClassName
 
 INTEGER : ObjectClass:InstanceSize
  ObjectClass IN Self
  Self
  %%
  InstanceSizeName
  DO
  Result
  pop:Word:SetValue
 ; // INTEGER : ObjectClass:InstanceSize
 
 IMMEDIATE VOID TYPE Object2
  TtfwValueTypes
  Ctx:IncludeValueTypes
 ; // IMMEDIATE VOID TYPE Object2
 
 ObjectClass readonly Object:class
  Object IN Self
  Self
  FieldByOffset
  ^@ (
   _:Object _:Object pop:Word:SetValue ::
   'c:Offset:VMT'
  )
  Result
  pop:Word:SetValue
 ; // ObjectClass readonly Object:class
 
 STRING method Object:ClassName
  Object IN Self
  Self
  Object:class
  ObjectClass:ClassName
  Result
  pop:Word:SetValue
 ; // STRING method Object:ClassName
 
 INTEGER readonly Object2:FakeField
  Object2 IN Self
  Self
  FieldByOffset
  ^@ (
   _:Object2 _:Object2 pop:Word:SetValue ::
   'c:Offset:FakeField'
  )
  Result
  pop:Word:SetValue
 ; // INTEGER readonly Object2:FakeField
 
 INTEGER method Object:InstanceSize
  Object IN Self
  Self
  Object:class
  ObjectClass:InstanceSize
  Result
  pop:Word:SetValue
 ; // INTEGER method Object:InstanceSize
 
 REDIFINITION Object2 constructor Object2:new
  ARRAY [
   @
   _:Object2
   'uninited member'
   256
  ]
  Result
  pop:Word:SetValue
 ; // REDIFINITION Object2 constructor Object2:new
 
 VIRTUAL VOID method Object:Print
  Object IN Self
  Self
  Object:ToPrintable
  Print
 ; // VIRTUAL VOID method Object:Print
 
 VIRTUAL STRING method Object:ToPrintable
  Object IN Self
  Self
  ToPrintable
  Result
  pop:Word:SetValue
  ARRAY [
   Self
   Object:ClassName
   ' : '
   Result
  ]
  strings:Cat
  Result
  pop:Word:SetValue
 ; // VIRTUAL STRING method Object:ToPrintable
 
 IMMEDIATE VOID TYPE Object2Class
  TtfwValueTypes
  Ctx:IncludeValueTypes
 ; // IMMEDIATE VOID TYPE Object2Class
 
 STRING : ObjectClass:ClassName
  ObjectClass IN Self
  Self
  |N
  ':'
  string:Split
  Result
  pop:Word:SetValue
  DROP
 ; // STRING : ObjectClass:ClassName
 
 INTEGER : ObjectClass:InstanceSize
  ObjectClass IN Self
  Self
  %%
  InstanceSizeName
  DO
  Result
  pop:Word:SetValue
 ; // INTEGER : ObjectClass:InstanceSize
 
 ObjectTest
 DumpElement
 _:Object
 DumpElement
 _:Object
 pop:Word:Name
 Print
 Object:new
 l_Obj
 pop:Word:SetValuePrim
 l_Obj
 Object:Print
 l_Obj
 Object:ClassName
 Print
 l_Obj
 Object:ClassName
 Print
 _:Object
 pop:Word:Name
 Print
 '--------'
 Print
 l_Obj
 Object:InstanceSize
 Print
 _:Object _:Object pop:Word:SetValue ::
 'c:Offset:VMT'
 Print
 _:Object
 pop:Word:Name
 Print
 _:Object
 pop:Word:Name
 Print
 Object1:new
 l_Obj1
 pop:Word:SetValuePrim
 l_Obj1
 Object:Print
 l_Obj1
 Object:ClassName
 Print
 l_Obj1
 Object:ClassName
 Print
 '--------'
 Print
 l_Obj1
 Object:InstanceSize
 Print
 _:Object1 _:Object1 pop:Word:SetValue ::
 'c:Offset:VMT'
 Print
 Object2:new
 l_Obj2
 pop:Word:SetValuePrim
 l_Obj2
 Object:Print
 l_Obj2
 Object:ClassName
 Print
 l_Obj2
 Object:ClassName
 Print
 '--------'
 Print
 l_Obj2
 Object:InstanceSize
 Print
 _:Object2 _:Object2 pop:Word:SetValue ::
 'c:Offset:VMT'
 Print
 _:Object2 _:Object2 pop:Word:SetValue ::
 'c:Offset:FakeField'
 Print
; // VOID TestWithDump ObjectTest

ObjectClass class_impl _:Object
 %CLASS-METHODS %Class-Methods
  'ClassName'
  'InstanceSize'
 ; // %CLASS-METHODS %Class-Methods
 
 %CONSTRUCTORS %Constructors
  'new'
 ; // %CONSTRUCTORS %Constructors
 
 %METHODS %Methods
  'ClassName'
  'InstanceSize'
  'ToPrintable'
  'Print'
 ; // %METHODS %Methods
 
 %PROPERTIES %Props
  'class'
 ; // %PROPERTIES %Props
 
 INTEGER CONST c:Offset:Fake
  1
 FieldOffset STATIC-VAR c:Offset:Instance:Size
 INTEGER CONST c:Offset:VMT
  0
 _:Object
 Result
 pop:Word:SetValue
; // ObjectClass class_impl _:Object

_:Object
Object : [ TkwCompiledFunction uninited member ]
Object
Object
_:Object
--------
2
0
_:Object
_:Object
Object1 : [ TkwCompiledFunction uninited member ]
Object1
Object1
--------
2
0
Object2 : [ TkwCompiledFunction uninited member 256 ]
Object2
Object2
--------
3
0
2
