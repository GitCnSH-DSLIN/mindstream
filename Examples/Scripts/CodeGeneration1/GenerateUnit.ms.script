PROGRAM GenerateUnit.ms.script

USES
 Testing.ms.dict
;

CONST cPathSep '\'

STRING FUNCTION OutDir
 sysutils:GetCurrentDir >>> Result
 [ Result
  script:FileName 
  %REMARK 'Путь к текущему скрипту'
  sysutils:ExtractFileName
  %REMARK 'Вырезаем из пути только имя файла' 
  '' sysutils:ChangeFileExt
  %REMARK 'Убираем .script' 
  '' sysutils:ChangeFileExt 
  %REMARK 'Убираем .ms' 
 ] cPathSep strings:CatSep >>> Result
; // OutDir

STRING FUNCTION MakeOutPath
 OutDir >>> Result
 Result sysutils:ForceDirectories ?ASSURE [ 'Не удалось создать директорию ' Result ]
; // MakeOutPath

PROCEDURE GenerateUnit
  STRING IN aUnitName
  
 STRING VAR l_UnitName
 MakeOutPath >>> l_UnitName
 l_UnitName Print
; // GenerateUnit 

Test&Dump GenerateUnitTest
 'Unit1' GenerateUnit
; // GenerateUnitTest

GenerateUnitTest